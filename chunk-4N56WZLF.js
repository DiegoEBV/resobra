import{a as Be,b as Ue,c as Re,d as $e,e as Ke}from"./chunk-I7YE4JQ5.js";import{a as Qe}from"./chunk-NXOYKD4N.js";import{a as Ve,b as De,c as Ae,d as ze}from"./chunk-EPNA6SYW.js";import{b as Ge}from"./chunk-ZLVJQ2UH.js";import"./chunk-SXXER37Y.js";import"./chunk-MS4AQ6UA.js";import{a as Le,b as Te}from"./chunk-DMZJ7K26.js";import{c as we}from"./chunk-7BCONPA6.js";import{e as Ne,f as qe,h as je}from"./chunk-BRP3ETBH.js";import{b as ye}from"./chunk-ZOXEDHNH.js";import"./chunk-CSWWTQFU.js";import{a as Oe}from"./chunk-IMDEVWQ5.js";import"./chunk-GOBT7UBB.js";import{a as Ie,b as Pe}from"./chunk-AZ2U4T3U.js";import"./chunk-SGYCFQGT.js";import"./chunk-2GVF4P32.js";import"./chunk-WFXXN3GR.js";import{a as H,c as Q}from"./chunk-YMTLAEZG.js";import"./chunk-G7YPFBNB.js";import{a as me,b as de,c as ce,d as se,e as pe,f as ue,h as fe}from"./chunk-SNSQLCH6.js";import{b as Ce,c as Me}from"./chunk-BXKJ5BTH.js";import"./chunk-3RK6DDJD.js";import{C as he,F as xe,G as be,b as J,d,g as W,h as X,l as Y,m as Z,n as ee,o as te,p as ne,q as ie,r as re,s as ae,v as oe,x as le,y as ge,z as _e}from"./chunk-UJ3DDJ5Q.js";import{i as R,j as $,p as K,sa as Ee,ua as ve,va as Fe,wa as ke,xa as Se}from"./chunk-4WMI5X77.js";import{Db as m,Nb as n,Ob as t,Pb as g,Tb as j,Xb as F,Yb as x,bc as G,cc as B,db as l,dc as U,gc as V,hc as i,ib as v,jc as _,pa as M,pb as z,qa as E,vb as u}from"./chunk-B6672ACT.js";import"./chunk-X5YLR3NI.js";import{a as N,b as q,g as He,i as T}from"./chunk-ODN5LVDJ.js";var f=He(Qe());var Je=["mapContainer"];function We(a,s){if(a&1&&(n(0,"mat-card-subtitle"),i(1),t()),a&2){let e=x();l(),_(" Modificando: ",e.frente.nombre," ")}}function Xe(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("nombre")," ")}}function Ye(a,s){if(a&1&&(n(0,"mat-option",37),i(1),t()),a&2){let e=s.$implicit;m("value",e.id),l(),_(" ",e.nombre," ")}}function Ze(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("obra_id")," ")}}function et(a,s){if(a&1&&(n(0,"mat-option",37),i(1),t()),a&2){let e=s.$implicit;m("value",e.value),l(),_(" ",e.label," ")}}function tt(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("estado")," ")}}function nt(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("fecha_inicio")," ")}}function it(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("ubicacion_lat")," ")}}function rt(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("ubicacion_lng")," ")}}function at(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("progreso_general")," ")}}function ot(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("km_inicial")," ")}}function lt(a,s){if(a&1&&(n(0,"mat-error"),i(1),t()),a&2){let e=x();l(),_(" ",e.getErrorMessage("km_final")," ")}}function mt(a,s){a&1&&(n(0,"mat-error"),i(1," Latitud de inicio es requerida "),t())}function dt(a,s){a&1&&(n(0,"mat-error"),i(1," Longitud de inicio es requerida "),t())}function ct(a,s){a&1&&(n(0,"mat-error"),i(1," Latitud de fin es requerida "),t())}function st(a,s){a&1&&(n(0,"mat-error"),i(1," Longitud de fin es requerida "),t())}function pt(a,s){a&1&&(n(0,"mat-error"),i(1," Kilometraje es requerido "),t())}function ut(a,s){if(a&1){let e=j();n(0,"mat-list-item",41)(1,"mat-icon",42),i(2,"place"),t(),n(3,"div",43)(4,"div",44)(5,"mat-form-field",45)(6,"mat-label"),i(7,"Latitud"),t(),g(8,"input",46),t(),n(9,"mat-form-field",45)(10,"mat-label"),i(11,"Longitud"),t(),g(12,"input",47),t(),n(13,"mat-form-field",48)(14,"mat-label"),i(15,"Kilometraje"),t(),g(16,"input",49),u(17,pt,2,0,"mat-error",5),t()()(),n(18,"button",50),F("click",function(){let r=M(e).index,c=x(2);return E(c.removeIntermediatePoint(r))}),n(19,"mat-icon"),i(20,"delete"),t()()()}if(a&2){let e,o=s.$implicit,r=s.index;m("formGroupName",r),l(17),m("ngIf",((e=o.get("kilometraje"))==null?null:e.invalid)&&((e=o.get("kilometraje"))==null?null:e.touched))}}function ft(a,s){if(a&1&&(n(0,"div",22)(1,"h3",23)(2,"mat-icon"),i(3,"timeline"),t(),i(4),t(),n(5,"mat-expansion-panel",38)(6,"mat-expansion-panel-header")(7,"mat-panel-title")(8,"mat-icon"),i(9,"control_point"),t(),i(10," Gestionar Puntos Intermedios "),t(),n(11,"mat-panel-description"),i(12," Editar kilometraje y coordenadas de los puntos de control "),t()(),n(13,"div",39)(14,"mat-list"),u(15,ut,21,2,"mat-list-item",40),t()()()()),a&2){let e=x();l(4),_(" Puntos de Control Intermedios (",e.coordenadasIntermedias.length,") "),l(11),m("ngForOf",e.coordenadasIntermedias.controls)}}delete f.Icon.Default.prototype._getIconUrl;f.Icon.Default.mergeOptions({iconRetinaUrl:"assets/marker-icon-2x.png",iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png"});var Rt=(()=>{class a{constructor(e,o,r,c,p){this.fb=e,this.actividadesService=o,this.snackBar=r,this.router=c,this.route=p,this.obras=[],this.frenteId=null,this.isLoading=!1,this.isEditMode=!1,this.intermediateMarkers=[],this.isMapInitialized=!1,this.frente=null,this.estadosFrente=[{value:"activo",label:"Activo"},{value:"pausado",label:"Pausado"},{value:"completado",label:"Completado"},{value:"planificado",label:"Planificado"}],this.frenteForm=this.createForm()}ngAfterViewInit(){setTimeout(()=>{this.initializeMap()},100)}initializeMap(){this.isMapInitialized||!this.mapContainer||(this.map=f.map(this.mapContainer.nativeElement).setView([-16.5,-68.15],10),f.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map),this.map.on("click",e=>{this.onMapClick(e)}),this.isMapInitialized=!0,this.frente&&this.updateMapFromForm())}onMapClick(e){let{lat:o,lng:r}=e.latlng;this.frenteForm.get("coordenadas_inicio.lat")?.value?this.frenteForm.get("coordenadas_fin.lat")?.value?this.addIntermediatePoint(o,r):this.setEndCoordinates(o,r):this.setStartCoordinates(o,r)}setStartCoordinates(e,o){this.frenteForm.patchValue({coordenadas_inicio:{lat:e,lng:o},ubicacion_lat:e,ubicacion_lng:o}),this.startMarker&&this.map.removeLayer(this.startMarker),this.startMarker=f.marker([e,o],{icon:f.icon({iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41]})}).addTo(this.map).bindPopup("Punto de inicio").openPopup(),this.updateRoute()}setEndCoordinates(e,o){this.frenteForm.patchValue({coordenadas_fin:{lat:e,lng:o}}),this.endMarker&&this.map.removeLayer(this.endMarker),this.endMarker=f.marker([e,o],{icon:f.icon({iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41]})}).addTo(this.map).bindPopup("Punto final").openPopup(),this.updateRoute()}addIntermediatePoint(e,o){let r=this.frenteForm.get("km_inicial")?.value||0,c=this.frenteForm.get("km_final")?.value||0,p=this.coordenadasIntermedias.length,h=r+(c-r)*(p+1)/(p+2),b=this.fb.group({lat:[e,d.required],lng:[o,d.required],kilometraje:[h,[d.required,d.min(0)]]});this.coordenadasIntermedias.push(b);let C=f.marker([e,o],{icon:f.icon({iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png",iconSize:[20,33],iconAnchor:[10,33]})}).addTo(this.map).bindPopup(`Punto intermedio - Km ${h.toFixed(2)}`);this.intermediateMarkers.push(C),this.updateRoute()}get coordenadasIntermedias(){return this.frenteForm.get("coordenadas_intermedias")}removeIntermediatePoint(e){e>=0&&e<this.intermediateMarkers.length&&(this.map.removeLayer(this.intermediateMarkers[e]),this.intermediateMarkers.splice(e,1),this.coordenadasIntermedias.removeAt(e),this.updateRoute())}updateRoute(){this.routeLine&&this.map.removeLayer(this.routeLine);let e=this.frenteForm.get("coordenadas_inicio")?.value,o=this.frenteForm.get("coordenadas_fin")?.value;if(e?.lat&&e?.lng&&o?.lat&&o?.lng){let r=[[e.lat,e.lng]];this.coordenadasIntermedias.controls.map((p,h)=>q(N({},p.value),{index:h})).sort((p,h)=>p.kilometraje-h.kilometraje).forEach(p=>{r.push([p.lat,p.lng])}),r.push([o.lat,o.lng]),this.routeLine=f.polyline(r,{color:"#3388ff",weight:4,opacity:.8}).addTo(this.map),this.map.fitBounds(this.routeLine.getBounds(),{padding:[20,20]})}}updateMapFromForm(){if(!this.isMapInitialized)return;let e=this.frenteForm.get("coordenadas_inicio")?.value,o=this.frenteForm.get("coordenadas_fin")?.value;e?.lat&&e?.lng&&this.setStartCoordinates(e.lat,e.lng),o?.lat&&o?.lng&&this.setEndCoordinates(o.lat,o.lng);let r=this.frente?.coordenadas_intermedias;r&&Array.isArray(r)&&r.forEach(c=>{let p=this.fb.group({lat:[c.lat,d.required],lng:[c.lng,d.required],kilometraje:[c.kilometraje,[d.required,d.min(0)]]});this.coordenadasIntermedias.push(p);let h=f.marker([c.lat,c.lng],{icon:f.icon({iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png",iconSize:[20,33],iconAnchor:[10,33]})}).addTo(this.map).bindPopup(`Punto intermedio - Km ${c.kilometraje}`);this.intermediateMarkers.push(h)}),this.updateRoute()}clearMap(){for(this.startMarker&&(this.map.removeLayer(this.startMarker),this.startMarker=void 0),this.endMarker&&(this.map.removeLayer(this.endMarker),this.endMarker=void 0),this.intermediateMarkers.forEach(e=>{this.map.removeLayer(e)}),this.intermediateMarkers=[],this.routeLine&&(this.map.removeLayer(this.routeLine),this.routeLine=void 0),this.frenteForm.patchValue({coordenadas_inicio:{lat:null,lng:null},coordenadas_fin:{lat:null,lng:null}});this.coordenadasIntermedias.length!==0;)this.coordenadasIntermedias.removeAt(0)}ngOnInit(){this.frenteId=this.route.snapshot.paramMap.get("id"),this.frenteId?(this.loadFrente(),this.loadObras()):this.router.navigate(["/frentes"])}createForm(){return this.fb.group({nombre:["",[d.required,d.minLength(3)]],descripcion:[""],obra_id:["",d.required],estado:["activo",d.required],fecha_inicio:[new Date,d.required],fecha_fin_estimada:[""],ubicacion_lat:[null,[d.required,d.min(-90),d.max(90)]],ubicacion_lng:[null,[d.required,d.min(-180),d.max(180)]],progreso_general:[0,[d.min(0),d.max(100)]],km_inicial:[null,[d.required,d.min(0)]],km_final:[null,[d.required,d.min(0)]],coordenadas_inicio:this.fb.group({lat:[null,[d.required]],lng:[null,[d.required]]}),coordenadas_fin:this.fb.group({lat:[null,[d.required]],lng:[null,[d.required]]}),coordenadas_intermedias:this.fb.array([])})}loadFrente(){return T(this,null,function*(){if(this.frenteId)try{this.isLoading=!0,this.frente=yield this.actividadesService.getFrenteById(this.frenteId),this.frente?this.populateForm(this.frente):(this.snackBar.open("Frente no encontrado","Cerrar",{duration:3e3,panelClass:["error-snackbar"]}),this.router.navigate(["/mapa"]))}catch{this.snackBar.open("Error al cargar el frente","Cerrar",{duration:3e3,panelClass:["error-snackbar"]}),this.router.navigate(["/mapa"])}finally{this.isLoading=!1}})}populateForm(e){this.frenteForm.patchValue({nombre:e.nombre,descripcion:e.descripcion||"",obra_id:e.obra_id,estado:e.estado,fecha_inicio:new Date(e.fecha_inicio),fecha_fin_estimada:e.fecha_fin_estimada?new Date(e.fecha_fin_estimada):null,ubicacion_lat:e.ubicacion_lat,ubicacion_lng:e.ubicacion_lng,progreso_general:e.progreso_general,km_inicial:e.km_inicial||null,km_final:e.km_final||null,coordenadas_inicio:e.coordenadas_inicio||{lat:null,lng:null},coordenadas_fin:e.coordenadas_fin||{lat:null,lng:null}}),this.isMapInitialized&&this.updateMapFromForm()}loadObras(){return T(this,null,function*(){try{this.obras=yield this.actividadesService.getUserObras()}catch{this.snackBar.open("Error al cargar las obras","Cerrar",{duration:3e3,panelClass:["error-snackbar"]})}})}onSubmit(){return T(this,null,function*(){if(this.frenteForm.valid&&this.frenteId){this.isLoading=!0;try{let e=this.frenteForm.value,o=q(N({},e),{fecha_inicio:e.fecha_inicio.toISOString().split("T")[0],fecha_fin_estimada:e.fecha_fin_estimada?e.fecha_fin_estimada.toISOString().split("T")[0]:null,coordenadas_intermedias:e.coordenadas_intermedias||[]});yield this.actividadesService.updateFrente(this.frenteId,o),this.snackBar.open("Frente actualizado exitosamente","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),this.router.navigate(["/frentes"])}catch{this.snackBar.open("Error al actualizar el frente","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.isLoading=!1}}else this.markFormGroupTouched()})}markFormGroupTouched(){Object.keys(this.frenteForm.controls).forEach(e=>{this.frenteForm.get(e)?.markAsTouched()})}onCancel(){this.router.navigate(["/frentes"])}getErrorMessage(e){let o=this.frenteForm.get(e);return o?.hasError("required")?`${this.getFieldLabel(e)} es requerido`:o?.hasError("minlength")?`${this.getFieldLabel(e)} debe tener al menos ${o.errors?.minlength.requiredLength} caracteres`:o?.hasError("min")?`${this.getFieldLabel(e)} debe ser mayor a ${o.errors?.min.min}`:o?.hasError("max")?`${this.getFieldLabel(e)} debe ser menor a ${o.errors?.max.max}`:""}getFieldLabel(e){return{nombre:"Nombre",descripcion:"Descripci\xF3n",obra_id:"Obra",estado:"Estado",fecha_inicio:"Fecha de inicio",fecha_fin_estimada:"Fecha fin estimada",ubicacion_lat:"Latitud",ubicacion_lng:"Longitud",progreso_general:"Progreso general"}[e]||e}static{this.\u0275fac=function(o){return new(o||a)(v(oe),v(Oe),v(Ie),v(Q),v(H))}}static{this.\u0275cmp=z({type:a,selectors:[["app-frente-edit"]],viewQuery:function(o,r){if(o&1&&G(Je,5),o&2){let c;B(c=U())&&(r.mapContainer=c.first)}},decls:169,vars:25,consts:[["startPicker",""],["endPicker",""],["mapContainer",""],[1,"frente-edit-container"],[1,"frente-edit-card"],[4,"ngIf"],[1,"frente-form",3,"ngSubmit","formGroup"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","nombre","placeholder","Ej: Frente Norte"],["matSuffix",""],["matInput","","formControlName","descripcion","rows","3","placeholder","Descripci\xF3n detallada del frente de trabajo"],["appearance","outline",1,"half-width"],["formControlName","obra_id"],[3,"value",4,"ngFor","ngForOf"],["formControlName","estado"],["matInput","","formControlName","fecha_inicio",3,"matDatepicker"],["matSuffix","",3,"for"],["matInput","","formControlName","fecha_fin_estimada",3,"matDatepicker"],["matInput","","type","number","formControlName","ubicacion_lat","placeholder","Ej: 4.5709","step","0.000001"],["matInput","","type","number","formControlName","ubicacion_lng","placeholder","Ej: -74.2973","step","0.000001"],["matInput","","type","number","formControlName","progreso_general","placeholder","0-100","min","0","max","100"],[1,"form-section"],[1,"section-title"],["matInput","","type","number","formControlName","km_inicial","placeholder","Ej: 0.0","step","0.1","min","0"],["matInput","","type","number","formControlName","km_final","placeholder","Ej: 5.0","step","0.1","min","0"],["formGroupName","coordenadas_inicio",1,"form-row"],["matInput","","type","number","formControlName","lat","placeholder","Ej: -16.5","step","0.000001"],["matInput","","type","number","formControlName","lng","placeholder","Ej: -68.15","step","0.000001"],["formGroupName","coordenadas_fin",1,"form-row"],["mat-icon-button","","type","button","matTooltip","Limpiar mapa",1,"clear-map-btn",3,"click"],[1,"map-instructions"],[1,"map-container"],["class","form-section",4,"ngIf"],["align","end"],["mat-button","","type","button",3,"click","disabled"],["mat-raised-button","","color","primary",3,"click","disabled"],[3,"value"],[1,"intermediate-points-panel"],["formArrayName","coordenadas_intermedias"],["class","intermediate-point-item",3,"formGroupName",4,"ngFor","ngForOf"],[1,"intermediate-point-item",3,"formGroupName"],["matListIcon",""],[1,"point-details"],[1,"point-coordinates"],["appearance","outline",1,"coord-field"],["matInput","","type","number","formControlName","lat","step","0.000001","readonly",""],["matInput","","type","number","formControlName","lng","step","0.000001","readonly",""],["appearance","outline",1,"km-field"],["matInput","","type","number","formControlName","kilometraje","step","0.1","min","0","placeholder","Km"],["mat-icon-button","","type","button","matTooltip","Eliminar punto",1,"remove-point-btn",3,"click"]],template:function(o,r){if(o&1){let c=j();n(0,"div",3)(1,"mat-card",4)(2,"mat-card-header")(3,"mat-card-title")(4,"mat-icon"),i(5,"edit_location"),t(),i(6," Editar Frente "),t(),u(7,We,2,1,"mat-card-subtitle",5),t(),n(8,"mat-card-content")(9,"form",6),F("ngSubmit",function(){return M(c),E(r.onSubmit())}),n(10,"div",7)(11,"mat-form-field",8)(12,"mat-label"),i(13,"Nombre del Frente"),t(),g(14,"input",9),n(15,"mat-icon",10),i(16,"label"),t(),u(17,Xe,2,1,"mat-error",5),t()(),n(18,"div",7)(19,"mat-form-field",8)(20,"mat-label"),i(21,"Descripci\xF3n"),t(),g(22,"textarea",11),n(23,"mat-icon",10),i(24,"description"),t()()(),n(25,"div",7)(26,"mat-form-field",12)(27,"mat-label"),i(28,"Obra"),t(),n(29,"mat-select",13),u(30,Ye,2,2,"mat-option",14),t(),n(31,"mat-icon",10),i(32,"business"),t(),u(33,Ze,2,1,"mat-error",5),t(),n(34,"mat-form-field",12)(35,"mat-label"),i(36,"Estado"),t(),n(37,"mat-select",15),u(38,et,2,2,"mat-option",14),t(),n(39,"mat-icon",10),i(40,"flag"),t(),u(41,tt,2,1,"mat-error",5),t()(),n(42,"div",7)(43,"mat-form-field",12)(44,"mat-label"),i(45,"Fecha de Inicio"),t(),g(46,"input",16)(47,"mat-datepicker-toggle",17)(48,"mat-datepicker",null,0),u(50,nt,2,1,"mat-error",5),t(),n(51,"mat-form-field",12)(52,"mat-label"),i(53,"Fecha Fin Estimada"),t(),g(54,"input",18)(55,"mat-datepicker-toggle",17)(56,"mat-datepicker",null,1),t()(),n(58,"div",7)(59,"mat-form-field",12)(60,"mat-label"),i(61,"Latitud"),t(),g(62,"input",19),n(63,"mat-icon",10),i(64,"place"),t(),u(65,it,2,1,"mat-error",5),t(),n(66,"mat-form-field",12)(67,"mat-label"),i(68,"Longitud"),t(),g(69,"input",20),n(70,"mat-icon",10),i(71,"place"),t(),u(72,rt,2,1,"mat-error",5),t()(),n(73,"div",7)(74,"mat-form-field",8)(75,"mat-label"),i(76,"Progreso General (%)"),t(),g(77,"input",21),n(78,"mat-icon",10),i(79,"trending_up"),t(),u(80,at,2,1,"mat-error",5),t()(),n(81,"div",22)(82,"h3",23)(83,"mat-icon"),i(84,"straighten"),t(),i(85," Informaci\xF3n Kilom\xE9trica "),t(),n(86,"div",7)(87,"mat-form-field",12)(88,"mat-label"),i(89,"Kil\xF3metro Inicial"),t(),g(90,"input",24),n(91,"mat-icon",10),i(92,"start"),t(),u(93,ot,2,1,"mat-error",5),t(),n(94,"mat-form-field",12)(95,"mat-label"),i(96,"Kil\xF3metro Final"),t(),g(97,"input",25),n(98,"mat-icon",10),i(99,"flag"),t(),u(100,lt,2,1,"mat-error",5),t()(),n(101,"div",26)(102,"mat-form-field",12)(103,"mat-label"),i(104,"Latitud Inicio"),t(),g(105,"input",27),n(106,"mat-icon",10),i(107,"my_location"),t(),u(108,mt,2,0,"mat-error",5),t(),n(109,"mat-form-field",12)(110,"mat-label"),i(111,"Longitud Inicio"),t(),g(112,"input",28),n(113,"mat-icon",10),i(114,"my_location"),t(),u(115,dt,2,0,"mat-error",5),t()(),n(116,"div",29)(117,"mat-form-field",12)(118,"mat-label"),i(119,"Latitud Fin"),t(),g(120,"input",27),n(121,"mat-icon",10),i(122,"location_on"),t(),u(123,ct,2,0,"mat-error",5),t(),n(124,"mat-form-field",12)(125,"mat-label"),i(126,"Longitud Fin"),t(),g(127,"input",28),n(128,"mat-icon",10),i(129,"location_on"),t(),u(130,st,2,0,"mat-error",5),t()()(),n(131,"div",22)(132,"h3",23)(133,"mat-icon"),i(134,"map"),t(),i(135," Definir Ruta en Mapa "),n(136,"button",30),F("click",function(){return M(c),E(r.clearMap())}),n(137,"mat-icon"),i(138,"clear"),t()()(),n(139,"div",31)(140,"p")(141,"strong"),i(142,"Instrucciones:"),t()(),n(143,"ol")(144,"li"),i(145,"Haz clic en el mapa para establecer el "),n(146,"strong"),i(147,"punto de inicio"),t()(),n(148,"li"),i(149,"Haz clic nuevamente para establecer el "),n(150,"strong"),i(151,"punto final"),t()(),n(152,"li"),i(153,"Contin\xFAa haciendo clic para agregar "),n(154,"strong"),i(155,"puntos intermedios"),t(),i(156," (curvas)"),t()()(),g(157,"div",32,2),t(),u(159,ft,16,2,"div",33),t()(),n(160,"mat-card-actions",34)(161,"button",35),F("click",function(){return M(c),E(r.onCancel())}),n(162,"mat-icon"),i(163,"cancel"),t(),i(164," Cancelar "),t(),n(165,"button",36),F("click",function(){return M(c),E(r.onSubmit())}),n(166,"mat-icon"),i(167,"save"),t(),i(168),t()()()()}if(o&2){let c,p,h,b,C,k,S,I,P,y,O,w,L,D=V(49),A=V(57);l(7),m("ngIf",r.frente),l(2),m("formGroup",r.frenteForm),l(8),m("ngIf",((c=r.frenteForm.get("nombre"))==null?null:c.invalid)&&((c=r.frenteForm.get("nombre"))==null?null:c.touched)),l(13),m("ngForOf",r.obras),l(3),m("ngIf",((p=r.frenteForm.get("obra_id"))==null?null:p.invalid)&&((p=r.frenteForm.get("obra_id"))==null?null:p.touched)),l(5),m("ngForOf",r.estadosFrente),l(3),m("ngIf",((h=r.frenteForm.get("estado"))==null?null:h.invalid)&&((h=r.frenteForm.get("estado"))==null?null:h.touched)),l(5),m("matDatepicker",D),l(),m("for",D),l(3),m("ngIf",((b=r.frenteForm.get("fecha_inicio"))==null?null:b.invalid)&&((b=r.frenteForm.get("fecha_inicio"))==null?null:b.touched)),l(4),m("matDatepicker",A),l(),m("for",A),l(10),m("ngIf",((C=r.frenteForm.get("ubicacion_lat"))==null?null:C.invalid)&&((C=r.frenteForm.get("ubicacion_lat"))==null?null:C.touched)),l(7),m("ngIf",((k=r.frenteForm.get("ubicacion_lng"))==null?null:k.invalid)&&((k=r.frenteForm.get("ubicacion_lng"))==null?null:k.touched)),l(8),m("ngIf",((S=r.frenteForm.get("progreso_general"))==null?null:S.invalid)&&((S=r.frenteForm.get("progreso_general"))==null?null:S.touched)),l(13),m("ngIf",((I=r.frenteForm.get("km_inicial"))==null?null:I.invalid)&&((I=r.frenteForm.get("km_inicial"))==null?null:I.touched)),l(7),m("ngIf",((P=r.frenteForm.get("km_final"))==null?null:P.invalid)&&((P=r.frenteForm.get("km_final"))==null?null:P.touched)),l(8),m("ngIf",((y=r.frenteForm.get("coordenadas_inicio.lat"))==null?null:y.invalid)&&((y=r.frenteForm.get("coordenadas_inicio.lat"))==null?null:y.touched)),l(7),m("ngIf",((O=r.frenteForm.get("coordenadas_inicio.lng"))==null?null:O.invalid)&&((O=r.frenteForm.get("coordenadas_inicio.lng"))==null?null:O.touched)),l(8),m("ngIf",((w=r.frenteForm.get("coordenadas_fin.lat"))==null?null:w.invalid)&&((w=r.frenteForm.get("coordenadas_fin.lat"))==null?null:w.touched)),l(7),m("ngIf",((L=r.frenteForm.get("coordenadas_fin.lng"))==null?null:L.invalid)&&((L=r.frenteForm.get("coordenadas_fin.lng"))==null?null:L.touched)),l(29),m("ngIf",r.coordenadasIntermedias.length>0),l(2),m("disabled",r.isLoading),l(4),m("disabled",r.isLoading||r.frenteForm.invalid),l(3),_(" ",r.isLoading?"Guardando...":"Actualizar Frente"," ")}},dependencies:[K,R,$,le,Y,J,Z,W,X,ae,re,ee,ie,te,ne,be,xe,ge,_e,he,Me,Ce,Te,Le,we,Fe,ve,Ee,Se,ke,ze,Ve,De,Ae,Ge,Pe,fe,me,pe,ce,ue,se,de,Ke,Be,Ue,$e,Re,je,Ne,qe,ye],styles:[".frente-edit-container[_ngcontent-%COMP%]{padding:20px;max-width:800px;margin:0 auto}.frente-edit-card[_ngcontent-%COMP%]{box-shadow:0 4px 8px #0000001a;border-radius:8px}.frente-edit-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;margin:-24px -24px 24px;padding:24px;border-radius:8px 8px 0 0}.frente-edit-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#fff;margin:0}.frente-edit-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{color:#fffc;margin-top:8px}.frente-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-start}.form-section[_ngcontent-%COMP%]{margin-top:24px;padding:16px;border:1px solid #e0e0e0;border-radius:8px;background-color:#fafafa}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin:0 0 16px;color:#1976d2;font-size:16px;font-weight:500}.full-width[_ngcontent-%COMP%]{width:100%}.half-width[_ngcontent-%COMP%]{flex:1}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-mdc-form-field-outline[_ngcontent-%COMP%]{border-radius:8px}.mat-mdc-form-field-appearance-outline[_ngcontent-%COMP%]   .mat-mdc-form-field-outline-thick[_ngcontent-%COMP%]{border-width:2px}.mat-mdc-card-actions[_ngcontent-%COMP%]{padding:16px 24px;gap:12px}.mat-mdc-raised-button[_ngcontent-%COMP%]{border-radius:6px;font-weight:500}.mat-mdc-button[_ngcontent-%COMP%]{border-radius:6px}@media (max-width: 768px){.frente-edit-container[_ngcontent-%COMP%]{padding:16px}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.half-width[_ngcontent-%COMP%]{width:100%}.form-section[_ngcontent-%COMP%]{padding:12px}}.loading[_ngcontent-%COMP%]{opacity:.6;pointer-events:none}.mat-mdc-form-field.mat-form-field-invalid[_ngcontent-%COMP%]   .mat-mdc-form-field-outline-thick[_ngcontent-%COMP%]{border-color:#f44336}.success-snackbar[_ngcontent-%COMP%]{background-color:#4caf50!important;color:#fff!important}.error-snackbar[_ngcontent-%COMP%]{background-color:#f44336!important;color:#fff!important}mat-icon[_ngcontent-%COMP%]{color:#0000008a}.mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{margin-top:4px}.map-container[_ngcontent-%COMP%]{height:400px;width:100%;border:2px solid #e0e0e0;border-radius:8px;margin-top:16px;position:relative;overflow:hidden}.map-instructions[_ngcontent-%COMP%]{background-color:#e3f2fd;border:1px solid #2196f3;border-radius:6px;padding:12px;margin-bottom:16px}.map-instructions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#1976d2;font-weight:500}.map-instructions[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:0;padding-left:20px;color:#424242}.map-instructions[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px}.clear-map-btn[_ngcontent-%COMP%]{margin-left:auto;color:#f44336}.clear-map-btn[_ngcontent-%COMP%]:hover{background-color:#f443361a}.intermediate-points-panel[_ngcontent-%COMP%]{margin-top:16px;border-radius:8px;box-shadow:0 2px 4px #0000001a}.intermediate-point-item[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0;padding:16px 0}.intermediate-point-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.point-details[_ngcontent-%COMP%]{flex:1;margin-left:16px}.point-coordinates[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap}.coord-field[_ngcontent-%COMP%]{flex:1;min-width:120px}.km-field[_ngcontent-%COMP%]{flex:0 0 100px;min-width:100px}.remove-point-btn[_ngcontent-%COMP%]{color:#f44336;margin-left:8px}.remove-point-btn[_ngcontent-%COMP%]:hover{background-color:#f443361a}@media (max-width: 768px){.map-container[_ngcontent-%COMP%]{height:300px}.point-coordinates[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.coord-field[_ngcontent-%COMP%], .km-field[_ngcontent-%COMP%]{flex:none;width:100%;min-width:auto}.intermediate-point-item[_ngcontent-%COMP%]{padding:12px 0}.point-details[_ngcontent-%COMP%]{margin-left:12px}}.map-container[_ngcontent-%COMP%]   .leaflet-container[_ngcontent-%COMP%]{height:100%;width:100%;border-radius:6px}.map-container[_ngcontent-%COMP%]   .leaflet-control-zoom[_ngcontent-%COMP%], .map-container[_ngcontent-%COMP%]   .leaflet-bar[_ngcontent-%COMP%]{border-radius:6px}.start-marker[_ngcontent-%COMP%]{background-color:#4caf50;border:2px solid white;border-radius:50%;box-shadow:0 2px 4px #0000004d}.end-marker[_ngcontent-%COMP%]{background-color:#f44336;border:2px solid white;border-radius:50%;box-shadow:0 2px 4px #0000004d}.intermediate-marker[_ngcontent-%COMP%]{background-color:#ff9800;border:2px solid white;border-radius:50%;box-shadow:0 2px 4px #0000004d}"]})}}return a})();export{Rt as FrenteEditComponent};
