import{a as se}from"./chunk-SC72XGHO.js";import"./chunk-MS4AQ6UA.js";import{a as oe,b as me}from"./chunk-DMZJ7K26.js";import{c as ae}from"./chunk-7BCONPA6.js";import"./chunk-2GVF4P32.js";import"./chunk-WFXXN3GR.js";import{a as ie,b as ne}from"./chunk-YC5WDUOT.js";import{c as F,d as P,g as R}from"./chunk-YMTLAEZG.js";import"./chunk-G7YPFBNB.js";import{a as A,b as G,c as B,e as D,f as Y,h as H}from"./chunk-SNSQLCH6.js";import{b as Q,c as W}from"./chunk-BXKJ5BTH.js";import"./chunk-3RK6DDJD.js";import{C as z,F as J,G as K,b as O,d as p,g as T,h as V,l as k,n as L,q as N,v as q,x as j,y as $,z as U}from"./chunk-UJ3DDJ5Q.js";import{i as S,j as y,p as I,sa as X,ua as Z,va as ee,wa as te,xa as re}from"./chunk-4WMI5X77.js";import{Cb as v,Db as s,Nb as r,Ob as t,Pb as f,Tb as M,Xb as b,Yb as l,db as a,hc as n,ib as _,ic as h,jc as u,pa as g,pb as E,qa as x,vb as c}from"./chunk-B6672ACT.js";import"./chunk-X5YLR3NI.js";import"./chunk-ODN5LVDJ.js";function de(i,d){i&1&&(r(0,"div",9)(1,"div",10)(2,"mat-icon",11),n(3,"check_circle"),t(),r(4,"div")(5,"h3",12),n(6," \xA1Registro exitoso! "),t(),r(7,"p",13),n(8," Tu cuenta ha sido creada exitosamente. Ser\xE1s redirigido al login en unos segundos. "),t()()()())}function ce(i,d){if(i&1&&(r(0,"mat-error"),n(1),t()),i&2){let e=l(2);a(),u(" ",e.getFieldError("nombre")," ")}}function pe(i,d){if(i&1&&(r(0,"mat-error"),n(1),t()),i&2){let e=l(2);a(),u(" ",e.getFieldError("email")," ")}}function ue(i,d){if(i&1&&(r(0,"mat-option",33),n(1),t()),i&2){let e=d.$implicit;s("value",e.value),a(),u(" ",e.label," ")}}function fe(i,d){if(i&1&&(r(0,"mat-error"),n(1),t()),i&2){let e=l(2);a(),u(" ",e.getFieldError("rol")," ")}}function ge(i,d){if(i&1&&(r(0,"mat-error"),n(1),t()),i&2){let e=l(2);a(),u(" ",e.getFieldError("password")," ")}}function xe(i,d){if(i&1&&(r(0,"mat-error"),n(1),t()),i&2){let e=l(2);a(),u(" ",e.getFieldError("confirmPassword")," ")}}function _e(i,d){if(i&1&&(r(0,"div",34)(1,"div",10)(2,"mat-icon",35),n(3,"error"),t(),r(4,"p",36),n(5),t()()()),i&2){let e=l(2);a(5),h(e.error)}}function be(i,d){i&1&&f(0,"mat-spinner",37)}function he(i,d){if(i&1){let e=M();r(0,"mat-card",14)(1,"mat-card-header",15)(2,"mat-card-title",16),n(3," Registrarse "),t()(),r(4,"mat-card-content")(5,"form",17),b("ngSubmit",function(){g(e);let m=l();return x(m.onSubmit())}),r(6,"mat-form-field",18)(7,"mat-label"),n(8,"Nombre Completo"),t(),f(9,"input",19),r(10,"mat-icon",20),n(11,"person"),t(),c(12,ce,2,1,"mat-error",21),t(),r(13,"mat-form-field",18)(14,"mat-label"),n(15,"Email"),t(),f(16,"input",22),r(17,"mat-icon",20),n(18,"email"),t(),c(19,pe,2,1,"mat-error",21),t(),r(20,"mat-form-field",18)(21,"mat-label"),n(22,"Rol"),t(),r(23,"mat-select",23),c(24,ue,2,2,"mat-option",24),t(),r(25,"mat-icon",20),n(26,"work"),t(),c(27,fe,2,1,"mat-error",21),t(),r(28,"mat-form-field",18)(29,"mat-label"),n(30,"Contrase\xF1a"),t(),f(31,"input",25),r(32,"button",26),b("click",function(){g(e);let m=l();return x(m.hidePassword=!m.hidePassword)}),r(33,"mat-icon"),n(34),t()(),c(35,ge,2,1,"mat-error",21),t(),r(36,"mat-form-field",18)(37,"mat-label"),n(38,"Confirmar Contrase\xF1a"),t(),f(39,"input",27),r(40,"button",26),b("click",function(){g(e);let m=l();return x(m.hideConfirmPassword=!m.hideConfirmPassword)}),r(41,"mat-icon"),n(42),t()(),c(43,xe,2,1,"mat-error",21),t(),c(44,_e,6,1,"div",28),r(45,"button",29),c(46,be,1,0,"mat-spinner",30),n(47),t()()(),r(48,"mat-card-actions",31)(49,"button",32),n(50," \xBFYa tienes cuenta? Inicia sesi\xF3n "),t()()()}if(i&2){let e=l();a(5),s("formGroup",e.registerForm),a(7),s("ngIf",e.getFieldError("nombre")),a(7),s("ngIf",e.getFieldError("email")),a(5),s("ngForOf",e.roles),a(3),s("ngIf",e.getFieldError("rol")),a(4),s("type",e.hidePassword?"password":"text"),a(),v("aria-label","Hide password")("aria-pressed",e.hidePassword),a(2),h(e.hidePassword?"visibility_off":"visibility"),a(),s("ngIf",e.getFieldError("password")),a(4),s("type",e.hideConfirmPassword?"password":"text"),a(),v("aria-label","Hide confirm password")("aria-pressed",e.hideConfirmPassword),a(2),h(e.hideConfirmPassword?"visibility_off":"visibility"),a(),s("ngIf",e.getFieldError("confirmPassword")),a(),s("ngIf",e.error),a(),s("disabled",!e.registerForm.valid||e.loading),a(),s("ngIf",e.loading),a(),u(" ",e.loading?"Registrando...":"Crear Cuenta"," ")}}var De=(()=>{class i{constructor(e,o,m){this.fb=e,this.authService=o,this.router=m,this.loading=!1,this.error=null,this.success=!1,this.hidePassword=!0,this.hideConfirmPassword=!0,this.roles=[{value:"logistica",label:"Personal de Log\xEDstica"},{value:"residente",label:"Residente de Obra"}],this.registerForm=this.fb.group({nombre:["",[p.required,p.minLength(2)]],email:["",[p.required,p.email]],password:["",[p.required,p.minLength(6)]],confirmPassword:["",[p.required]],rol:["logistica",[p.required]]},{validators:this.passwordMatchValidator})}ngOnInit(){this.authService.isAuthenticated$.subscribe(e=>{e&&this.router.navigate(["/dashboard"])})}passwordMatchValidator(e){let o=e.get("password"),m=e.get("confirmPassword");return o&&m&&o.value!==m.value?(m.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}onSubmit(){if(this.registerForm.valid){this.loading=!0,this.error=null;let{email:e,password:o,nombre:m,rol:le}=this.registerForm.value;this.authService.signUp(e,o,m,le).subscribe({next:({user:C,error:w})=>{this.loading=!1,w?this.error=this.getErrorMessage(w):C&&(this.success=!0,setTimeout(()=>{this.router.navigate(["/login"])},3e3))},error:C=>{this.loading=!1,this.error="Error de conexi\xF3n. Intente nuevamente."}})}}getErrorMessage(e){switch(e.message){case"User already registered":return"Este email ya est\xE1 registrado. Intente con otro email.";case"Password should be at least 6 characters":return"La contrase\xF1a debe tener al menos 6 caracteres.";case"Invalid email":return"Email inv\xE1lido. Verifique el formato.";case"Signup is disabled":return"El registro est\xE1 deshabilitado temporalmente.";default:return"Error al registrar usuario. Intente nuevamente."}}getFieldError(e){let o=this.registerForm.get(e);if(o?.errors&&o.touched){if(o.errors.required)return`${{nombre:"Nombre",email:"Email",password:"Contrase\xF1a",confirmPassword:"Confirmaci\xF3n de contrase\xF1a",rol:"Rol"}[e]} es requerido`;if(o.errors.email)return"Email inv\xE1lido";if(o.errors.minlength){if(e==="password")return"La contrase\xF1a debe tener al menos 6 caracteres";if(e==="nombre")return"El nombre debe tener al menos 2 caracteres"}if(o.errors.passwordMismatch)return"Las contrase\xF1as no coinciden"}return""}static{this.\u0275fac=function(o){return new(o||i)(_(q),_(se),_(F))}}static{this.\u0275cmp=E({type:i,selectors:[["app-register"]],decls:14,vars:2,consts:[[1,"min-h-screen","bg-gradient-to-br","from-green-50","to-emerald-100","flex","items-center","justify-center","py-12","px-4","sm:px-6","lg:px-8"],[1,"max-w-md","w-full","space-y-8"],[1,"text-center"],[1,"text-6xl","text-emerald-600","mb-4"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-lg","text-gray-600"],["class","bg-green-50 border border-green-200 rounded-md p-4",4,"ngIf"],["class","shadow-xl",4,"ngIf"],[1,"text-center","text-sm","text-gray-500"],[1,"bg-green-50","border","border-green-200","rounded-md","p-4"],[1,"flex"],[1,"text-green-400","mr-2"],[1,"text-sm","font-medium","text-green-800"],[1,"text-sm","text-green-700","mt-1"],[1,"shadow-xl"],[1,"pb-4"],[1,"text-xl","font-semibold","text-center","w-full"],[1,"space-y-6",3,"ngSubmit","formGroup"],["appearance","outline",1,"w-full"],["matInput","","type","text","formControlName","nombre","placeholder","Ingrese su nombre completo","autocomplete","name"],["matSuffix",""],[4,"ngIf"],["matInput","","type","email","formControlName","email","placeholder","usuario@ejemplo.com","autocomplete","email"],["formControlName","rol"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","password","placeholder","M\xEDnimo 6 caracteres","autocomplete","new-password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["matInput","","formControlName","confirmPassword","placeholder","Repita su contrase\xF1a","autocomplete","new-password",3,"type"],["class","bg-red-50 border border-red-200 rounded-md p-3",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",1,"w-full","py-3","text-lg","font-medium",3,"disabled"],["diameter","20","class","mr-2",4,"ngIf"],[1,"flex","justify-center","pt-4"],["mat-button","","color","accent","routerLink","/login",1,"w-full"],[3,"value"],[1,"bg-red-50","border","border-red-200","rounded-md","p-3"],[1,"text-red-400","mr-2"],[1,"text-sm","text-red-700"],["diameter","20",1,"mr-2"]],template:function(o,m){o&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-icon",3),n(4,"person_add"),t(),r(5,"h2",4),n(6," Crear Cuenta "),t(),r(7,"p",5),n(8," Sistema de Gesti\xF3n de Carreteras "),t()(),c(9,de,9,0,"div",6)(10,he,51,19,"mat-card",7),r(11,"div",8)(12,"p"),n(13,"\xA9 2024 Sistema de Gesti\xF3n de Carreteras. Todos los derechos reservados."),t()()()()),o&2&&(a(9),s("ngIf",m.success),a(),s("ngIf",!m.success))},dependencies:[I,S,y,j,k,O,T,V,L,N,R,P,H,A,D,B,Y,G,K,J,$,U,z,W,Q,ee,Z,X,re,te,me,oe,ae,ne,ie],styles:[".mat-mdc-card[_ngcontent-%COMP%]{border-radius:12px;padding:2rem}.mat-mdc-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-raised-button[_ngcontent-%COMP%]{border-radius:8px;height:48px}.mat-mdc-icon-button[_ngcontent-%COMP%]{color:#0000008a}.mat-mdc-select[_ngcontent-%COMP%]{width:100%}.mat-mdc-card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}.mat-mdc-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.mat-mdc-progress-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}.success-message[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 640px){.mat-mdc-card[_ngcontent-%COMP%]{padding:1.5rem;margin:1rem}}"]})}}return i})();export{De as RegisterComponent};
