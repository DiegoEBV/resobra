import{a as ui}from"./chunk-7VEMEEZM.js";import{d as Jt}from"./chunk-LUBQLQMY.js";import{a as ri,b as si}from"./chunk-UOQIYJR2.js";import{a as Xt,b as Zt}from"./chunk-VL2NEHIJ.js";import{a as Bt,b as Ht}from"./chunk-7ORSVDA5.js";import{c as We,g as Ye}from"./chunk-NB3HFZVT.js";import{a as Ct,b as St,c as kt,f as Mt,h as Ot}from"./chunk-Q7IKAR2H.js";import{a as hi}from"./chunk-6E7IQQWE.js";import{a as xi}from"./chunk-NXOYKD4N.js";import{a as li,b as ci,c as di,d as pi}from"./chunk-UZ4WZDEA.js";import{b as mi}from"./chunk-FPI72KVE.js";import"./chunk-S62OKC6W.js";import{c as ti,g as ii}from"./chunk-XUW3P5LX.js";import"./chunk-MS4AQ6UA.js";import{a as ni,b as oi}from"./chunk-4WQTEZOQ.js";import{c as ai,f as Ie}from"./chunk-T4G463S7.js";import"./chunk-ZBAF6PQQ.js";import{a as ei}from"./chunk-EBI2TTL3.js";import{a as Yt}from"./chunk-4SALBWPR.js";import"./chunk-SGFNFZY3.js";import{a as Ut,b as Wt}from"./chunk-ZJYJPMQY.js";import{b as Tt,c as Dt}from"./chunk-5ME2OED7.js";import{A as At,C as wt,F as Pt,G as Ft,H as ue,N as Ee,Q as Qt,b as Xe,d as h,e as Ze,g as Je,h as et,l as tt,m as it,n as at,o as nt,p as ot,q as rt,r as st,s as lt,v as ct,w as dt,x as pt,y as Et,z as It}from"./chunk-GGGSXGOB.js";import{A as mt,Aa as $t,Ba as Gt,D as ut,I as ht,Ja as Kt,K as ft,L as _t,V as gt,W as vt,Y as bt,aa as yt,ba as xt,ca as J,i as Ke,j as Qe,k as Oe,ma as Lt,oa as Rt,p as Ue,pa as Nt,qa as Vt,ra as zt,sa as jt,ta as he,ua as fe,wa as qt}from"./chunk-MD4YSZKI.js";import{$b as O,Aa as j,Ba as xe,Bc as ne,Cb as F,Db as p,Ea as U,Eb as He,Ec as $,Fb as H,Fc as Ge,Ga as Be,Gb as le,Ha as te,Hb as qe,Ib as I,Jb as ce,Kb as de,Lb as pe,Ma as Ce,Mb as o,Nb as n,Ob as y,Rb as q,Sb as ae,V as z,W as Ne,Wb as S,X as C,Xb as _,Yb as Y,Zb as X,a as De,ac as V,ba as Ve,bc as v,ca as Q,cc as b,db as l,ea as se,f as K,fb as B,fc as Z,gc as r,ha as f,hb as Se,hc as A,ia as ze,ib as N,ic as T,ja as je,k as Le,kb as ke,oa as be,pa as k,pb as w,pc as me,q as Re,qa as M,qb as W,rb as P,sc as Me,ta as ye,tb as ie,vb as m,wc as $e}from"./chunk-OYRL5FJJ.js";import"./chunk-X5YLR3NI.js";import{g as yi,i as ee}from"./chunk-ODN5LVDJ.js";var Si=["*"];function ki(i,c){i&1&&X(0)}var we=(()=>{class i{_elementRef=f(U);constructor(){}focus(){this._elementRef.nativeElement.focus()}static \u0275fac=function(t){return new(t||i)};static \u0275dir=P({type:i,selectors:[["","cdkStepHeader",""]],hostAttrs:["role","tab"]})}return i})(),Pe=(()=>{class i{template=f(B);constructor(){}static \u0275fac=function(t){return new(t||i)};static \u0275dir=P({type:i,selectors:[["","cdkStepLabel",""]]})}return i})();var D={NUMBER:"number",EDIT:"edit",DONE:"done",ERROR:"error"},Mi=new se("STEPPER_GLOBAL_OPTIONS"),_e=(()=>{class i{_stepperOptions;_stepper=f(ge);_displayDefaultIndicatorType;stepLabel;_childForms;content;stepControl;interacted=!1;interactedStream=new j;label;errorMessage;ariaLabel;ariaLabelledby;state;editable=!0;optional=!1;get completed(){return this._completedOverride==null?this._getDefaultCompleted():this._completedOverride}set completed(e){this._completedOverride=e}_completedOverride=null;_getDefaultCompleted(){return this.stepControl?this.stepControl.valid&&this.interacted:this.interacted}get hasError(){return this._customError==null?this._getDefaultError():this._customError}set hasError(e){this._customError=e}_customError=null;_getDefaultError(){return this.stepControl&&this.stepControl.invalid&&this.interacted}constructor(){let e=f(Mi,{optional:!0});this._stepperOptions=e||{},this._displayDefaultIndicatorType=this._stepperOptions.displayDefaultIndicatorType!==!1}select(){this._stepper.selected=this}reset(){this.interacted=!1,this._completedOverride!=null&&(this._completedOverride=!1),this._customError!=null&&(this._customError=!1),this.stepControl&&(this._childForms?.forEach(e=>e.resetForm?.()),this.stepControl.reset())}ngOnChanges(){this._stepper._stateChanged()}_markAsInteracted(){this.interacted||(this.interacted=!0,this.interactedStream.emit(this))}_showError(){return this._stepperOptions.showError??this._customError!=null}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["cdk-step"]],contentQueries:function(t,a,s){if(t&1&&(O(s,Pe,5),O(s,Ze,5)),t&2){let d;v(d=b())&&(a.stepLabel=d.first),v(d=b())&&(a._childForms=d)}},viewQuery:function(t,a){if(t&1&&V(B,7),t&2){let s;v(s=b())&&(a.content=s.first)}},inputs:{stepControl:"stepControl",label:"label",errorMessage:"errorMessage",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],state:"state",editable:[2,"editable","editable",$],optional:[2,"optional","optional",$],completed:[2,"completed","completed",$],hasError:[2,"hasError","hasError",$]},outputs:{interactedStream:"interacted"},exportAs:["cdkStep"],features:[be],ngContentSelectors:Si,decls:1,vars:0,template:function(t,a){t&1&&(Y(),m(0,ki,1,0,"ng-template"))},encapsulation:2,changeDetection:0})}return i})(),ge=(()=>{class i{_dir=f(yt,{optional:!0});_changeDetectorRef=f(ne);_elementRef=f(U);_destroyed=new K;_keyManager;_steps;steps=new te;_stepHeader;_sortedHeaders=new te;linear=!1;get selectedIndex(){return this._selectedIndex}set selectedIndex(e){this._steps?(this._isValidIndex(e),this._selectedIndex!==e&&(this.selected?._markAsInteracted(),!this._anyControlsInvalidOrPending(e)&&(e>=this._selectedIndex||this.steps.toArray()[e].editable)&&this._updateSelectedItemIndex(e))):this._selectedIndex=e}_selectedIndex=0;get selected(){return this.steps?this.steps.toArray()[this.selectedIndex]:void 0}set selected(e){this.selectedIndex=e&&this.steps?this.steps.toArray().indexOf(e):-1}selectionChange=new j;selectedIndexChange=new j;_groupId=f(gt).getId("cdk-stepper-");get orientation(){return this._orientation}set orientation(e){this._orientation=e,this._keyManager&&this._keyManager.withVerticalOrientation(e==="vertical")}_orientation="horizontal";constructor(){}ngAfterContentInit(){this._steps.changes.pipe(z(this._steps),C(this._destroyed)).subscribe(e=>{this.steps.reset(e.filter(t=>t._stepper===this)),this.steps.notifyOnChanges()})}ngAfterViewInit(){if(this._stepHeader.changes.pipe(z(this._stepHeader),C(this._destroyed)).subscribe(e=>{this._sortedHeaders.reset(e.toArray().sort((t,a)=>t._elementRef.nativeElement.compareDocumentPosition(a._elementRef.nativeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)),this._sortedHeaders.notifyOnChanges()}),this._keyManager=new bt(this._sortedHeaders).withWrap().withHomeAndEnd().withVerticalOrientation(this._orientation==="vertical"),this._keyManager.updateActiveItem(this.selectedIndex),(this._dir?this._dir.change:Le()).pipe(z(this._layoutDirection()),C(this._destroyed)).subscribe(e=>this._keyManager?.withHorizontalOrientation(e)),this._keyManager.updateActiveItem(this._selectedIndex),this.steps.changes.subscribe(()=>{this.selected||(this._selectedIndex=Math.max(this._selectedIndex-1,0))}),this._isValidIndex(this._selectedIndex)||(this._selectedIndex=0),this.linear&&this._selectedIndex>0){let e=this.steps.toArray().slice(0,this._selectedIndex);for(let t of e)t._markAsInteracted()}}ngOnDestroy(){this._keyManager?.destroy(),this.steps.destroy(),this._sortedHeaders.destroy(),this._destroyed.next(),this._destroyed.complete()}next(){this.selectedIndex=Math.min(this._selectedIndex+1,this.steps.length-1)}previous(){this.selectedIndex=Math.max(this._selectedIndex-1,0)}reset(){this._updateSelectedItemIndex(0),this.steps.forEach(e=>e.reset()),this._stateChanged()}_getStepLabelId(e){return`${this._groupId}-label-${e}`}_getStepContentId(e){return`${this._groupId}-content-${e}`}_stateChanged(){this._changeDetectorRef.markForCheck()}_getAnimationDirection(e){let t=e-this._selectedIndex;return t<0?this._layoutDirection()==="rtl"?"next":"previous":t>0?this._layoutDirection()==="rtl"?"previous":"next":"current"}_getIndicatorType(e,t=D.NUMBER){let a=this.steps.toArray()[e],s=this._isCurrentStep(e);return a._displayDefaultIndicatorType?this._getDefaultIndicatorLogic(a,s):this._getGuidelineLogic(a,s,t)}_getDefaultIndicatorLogic(e,t){return e._showError()&&e.hasError&&!t?D.ERROR:!e.completed||t?D.NUMBER:e.editable?D.EDIT:D.DONE}_getGuidelineLogic(e,t,a=D.NUMBER){return e._showError()&&e.hasError&&!t?D.ERROR:e.completed&&!t?D.DONE:e.completed&&t?a:e.editable&&t?D.EDIT:a}_isCurrentStep(e){return this._selectedIndex===e}_getFocusIndex(){return this._keyManager?this._keyManager.activeItemIndex:this._selectedIndex}_updateSelectedItemIndex(e){let t=this.steps.toArray();this.selectionChange.emit({selectedIndex:e,previouslySelectedIndex:this._selectedIndex,selectedStep:t[e],previouslySelectedStep:t[this._selectedIndex]}),this._keyManager&&(this._containsFocus()?this._keyManager.setActiveItem(e):this._keyManager.updateActiveItem(e)),this._selectedIndex=e,this.selectedIndexChange.emit(this._selectedIndex),this._stateChanged()}_onKeydown(e){let t=vt(e),a=e.keyCode,s=this._keyManager;s?.activeItemIndex!=null&&!t&&(a===32||a===13)?(this.selectedIndex=s.activeItemIndex,e.preventDefault()):s?.setFocusOrigin("keyboard").onKeydown(e)}_anyControlsInvalidOrPending(e){return this.linear&&e>=0?this.steps.toArray().slice(0,e).some(t=>{let a=t.stepControl;return(a?a.invalid||a.pending||!t.interacted:!t.completed)&&!t.optional&&!t._completedOverride}):!1}_layoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_containsFocus(){let e=this._elementRef.nativeElement,t=mt();return e===t||e.contains(t)}_isValidIndex(e){return e>-1&&(!this.steps||e<this.steps.length)}static \u0275fac=function(t){return new(t||i)};static \u0275dir=P({type:i,selectors:[["","cdkStepper",""]],contentQueries:function(t,a,s){if(t&1&&(O(s,_e,5),O(s,we,5)),t&2){let d;v(d=b())&&(a._steps=d),v(d=b())&&(a._stepHeader=d)}},inputs:{linear:[2,"linear","linear",$],selectedIndex:[2,"selectedIndex","selectedIndex",Ge],selected:"selected",orientation:"orientation"},outputs:{selectionChange:"selectionChange",selectedIndexChange:"selectedIndexChange"},exportAs:["cdkStepper"]})}return i})();var fi=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=W({type:i});static \u0275inj=Q({imports:[xt]})}return i})();function Oi(i,c){if(i&1&&q(0,2),i&2){let e=_();p("ngTemplateOutlet",e.iconOverrides[e.state])("ngTemplateOutletContext",e._getIconContext())}}function Ei(i,c){if(i&1&&(o(0,"span",7),r(1),n()),i&2){let e=_(2);l(),A(e._getDefaultTextForState(e.state))}}function Ii(i,c){if(i&1&&(o(0,"span",8),r(1),n()),i&2){let e=_(3);l(),A(e._intl.completedLabel)}}function Ai(i,c){if(i&1&&(o(0,"span",8),r(1),n()),i&2){let e=_(3);l(),A(e._intl.editableLabel)}}function wi(i,c){if(i&1&&(m(0,Ii,2,1,"span",8)(1,Ai,2,1,"span",8),o(2,"mat-icon",7),r(3),n()),i&2){let e=_(2);I(e.state==="done"?0:e.state==="edit"?1:-1),l(3),A(e._getDefaultTextForState(e.state))}}function Pi(i,c){if(i&1&&m(0,Ei,2,1,"span",7)(1,wi,4,2),i&2){let e,t=_();I((e=t.state)==="number"?0:1)}}function Fi(i,c){i&1&&(o(0,"div",4),q(1,9),n()),i&2&&(l(),p("ngTemplateOutlet",c.template))}function Ti(i,c){if(i&1&&(o(0,"div",4),r(1),n()),i&2){let e=_();l(),A(e.label)}}function Di(i,c){if(i&1&&(o(0,"div",5),r(1),n()),i&2){let e=_();l(),A(e._intl.optionalLabel)}}function Li(i,c){if(i&1&&(o(0,"div",6),r(1),n()),i&2){let e=_();l(),A(e.errorMessage)}}var _i=["*"];function Ri(i,c){}function Ni(i,c){if(i&1&&(X(0),m(1,Ri,0,0,"ng-template",0)),i&2){let e=_();l(),p("cdkPortalOutlet",e._portal)}}var Vi=["animatedContainer"],gi=(i,c)=>({step:i,i:c});function zi(i,c){i&1&&X(0)}function ji(i,c){i&1&&y(0,"div",7)}function Bi(i,c){if(i&1&&(q(0,6),m(1,ji,1,0,"div",7)),i&2){let e=c.$implicit,t=c.$index,a=c.$index,s=c.$count;_(2);let d=Z(4);p("ngTemplateOutlet",d)("ngTemplateOutletContext",Me(3,gi,e,t)),l(),I(a!==s-1?1:-1)}}function Hi(i,c){if(i&1&&(o(0,"div",8,1),q(2,9),n()),i&2){let e=c.$implicit,t=c.$index,a=_(2);le("mat-horizontal-stepper-content-"+a._getAnimationDirection(t)),p("id",a._getStepContentId(t)),F("aria-labelledby",a._getStepLabelId(t))("inert",a.selectedIndex===t?null:""),l(2),p("ngTemplateOutlet",e.content)}}function qi(i,c){if(i&1&&(o(0,"div",2)(1,"div",3),de(2,Bi,2,6,null,null,ce),n(),o(4,"div",4),de(5,Hi,3,6,"div",5,ce),n()()),i&2){let e=_();l(2),pe(e.steps),l(3),pe(e.steps)}}function $i(i,c){if(i&1&&(o(0,"div",10),q(1,6),o(2,"div",11,1)(4,"div",12)(5,"div",13),q(6,9),n()()()()),i&2){let e=c.$implicit,t=c.$index,a=c.$index,s=c.$count,d=_(2),g=Z(4);l(),p("ngTemplateOutlet",g)("ngTemplateOutletContext",Me(10,gi,e,t)),l(),H("mat-stepper-vertical-line",a!==s-1)("mat-vertical-content-container-active",d.selectedIndex===t),F("inert",d.selectedIndex===t?null:""),l(2),p("id",d._getStepContentId(t)),F("aria-labelledby",d._getStepLabelId(t)),l(2),p("ngTemplateOutlet",e.content)}}function Gi(i,c){if(i&1&&de(0,$i,7,13,"div",10,ce),i&2){let e=_();pe(e.steps)}}function Ki(i,c){if(i&1){let e=ae();o(0,"mat-step-header",14),S("click",function(){let a=k(e).step;return M(a.select())})("keydown",function(a){k(e);let s=_();return M(s._onKeydown(a))}),n()}if(i&2){let e=c.step,t=c.i,a=_();H("mat-horizontal-stepper-header",a.orientation==="horizontal")("mat-vertical-stepper-header",a.orientation==="vertical"),p("tabIndex",a._getFocusIndex()===t?0:-1)("id",a._getStepLabelId(t))("index",t)("state",a._getIndicatorType(t,e.state))("label",e.stepLabel||e.label)("selected",a.selectedIndex===t)("active",a._stepIsNavigable(t,e))("optional",e.optional)("errorMessage",e.errorMessage)("iconOverrides",a._iconOverrides)("disableRipple",a.disableRipple||!a._stepIsNavigable(t,e))("color",e.color||a.color),F("aria-posinset",t+1)("aria-setsize",a.steps.length)("aria-controls",a._getStepContentId(t))("aria-selected",a.selectedIndex==t)("aria-label",e.ariaLabel||null)("aria-labelledby",!e.ariaLabel&&e.ariaLabelledby?e.ariaLabelledby:null)("aria-disabled",a._stepIsNavigable(t,e)?null:!0)}}var Fe=(()=>{class i extends Pe{static \u0275fac=(()=>{let e;return function(a){return(e||(e=ye(i)))(a||i)}})();static \u0275dir=P({type:i,selectors:[["","matStepLabel",""]],features:[ie]})}return i})(),ve=(()=>{class i{changes=new K;optionalLabel="Optional";completedLabel="Completed";editableLabel="Editable";static \u0275fac=function(t){return new(t||i)};static \u0275prov=Ve({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Qi(i){return i||new ve}var Ui={provide:ve,deps:[[new ze,new je,ve]],useFactory:Qi},Te=(()=>{class i extends we{_intl=f(ve);_focusMonitor=f(ht);_intlSubscription;state;label;errorMessage;iconOverrides;index;selected;active;optional;disableRipple;color;constructor(){super();let e=f(ft);e.load(Rt),e.load(_t);let t=f(ne);this._intlSubscription=this._intl.changes.subscribe(()=>t.markForCheck())}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._intlSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._elementRef)}focus(e,t){e?this._focusMonitor.focusVia(this._elementRef,e,t):this._elementRef.nativeElement.focus(t)}_stringLabel(){return this.label instanceof Fe?null:this.label}_templateLabel(){return this.label instanceof Fe?this.label:null}_getHostElement(){return this._elementRef.nativeElement}_getIconContext(){return{index:this.index,active:this.active,optional:this.optional}}_getDefaultTextForState(e){return e=="number"?`${this.index+1}`:e=="edit"?"create":e=="error"?"warning":e}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["mat-step-header"]],hostAttrs:["role","tab",1,"mat-step-header"],hostVars:2,hostBindings:function(t,a){t&2&&le("mat-"+(a.color||"primary"))},inputs:{state:"state",label:"label",errorMessage:"errorMessage",iconOverrides:"iconOverrides",index:"index",selected:"selected",active:"active",optional:"optional",disableRipple:"disableRipple",color:"color"},features:[ie],decls:10,vars:17,consts:[["matRipple","",1,"mat-step-header-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-step-icon-content"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-step-label"],[1,"mat-step-text-label"],[1,"mat-step-optional"],[1,"mat-step-sub-label-error"],["aria-hidden","true"],[1,"cdk-visually-hidden"],[3,"ngTemplateOutlet"]],template:function(t,a){if(t&1&&(y(0,"div",0),o(1,"div")(2,"div",1),m(3,Oi,1,2,"ng-container",2)(4,Pi,2,1),n()(),o(5,"div",3),m(6,Fi,2,1,"div",4)(7,Ti,2,1,"div",4)(8,Di,2,1,"div",5)(9,Li,2,1,"div",6),n()),t&2){let s;p("matRippleTrigger",a._getHostElement())("matRippleDisabled",a.disableRipple),l(),qe("mat-step-icon-state-",a.state," mat-step-icon"),H("mat-step-icon-selected",a.selected),l(2),I(a.iconOverrides&&a.iconOverrides[a.state]?3:4),l(2),H("mat-step-label-active",a.active)("mat-step-label-selected",a.selected)("mat-step-label-error",a.state=="error"),l(),I((s=a._templateLabel())?6:a._stringLabel()?7:-1,s),l(2),I(a.optional&&a.state!="error"?8:-1),l(),I(a.state==="error"?9:-1)}},dependencies:[Lt,Oe,he],styles:[`.mat-step-header{overflow:hidden;outline:none;cursor:pointer;position:relative;box-sizing:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-step-header:focus .mat-focus-indicator::before{content:""}.mat-step-header:hover[aria-disabled=true]{cursor:default}.mat-step-header:hover:not([aria-disabled]),.mat-step-header:hover[aria-disabled=false]{background-color:var(--mat-stepper-header-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-inverse-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent));border-radius:var(--mat-stepper-header-hover-state-layer-shape, var(--mat-sys-corner-medium))}.mat-step-header.cdk-keyboard-focused,.mat-step-header.cdk-program-focused{background-color:var(--mat-stepper-header-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-inverse-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));border-radius:var(--mat-stepper-header-focus-state-layer-shape, var(--mat-sys-corner-medium))}@media(hover: none){.mat-step-header:hover{background:none}}@media(forced-colors: active){.mat-step-header{outline:solid 1px}.mat-step-header[aria-selected=true] .mat-step-label{text-decoration:underline}.mat-step-header[aria-disabled=true]{outline-color:GrayText}.mat-step-header[aria-disabled=true] .mat-step-label,.mat-step-header[aria-disabled=true] .mat-step-icon,.mat-step-header[aria-disabled=true] .mat-step-optional{color:GrayText}}.mat-step-optional{font-size:12px;color:var(--mat-stepper-header-optional-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-sub-label-error{font-size:12px;font-weight:normal}.mat-step-icon{border-radius:50%;height:24px;width:24px;flex-shrink:0;position:relative;color:var(--mat-stepper-header-icon-foreground-color, var(--mat-sys-surface));background-color:var(--mat-stepper-header-icon-background-color, var(--mat-sys-on-surface-variant))}.mat-step-icon-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.mat-step-icon .mat-icon{font-size:16px;height:16px;width:16px}.mat-step-icon-state-error{background-color:var(--mat-stepper-header-error-state-icon-background-color, transparent);color:var(--mat-stepper-header-error-state-icon-foreground-color, var(--mat-sys-error))}.mat-step-icon-state-error .mat-icon{font-size:24px;height:24px;width:24px}.mat-step-label{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:50px;vertical-align:middle;font-family:var(--mat-stepper-header-label-text-font, var(--mat-sys-title-small-font));font-size:var(--mat-stepper-header-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-stepper-header-label-text-weight, var(--mat-sys-title-small-weight));color:var(--mat-stepper-header-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-label.mat-step-label-active{color:var(--mat-stepper-header-selected-state-label-text-color, var(--mat-sys-on-surface-variant))}.mat-step-label.mat-step-label-error{color:var(--mat-stepper-header-error-state-label-text-color, var(--mat-sys-error));font-size:var(--mat-stepper-header-error-state-label-text-size, var(--mat-sys-title-small-size))}.mat-step-label.mat-step-label-selected{font-size:var(--mat-stepper-header-selected-state-label-text-size, var(--mat-sys-title-small-size));font-weight:var(--mat-stepper-header-selected-state-label-text-weight, var(--mat-sys-title-small-weight))}.mat-step-text-label{text-overflow:ellipsis;overflow:hidden}.mat-step-header .mat-step-header-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-step-icon-selected{background-color:var(--mat-stepper-header-selected-state-icon-background-color, var(--mat-sys-primary));color:var(--mat-stepper-header-selected-state-icon-foreground-color, var(--mat-sys-on-primary))}.mat-step-icon-state-done{background-color:var(--mat-stepper-header-done-state-icon-background-color);color:var(--mat-stepper-header-done-state-icon-foreground-color)}.mat-step-icon-state-edit{background-color:var(--mat-stepper-header-edit-state-icon-background-color, var(--mat-sys-primary));color:var(--mat-stepper-header-edit-state-icon-foreground-color, var(--mat-sys-on-primary))}
`],encapsulation:2,changeDetection:0})}return i})(),Wi=(()=>{class i{templateRef=f(B);name;constructor(){}static \u0275fac=function(t){return new(t||i)};static \u0275dir=P({type:i,selectors:[["ng-template","matStepperIcon",""]],inputs:{name:[0,"matStepperIcon","name"]}})}return i})(),Yi=(()=>{class i{_template=f(B);constructor(){}static \u0275fac=function(t){return new(t||i)};static \u0275dir=P({type:i,selectors:[["ng-template","matStepContent",""]]})}return i})(),Xi=(()=>{class i extends _e{_errorStateMatcher=f(ue,{skipSelf:!0});_viewContainerRef=f(ke);_isSelected=De.EMPTY;stepLabel=void 0;color;_lazyContent;_portal;ngAfterContentInit(){this._isSelected=this._stepper.steps.changes.pipe(Ne(()=>this._stepper.selectionChange.pipe(Re(e=>e.selectedStep===this),z(this._stepper.selected===this)))).subscribe(e=>{e&&this._lazyContent&&!this._portal&&(this._portal=new qt(this._lazyContent._template,this._viewContainerRef))})}ngOnDestroy(){this._isSelected.unsubscribe()}isErrorState(e,t){let a=this._errorStateMatcher.isErrorState(e,t),s=!!(e&&e.invalid&&this.interacted);return a||s}static \u0275fac=(()=>{let e;return function(a){return(e||(e=ye(i)))(a||i)}})();static \u0275cmp=w({type:i,selectors:[["mat-step"]],contentQueries:function(t,a,s){if(t&1&&(O(s,Fe,5),O(s,Yi,5)),t&2){let d;v(d=b())&&(a.stepLabel=d.first),v(d=b())&&(a._lazyContent=d.first)}},hostAttrs:["hidden",""],inputs:{color:"color"},exportAs:["matStep"],features:[me([{provide:ue,useExisting:i},{provide:_e,useExisting:i}]),ie],ngContentSelectors:_i,decls:1,vars:0,consts:[[3,"cdkPortalOutlet"]],template:function(t,a){t&1&&(Y(),m(0,Ni,2,1,"ng-template"))},dependencies:[$t],encapsulation:2,changeDetection:0})}return i})(),Zi=(()=>{class i extends ge{_ngZone=f(xe);_renderer=f(Se);_animationsModule=f(Ce,{optional:!0});_cleanupTransition;_isAnimating=Be(!1);_stepHeader=void 0;_animatedContainers;_steps=void 0;steps=new te;_icons;animationDone=new j;disableRipple;color;labelPosition="end";headerPosition="top";_iconOverrides={};get animationDuration(){return this._animationDuration}set animationDuration(e){this._animationDuration=/^\d+$/.test(e)?e+"ms":e}_animationDuration="";_isServer=!f(ut).isBrowser;constructor(){super();let t=f(U).nativeElement.nodeName.toLowerCase();this.orientation=t==="mat-vertical-stepper"?"vertical":"horizontal"}ngAfterContentInit(){super.ngAfterContentInit(),this._icons.forEach(({name:e,templateRef:t})=>this._iconOverrides[e]=t),this.steps.changes.pipe(C(this._destroyed)).subscribe(()=>this._stateChanged()),this.selectedIndexChange.pipe(C(this._destroyed)).subscribe(()=>{let e=this._getAnimationDuration();e==="0ms"||e==="0s"?this._onAnimationDone():this._isAnimating.set(!0)}),this._ngZone.runOutsideAngular(()=>{this._animationsModule!=="NoopAnimations"&&setTimeout(()=>{this._elementRef.nativeElement.classList.add("mat-stepper-animations-enabled"),this._cleanupTransition=this._renderer.listen(this._elementRef.nativeElement,"transitionend",this._handleTransitionend)},200)})}ngAfterViewInit(){if(super.ngAfterViewInit(),typeof queueMicrotask=="function"){let e=!1;this._animatedContainers.changes.pipe(z(null),C(this._destroyed)).subscribe(()=>queueMicrotask(()=>{e||(e=!0,this.animationDone.emit()),this._stateChanged()}))}}ngOnDestroy(){super.ngOnDestroy(),this._cleanupTransition?.()}_stepIsNavigable(e,t){return t.completed||this.selectedIndex===e||!this.linear}_getAnimationDuration(){return this._animationsModule==="NoopAnimations"?"0ms":this.animationDuration?this.animationDuration:this.orientation==="horizontal"?"500ms":"225ms"}_handleTransitionend=e=>{let t=e.target;if(!t)return;let a=this.orientation==="horizontal"&&e.propertyName==="transform"&&t.classList.contains("mat-horizontal-stepper-content-current"),s=this.orientation==="vertical"&&e.propertyName==="grid-template-rows"&&t.classList.contains("mat-vertical-content-container-active");(a||s)&&this._animatedContainers.find(g=>g.nativeElement===t)&&this._onAnimationDone()};_onAnimationDone(){this._isAnimating.set(!1),this.animationDone.emit()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=w({type:i,selectors:[["mat-stepper"],["mat-vertical-stepper"],["mat-horizontal-stepper"],["","matStepper",""]],contentQueries:function(t,a,s){if(t&1&&(O(s,Xi,5),O(s,Wi,5)),t&2){let d;v(d=b())&&(a._steps=d),v(d=b())&&(a._icons=d)}},viewQuery:function(t,a){if(t&1&&(V(Te,5),V(Vi,5)),t&2){let s;v(s=b())&&(a._stepHeader=s),v(s=b())&&(a._animatedContainers=s)}},hostAttrs:["role","tablist"],hostVars:15,hostBindings:function(t,a){t&2&&(F("aria-orientation",a.orientation),He("--mat-stepper-animation-duration",a._getAnimationDuration()),H("mat-stepper-horizontal",a.orientation==="horizontal")("mat-stepper-vertical",a.orientation==="vertical")("mat-stepper-label-position-end",a.orientation==="horizontal"&&a.labelPosition=="end")("mat-stepper-label-position-bottom",a.orientation==="horizontal"&&a.labelPosition=="bottom")("mat-stepper-header-position-bottom",a.headerPosition==="bottom")("mat-stepper-animating",a._isAnimating()))},inputs:{disableRipple:"disableRipple",color:"color",labelPosition:"labelPosition",headerPosition:"headerPosition",animationDuration:"animationDuration"},outputs:{animationDone:"animationDone"},exportAs:["matStepper","matVerticalStepper","matHorizontalStepper"],features:[me([{provide:ge,useExisting:i}]),ie],ngContentSelectors:_i,decls:5,vars:2,consts:[["stepTemplate",""],["animatedContainer",""],[1,"mat-horizontal-stepper-wrapper"],[1,"mat-horizontal-stepper-header-container"],[1,"mat-horizontal-content-container"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id","class"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-stepper-horizontal-line"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id"],[3,"ngTemplateOutlet"],[1,"mat-step"],[1,"mat-vertical-content-container"],["role","tabpanel",1,"mat-vertical-stepper-content",3,"id"],[1,"mat-vertical-content"],[3,"click","keydown","tabIndex","id","index","state","label","selected","active","optional","errorMessage","iconOverrides","disableRipple","color"]],template:function(t,a){if(t&1&&(Y(),m(0,zi,1,0)(1,qi,7,0,"div",2)(2,Gi,2,0)(3,Ki,1,23,"ng-template",null,0,$e)),t&2){let s;I(a._isServer?0:-1),l(),I((s=a.orientation)==="horizontal"?1:s==="vertical"?2:-1)}},dependencies:[Oe,Te],styles:[`.mat-stepper-vertical,.mat-stepper-horizontal{display:block;font-family:var(--mat-stepper-container-text-font, var(--mat-sys-body-medium-font));background:var(--mat-stepper-container-color, var(--mat-sys-surface))}.mat-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header-container{align-items:flex-start}.mat-stepper-header-position-bottom .mat-horizontal-stepper-header-container{order:1}.mat-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px;border-top-color:var(--mat-stepper-line-color, var(--mat-sys-outline))}.mat-stepper-label-position-bottom .mat-stepper-horizontal-line{margin:0;min-width:0;position:relative;top:calc(calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{border-top-width:1px;border-top-style:solid;content:"";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.mat-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px;height:var(--mat-stepper-header-height, 72px)}.mat-horizontal-stepper-header .mat-step-icon{margin-right:8px;flex:none}[dir=rtl] .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:8px}.mat-horizontal-stepper-header::before,.mat-horizontal-stepper-header::after{border-top-color:var(--mat-stepper-line-color, var(--mat-sys-outline))}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{padding:calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) 24px}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::after{top:calc(calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{right:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before{left:0}[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:last-child::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:first-child::after{display:none}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-label{padding:16px 0 0 0;text-align:center;width:100%}.mat-vertical-stepper-header{display:flex;align-items:center;height:24px;padding:calc((var(--mat-stepper-header-height, 72px) - 24px) / 2) 24px}.mat-vertical-stepper-header .mat-step-icon{margin-right:12px}[dir=rtl] .mat-vertical-stepper-header .mat-step-icon{margin-right:0;margin-left:12px}.mat-horizontal-stepper-wrapper{display:flex;flex-direction:column}.mat-horizontal-stepper-content{visibility:hidden;overflow:hidden;outline:0;height:0}.mat-stepper-animations-enabled .mat-horizontal-stepper-content{transition:transform var(--mat-stepper-animation-duration, 0) cubic-bezier(0.35, 0, 0.25, 1)}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-previous{transform:translate3d(-100%, 0, 0)}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-next{transform:translate3d(100%, 0, 0)}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-current{visibility:visible;transform:none;height:auto}.mat-stepper-horizontal:not(.mat-stepper-animating) .mat-horizontal-stepper-content.mat-horizontal-stepper-content-current{overflow:visible}.mat-horizontal-content-container{overflow:hidden;padding:0 24px 24px 24px}@media(forced-colors: active){.mat-horizontal-content-container{outline:solid 1px}}.mat-stepper-header-position-bottom .mat-horizontal-content-container{padding:24px 24px 0 24px}.mat-vertical-content-container{display:grid;grid-template-rows:0fr;grid-template-columns:100%;margin-left:36px;border:0;position:relative}.mat-stepper-animations-enabled .mat-vertical-content-container{transition:grid-template-rows var(--mat-stepper-animation-duration, 0) cubic-bezier(0.4, 0, 0.2, 1)}.mat-vertical-content-container.mat-vertical-content-container-active{grid-template-rows:1fr}.mat-step:last-child .mat-vertical-content-container{border:none}@media(forced-colors: active){.mat-vertical-content-container{outline:solid 1px}}[dir=rtl] .mat-vertical-content-container{margin-left:0;margin-right:36px}@supports not (grid-template-rows: 0fr){.mat-vertical-content-container{height:0}.mat-vertical-content-container.mat-vertical-content-container-active{height:auto}}.mat-stepper-vertical-line::before{content:"";position:absolute;left:0;border-left-width:1px;border-left-style:solid;border-left-color:var(--mat-stepper-line-color, var(--mat-sys-outline));top:calc(8px - calc((var(--mat-stepper-header-height, 72px) - 24px) / 2));bottom:calc(8px - calc((var(--mat-stepper-header-height, 72px) - 24px) / 2))}[dir=rtl] .mat-stepper-vertical-line::before{left:auto;right:0}.mat-vertical-stepper-content{overflow:hidden;outline:0;visibility:hidden}.mat-stepper-animations-enabled .mat-vertical-stepper-content{transition:visibility var(--mat-stepper-animation-duration, 0) linear}.mat-vertical-content-container-active>.mat-vertical-stepper-content{visibility:visible}.mat-vertical-content{padding:0 24px 24px 24px}
`],encapsulation:2,changeDetection:0})}return i})();var vi=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=W({type:i});static \u0275inj=Q({providers:[Ui,ue],imports:[J,Gt,fi,fe,Vt,Zi,Te,J]})}return i})();var Ji=new se("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let i=f(Ee);return()=>i.scrollStrategies.reposition()}});function ea(i){return()=>i.scrollStrategies.reposition()}var ta={provide:Ji,deps:[Ee],useFactory:ea};var bi=(()=>{class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=W({type:i});static \u0275inj=Q({providers:[ta],imports:[Qt,Ie,J,Kt,Ie,J]})}return i})();var u=yi(xi());var ia=["mapContainer"];function aa(i,c){i&1&&(o(0,"mat-error"),r(1," El nombre es requerido "),n())}function na(i,c){i&1&&(o(0,"mat-error"),r(1," El nombre debe tener al menos 3 caracteres "),n())}function oa(i,c){i&1&&(o(0,"mat-error"),r(1," La descripci\xF3n es requerida "),n())}function ra(i,c){i&1&&(o(0,"mat-error"),r(1," La descripci\xF3n debe tener al menos 10 caracteres "),n())}function sa(i,c){if(i&1&&(o(0,"mat-option",58),r(1),n()),i&2){let e=c.$implicit;p("value",e.value),l(),T(" ",e.label," ")}}function la(i,c){i&1&&(o(0,"mat-error"),r(1," Seleccione un tipo de actividad "),n())}function ca(i,c){if(i&1&&(o(0,"mat-option",58),r(1),n()),i&2){let e=c.$implicit;p("value",e.value),l(),T(" ",e.label," ")}}function da(i,c){i&1&&(o(0,"mat-error"),r(1," Seleccione una prioridad "),n())}function pa(i,c){if(i&1&&(o(0,"mat-option",58),r(1),n()),i&2){let e=c.$implicit;p("value",e.value),l(),T(" ",e.label," ")}}function ma(i,c){i&1&&(o(0,"mat-error"),r(1," Seleccione un frente de trabajo "),n())}function ua(i,c){if(i&1&&(o(0,"mat-option",58),r(1),n()),i&2){let e=c.$implicit;p("value",e.value),l(),T(" ",e.label," ")}}function ha(i,c){i&1&&(o(0,"mat-error"),r(1," Seleccione un responsable "),n())}function fa(i,c){i&1&&(o(0,"mat-error"),r(1," Seleccione el punto inicial en el mapa "),n())}function _a(i,c){i&1&&(o(0,"mat-error"),r(1," Seleccione el punto final en el mapa "),n())}function ga(i,c){if(i&1&&(o(0,"div",59)(1,"mat-icon"),r(2,"straighten"),n(),o(3,"span"),r(4),n()()),i&2){let e=_();l(4),T("Distancia total: ",e.totalDistance.toFixed(3)," km")}}function va(i,c){i&1&&(o(0,"mat-error"),r(1," La fecha de inicio es requerida "),n())}function ba(i,c){i&1&&(o(0,"mat-error"),r(1," La fecha fin estimada es requerida "),n())}function ya(i,c){i&1&&(o(0,"div",60)(1,"mat-icon"),r(2,"error"),n(),r(3," La fecha de inicio debe ser anterior a la fecha de fin "),n())}function xa(i,c){i&1&&(o(0,"mat-error"),r(1," El nombre de la tarea es requerido "),n())}function Ca(i,c){i&1&&(o(0,"mat-error"),r(1," El nombre debe tener al menos 3 caracteres "),n())}function Sa(i,c){if(i&1){let e=ae();o(0,"div",63)(1,"div",64)(2,"div",65)(3,"span",66),r(4),n()(),o(5,"div",67)(6,"mat-form-field",68)(7,"mat-label"),r(8,"Nombre de la tarea"),n(),y(9,"input",69),m(10,xa,2,0,"mat-error",13)(11,Ca,2,0,"mat-error",13),n(),o(12,"mat-form-field",70)(13,"mat-label"),r(14,"Descripci\xF3n (opcional)"),n(),o(15,"textarea",71),r(16,"                    "),n()()(),o(17,"div",72)(18,"button",73),S("click",function(){let a=k(e).index,s=_(2);return M(s.eliminarTarea(a))}),o(19,"mat-icon"),r(20,"delete"),n()()()()()}if(i&2){let e,t,a=c.$implicit,s=c.index;p("formGroupName",s),F("data-index",s),l(4),A(s+1),l(6),p("ngIf",(e=a.get("nombre"))==null?null:e.hasError("required")),l(),p("ngIf",(t=a.get("nombre"))==null?null:t.hasError("minlength"))}}function ka(i,c){if(i&1&&(o(0,"div",61),m(1,Sa,21,5,"div",62),n()),i&2){let e=_();l(),p("ngForOf",e.tareasFormArray.controls)}}function Ma(i,c){i&1&&(o(0,"div",74)(1,"mat-icon"),r(2,"assignment"),n(),o(3,"p"),r(4,"No hay tareas agregadas"),n(),o(5,"p",75),r(6,"Las tareas ayudan a dividir la actividad en pasos espec\xEDficos y permiten un mejor seguimiento del progreso."),n()())}function Oa(i,c){if(i&1&&(o(0,"div",76)(1,"div",77)(2,"mat-icon"),r(3,"assignment"),n(),o(4,"span"),r(5),n()()()),i&2){let e=_();l(5),T("Total de tareas: ",e.tareasFormArray.length,"")}}function Ea(i,c){i&1&&y(0,"mat-spinner",78)}function Ia(i,c){i&1&&(o(0,"mat-icon"),r(1,"save"),n())}var Lo=(()=>{class i{constructor(e,t,a,s,d,g,L){this.fb=e,this.actividadesService=t,this.authService=a,this.router=s,this.snackBar=d,this.mapService=g,this.dialog=L,this.destroy$=new K,this.loading=!1,this.currentLatitude=0,this.currentLongitude=0,this.selectedFrente=null,this.progressoInicial=0,this.mapInitialized=!1,this.totalDistance=0,this.isSelectingStartPoint=!0,this.isSelectingLocation=!1,this.tiposActividad=[{value:"excavacion",label:"Excavaci\xF3n"},{value:"pavimentacion",label:"Pavimentaci\xF3n"},{value:"se\xF1alizacion",label:"Se\xF1alizaci\xF3n"},{value:"drenaje",label:"Drenaje"},{value:"puentes",label:"Puentes y Estructuras"},{value:"mantenimiento",label:"Mantenimiento"},{value:"control_calidad",label:"Control de Calidad"},{value:"seguridad",label:"Seguridad Vial"}],this.prioridades=[{value:"baja",label:"Baja"},{value:"media",label:"Media"},{value:"alta",label:"Alta"},{value:"critica",label:"Cr\xEDtica"}],this.responsables=[{value:"supervisor1",label:"Juan P\xE9rez - Supervisor"},{value:"ingeniero1",label:"Mar\xEDa Garc\xEDa - Ingeniero"},{value:"capataz1",label:"Carlos L\xF3pez - Capataz"},{value:"tecnico1",label:"Ana Mart\xEDnez - T\xE9cnico"}],this.frentes=[],this.obras=[],this.mapPointsValidator=()=>!this.startPoint||!this.endPoint?{mapPointsRequired:"Debe seleccionar tanto el punto inicial como el final en el mapa"}:this.totalDistance<=0?{invalidDistance:"La distancia entre los puntos debe ser mayor a 0"}:null,this.kilometrajeRangeValidator=x=>{let E=x.get("kilometraje_inicio")?.value,G=x.get("kilometraje_fin")?.value;if(!E||!G)return null;let R={};E>=G&&(R.rangeInvalid="El kilometraje inicial debe ser menor al final"),G-E<.1&&(R.rangeMinimum="El rango m\xEDnimo debe ser de 0.1 km");let oe=0,re=100;return E<oe&&(R.inicioOutOfRange=`El kilometraje inicial debe ser mayor a ${oe}`),G>re&&(R.finOutOfRange=`El kilometraje final debe ser menor a ${re}`),Object.keys(R).length>0?R:null},this.actividadForm=this.createForm()}ngOnInit(){console.log("\u{1F680} [NuevaActividad] Componente inicializado");let e=this.authService.getCurrentUser();console.log("\u{1F464} [NuevaActividad] Usuario actual:",e),e||console.warn("\u26A0\uFE0F [NuevaActividad] No hay usuario autenticado"),this.loadObrasAndFrente()}loadObrasAndFrente(){return ee(this,null,function*(){try{console.log("\u{1F504} [NuevaActividad] Iniciando carga de frentes..."),yield this.actividadesService.reloadUserFrente(),this.actividadesService.frentes$.pipe(C(this.destroy$)).subscribe(e=>{console.log("\u{1F4CB} [NuevaActividad] Frentes recibidos:",e),console.log("\u{1F4CA} [NuevaActividad] Cantidad de frentes:",e.length),this.frentes=e.map(t=>({value:t.id,label:t.nombre})),console.log("\u2705 [NuevaActividad] Frentes mapeados para dropdown:",this.frentes)})}catch(e){console.error("\u274C [NuevaActividad] Error loading data:",e)}})}getFrenteById(e){return ee(this,null,function*(){return new Promise(t=>{this.actividadesService.frentes$.pipe(C(this.destroy$)).subscribe(a=>{let s=a.find(d=>d.id===e);t(s)})})})}ngAfterViewInit(){setTimeout(()=>{this.initializeMap()},100)}ngOnDestroy(){this.map&&this.map.remove(),this.destroy$.next(),this.destroy$.complete()}initializeMap(){if(!this.mapInitialized)try{let e=document.getElementById("nueva-actividad-map");if(!e){console.error("\u274C [NuevaActividad] Elemento del mapa no encontrado");return}let d=u.icon({iconRetinaUrl:"assets/marker-icon-2x.png",iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]});u.Marker.prototype.options.icon=d,this.map=u.map(e).setView([-16.5,-68.15],10),u.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors"}).addTo(this.map),this.map.on("click",g=>{this.onMapClick(g.latlng.lat,g.latlng.lng)}),this.mapInitialized=!0,console.log("\u2705 [NuevaActividad] Mapa inicializado correctamente")}catch(e){console.error("\u274C [NuevaActividad] Error al inicializar mapa:",e)}}onMapClick(e,t){this.isSelectingStartPoint?(this.startPoint=u.latLng(e,t),this.addStartMarker(this.startPoint),this.isSelectingStartPoint=!1,this.snackBar.open("Punto inicial seleccionado. Ahora seleccione el punto final.","Cerrar",{duration:3e3,panelClass:["success-snackbar"]})):(this.endPoint=u.latLng(e,t),this.addEndMarker(this.endPoint),this.calculateAndDisplayRoute(),this.snackBar.open("Punto final seleccionado. Distancia calculada autom\xE1ticamente.","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),this.isSelectingStartPoint=!0)}updateLocation(e,t){this.currentLatitude=e,this.currentLongitude=t,this.actividadForm.patchValue({ubicacion_lat:e,ubicacion_lng:t}),this.currentMarker&&this.map.removeLayer(this.currentMarker),this.currentMarker=u.marker([e,t]).addTo(this.map).bindPopup(`Ubicaci\xF3n seleccionada<br>Lat: ${e.toFixed(6)}<br>Lng: ${t.toFixed(6)}`),console.log("\u{1F4CD} [NuevaActividad] Ubicaci\xF3n actualizada:",{lat:e,lng:t})}addStartMarker(e){if(this.map){this.startMarker&&this.map.removeLayer(this.startMarker);let t=u.divIcon({className:"start-point-marker",html:'<div style="background-color: #4CAF50; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">I</div>',iconSize:[30,30],iconAnchor:[15,15]});this.startMarker=u.marker(e,{icon:t}).addTo(this.map).bindPopup("Punto Inicial")}}addEndMarker(e){if(this.map){this.endMarker&&this.map.removeLayer(this.endMarker);let t=u.divIcon({className:"end-point-marker",html:'<div style="background-color: #F44336; color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">F</div>',iconSize:[30,30],iconAnchor:[15,15]});this.endMarker=u.marker(e,{icon:t}).addTo(this.map).bindPopup("Punto Final")}}calculateAndDisplayRoute(){if(this.startPoint&&this.endPoint&&this.map){this.totalDistance=this.startPoint.distanceTo(this.endPoint)/1e3,console.log("\u{1F4CF} [CalculateRoute] Distancia calculada:",this.totalDistance,"km"),this.routeLine&&this.map.removeLayer(this.routeLine),this.routeLine=u.polyline([this.startPoint,this.endPoint],{color:"#2196F3",weight:4,opacity:.8,dashArray:"10, 5"}).addTo(this.map).bindPopup(`Distancia: ${this.totalDistance.toFixed(3)} km`);let e=0,t=Number(this.totalDistance.toFixed(3));console.log("\u{1F4DD} [CalculateRoute] Actualizando formulario - kmInicio:",e,"kmFin:",t),this.actividadForm.patchValue({kilometraje_inicio:e,kilometraje_fin:t}),this.actividadForm.get("kilometraje_inicio")?.updateValueAndValidity(),this.actividadForm.get("kilometraje_fin")?.updateValueAndValidity(),console.log("\u2705 [CalculateRoute] Formulario actualizado. Estado v\xE1lido:",this.actividadForm.valid);let a=u.latLngBounds([this.startPoint,this.endPoint]);this.map.fitBounds(a,{padding:[20,20]})}}clearMapPoints(){this.map&&(this.startMarker&&(this.map.removeLayer(this.startMarker),this.startMarker=void 0),this.endMarker&&(this.map.removeLayer(this.endMarker),this.endMarker=void 0),this.routeLine&&(this.map.removeLayer(this.routeLine),this.routeLine=void 0),this.startPoint=void 0,this.endPoint=void 0,this.totalDistance=0,this.isSelectingStartPoint=!0,this.actividadForm.patchValue({kilometraje_inicio:null,kilometraje_fin:null}),this.actividadForm.get("kilometraje_inicio")?.updateValueAndValidity(),this.actividadForm.get("kilometraje_fin")?.updateValueAndValidity(),console.log("\u{1F9F9} [ClearMapPoints] Campos limpiados. Estado del formulario:",this.actividadForm.valid),this.snackBar.open("Puntos del mapa limpiados. Seleccione nuevamente el punto inicial.","Cerrar",{duration:3e3,panelClass:["info-snackbar"]}))}onCoordinatesChange(){let e=this.actividadForm.get("ubicacion_lat")?.value,t=this.actividadForm.get("ubicacion_lng")?.value;e&&t&&this.isValidCoordinates(e,t)&&(this.updateLocation(e,t),this.map&&this.map.setView([e,t],15))}isValidCoordinates(e,t){return e>=-90&&e<=90&&t>=-180&&t<=180}createForm(){return this.fb.group({nombre:["",[h.required,h.minLength(3)]],descripcion:["",[h.required,h.minLength(10)]],tipo:["",h.required],frente_trabajo:["",h.required],responsable:["",h.required],fecha_inicio:["",[h.required,this.dateValidator]],fecha_fin_estimada:["",[h.required,this.dateValidator]],kilometro:[0,[h.required,h.min(0)]],progreso_porcentaje:[0,[h.min(0),h.max(100)]],progreso_general:[0,[h.min(0),h.max(100)]],progreso_inicial:[0,[h.min(0),h.max(100)]],ubicacion_lat:[null],ubicacion_lng:[null],kilometraje_inicio:[null,[h.required,h.min(0)]],kilometraje_fin:[null,[h.required,h.min(0)]],estado:["planificada",h.required],prioridad:["media",h.required],observaciones:[""],recursos_necesarios:[""],costo_estimado:[0,[h.min(0)]],tareas:this.fb.array([])},{validators:[this.dateRangeValidator,this.kilometrajeValidator]})}dateValidator(e){if(!e.value)return null;let t=new Date(e.value),a=new Date;return a.setHours(0,0,0,0),t<a?{pastDate:!0}:null}dateRangeValidator(e){let t=e.get("fecha_inicio")?.value,a=e.get("fecha_fin_estimada")?.value;return t&&a&&new Date(t)>=new Date(a)?{dateRange:!0}:null}kilometrajeValidator(e){let t=e.get("kilometraje_inicio")?.value,a=e.get("kilometraje_fin")?.value;if(t!=null&&a!==null&&a!==void 0){let s=Number(t),d=Number(a);if(isNaN(s)||isNaN(d))return{kilometraje:"Los valores de kilometraje deben ser n\xFAmeros v\xE1lidos"};if(s>d)return{kilometraje:"El kilometraje inicial debe ser menor o igual al final"};if(s<0||d<0)return{kilometraje:"Los valores de kilometraje no pueden ser negativos"}}return null}selectLocationOnMap(){this.snackBar.open("Seleccione directamente en el mapa el punto inicial y final de la actividad","Cerrar",{duration:4e3,panelClass:["info-snackbar"]})}onSelectLocationOnMap(){this.selectLocationOnMap()}getCurrentLocation(){if(!navigator.geolocation){this.handleGeolocationUnavailable();return}this.checkGeolocationPermission().then(e=>{if(!e){this.handlePermissionDenied();return}this.loading=!0,this.snackBar.open("Obteniendo ubicaci\xF3n GPS...","Cerrar",{duration:2e3}),navigator.geolocation.getCurrentPosition(t=>{this.handleGeolocationSuccess(t)},t=>{this.handleGeolocationError(t)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:3e5})}).catch(e=>{console.error("Error checking geolocation permission:",e),this.handleGeolocationUnavailable()})}checkGeolocationPermission(){return ee(this,null,function*(){if(!("permissions"in navigator))return!0;try{let e=yield navigator.permissions.query({name:"geolocation"});return e.state==="granted"||e.state==="prompt"}catch{return!0}})}handleGeolocationSuccess(e){let t=Number(e.coords.latitude.toFixed(6)),a=Number(e.coords.longitude.toFixed(6));this.updateLocation(t,a),this.map&&this.map.setView([t,a],15),this.loading=!1,this.snackBar.open("Ubicaci\xF3n GPS obtenida correctamente","Cerrar",{duration:3e3,panelClass:["success-snackbar"]})}handleGeolocationError(e){this.loading=!1,console.error("Error obteniendo GPS:",e);let t="Error al obtener ubicaci\xF3n GPS",a="";switch(e.code){case e.PERMISSION_DENIED:t="Permisos de ubicaci\xF3n denegados",a="Puede seleccionar la ubicaci\xF3n manualmente en el mapa";break;case e.POSITION_UNAVAILABLE:t="Ubicaci\xF3n no disponible",a="Verifique su conexi\xF3n y active el GPS";break;case e.TIMEOUT:t="Tiempo de espera agotado para obtener ubicaci\xF3n",a="Intente nuevamente o seleccione manualmente";break;default:t="Error desconocido al obtener ubicaci\xF3n",a="Use la selecci\xF3n manual en el mapa";break}this.snackBar.open(t,"Cerrar",{duration:4e3,panelClass:["error-snackbar"]}),setTimeout(()=>{this.snackBar.open(a,"Cerrar",{duration:5e3,panelClass:["info-snackbar"]})},4500),this.applyDefaultLocationIfNeeded()}handleGeolocationUnavailable(){this.snackBar.open("GPS no disponible en este dispositivo","Cerrar",{duration:4e3,panelClass:["warning-snackbar"]}),setTimeout(()=>{this.snackBar.open('Use el bot\xF3n "Seleccionar en Mapa" para elegir ubicaci\xF3n',"Cerrar",{duration:5e3,panelClass:["info-snackbar"]})},4500),this.applyDefaultLocationIfNeeded()}handlePermissionDenied(){this.snackBar.open("Permisos de ubicaci\xF3n requeridos","Cerrar",{duration:4e3,panelClass:["warning-snackbar"]}),setTimeout(()=>{this.snackBar.open("Active los permisos en configuraci\xF3n o seleccione manualmente","Cerrar",{duration:6e3,panelClass:["info-snackbar"]})},4500),this.applyDefaultLocationIfNeeded()}applyDefaultLocationIfNeeded(){let e=this.actividadForm.get("ubicacion_lat")?.value,t=this.actividadForm.get("ubicacion_lng")?.value;(!e||!t||e===0&&t===0)&&(this.updateLocation(-12.0464,-77.0428),this.map&&this.map.setView([-12.0464,-77.0428],12),setTimeout(()=>{this.snackBar.open("Ubicaci\xF3n establecida por defecto - Puede cambiarla manualmente","Cerrar",{duration:4e3,panelClass:["info-snackbar"]})},1e3))}onUseCurrentGPS(){this.getCurrentLocation()}onProgressChange(e){this.progressoInicial=e,this.actividadForm.patchValue({progreso_inicial:e})}updateKilometrageRange(){let e=this.actividadForm.get("kilometraje_inicio")?.value,t=this.actividadForm.get("kilometraje_fin")?.value,a=this.actividadForm.get("frente_trabajo")?.value;if(e&&t&&a&&this.map){this.rangeLayer&&this.map.removeLayer(this.rangeLayer),this.rangeLayer=u.layerGroup();let s=this.currentLatitude||-12.0464,d=this.currentLongitude||-77.0428,g=.001,L=.001,x=[s+e*g,d+e*L],E=[s+t*g,d+t*L],G=u.polyline([x,E],{color:"#2196F3",weight:4,opacity:.8,dashArray:"10, 5"}).bindPopup(`Rango: Km ${e} - Km ${t}`),R=u.marker(x,{icon:u.divIcon({className:"km-marker start-marker",html:`<div class="km-marker-content">Km ${e}</div>`,iconSize:[60,30],iconAnchor:[30,15]})}).bindPopup(`Kilometraje Inicio: ${e}`),oe=u.marker(E,{icon:u.divIcon({className:"km-marker end-marker",html:`<div class="km-marker-content">Km ${t}</div>`,iconSize:[60,30],iconAnchor:[30,15]})}).bindPopup(`Kilometraje Fin: ${t}`);this.rangeLayer.addLayer(G),this.rangeLayer.addLayer(R),this.rangeLayer.addLayer(oe),this.rangeLayer.addTo(this.map);let re=u.latLngBounds([x,E]);this.map.fitBounds(re,{padding:[20,20]})}}validateKilometrageRange(){let e=this.actividadForm.get("kilometraje_inicio")?.value,t=this.actividadForm.get("kilometraje_fin")?.value;if(console.log("\u{1F50D} [ValidateKilometrageRange] kmInicio:",e,"kmFin:",t),e==null||t===null||t===void 0)return console.log("\u26A0\uFE0F [ValidateKilometrageRange] Valores null/undefined detectados"),!1;let a=Number(e),s=Number(t);return console.log("\u{1F522} [ValidateKilometrageRange] Convertidos - kmInicioNum:",a,"kmFinNum:",s),isNaN(a)||isNaN(s)?(console.log("\u274C [ValidateKilometrageRange] Valores no son n\xFAmeros v\xE1lidos"),!1):a>s?(console.log("\u274C [ValidateKilometrageRange] Inicio mayor que fin"),!1):a<0||s<0?(console.log("\u274C [ValidateKilometrageRange] Valores negativos detectados"),!1):this.selectedFrente&&(a<0||s>100)?(console.log("\u274C [ValidateKilometrageRange] Fuera del rango del frente"),!1):(console.log("\u2705 [ValidateKilometrageRange] Validaci\xF3n exitosa"),!0)}onFrenteChange(e){this.actividadesService.frentes$.pipe(C(this.destroy$)).subscribe(t=>{this.selectedFrente=t.find(a=>a.id===e),this.selectedFrente&&(console.log("\u{1F3AF} [NuevaActividad] Frente seleccionado:",this.selectedFrente),this.updateKilometrageRange())})}onSubmit(){return ee(this,null,function*(){if(console.log("\u{1F680} [OnSubmit] Iniciando proceso de creaci\xF3n de actividad"),console.log("\u{1F4CB} [OnSubmit] Estado del formulario - v\xE1lido:",this.actividadForm.valid),console.log("\u{1F4CB} [OnSubmit] Errores del formulario:",this.actividadForm.errors),console.log("\u{1F4CB} [OnSubmit] Valores del formulario:",this.actividadForm.value),this.actividadForm.valid){this.loading=!0;let e=this.actividadForm.value;try{let t=yield this.getFrenteById(e.frente_trabajo);if(!t)throw new Error("Frente no encontrado");let a=yield this.authService.getCurrentUser();if(!a)throw new Error("Usuario no autenticado");if(console.log("\u{1F50D} [OnSubmit] Validando rango de kilometraje..."),!this.validateKilometrageRange())throw new Error("El rango de kilometraje no es v\xE1lido");if(console.log("\u2705 [OnSubmit] Rango de kilometraje v\xE1lido"),!this.startPoint||!this.endPoint)throw new Error("Debe seleccionar tanto el punto inicial como el punto final en el mapa");console.log("\u2705 [OnSubmit] Puntos del mapa v\xE1lidos");let s={obra_id:t.obra_id,frente_id:e.frente_trabajo,user_id:a.id,tipo_actividad:e.tipo,fecha:e.fecha_inicio,ubicacion:{lat:this.startPoint.lat,lng:this.startPoint.lng,direccion:`Punto inicial: ${this.startPoint.lat}, ${this.startPoint.lng} - Punto final: ${this.endPoint.lat}, ${this.endPoint.lng}`},ubicacion_inicio:{lat:this.startPoint.lat,lng:this.startPoint.lng,direccion:"Punto inicial seleccionado en mapa"},ubicacion_fin:{lat:this.endPoint.lat,lng:this.endPoint.lng,direccion:"Punto final seleccionado en mapa"},responsable:e.responsable,estado:"programado",observaciones:e.observaciones||null,kilometraje_inicio:e.kilometraje_inicio,kilometraje_fin:e.kilometraje_fin,distancia_total:this.totalDistance,progreso_inicial:e.progreso_inicial||e.progreso_general||0},d=yield this.actividadesService.createActividad(s);if(this.tareasFormArray.length>0&&d?.id){console.log("\u{1F4DD} [OnSubmit] Creando tareas para la actividad:",d.id);try{for(let g=0;g<this.tareasFormArray.length;g++){let x=this.tareasFormArray.at(g).value;if(x.nombre&&x.nombre.trim()){let E={actividad_id:d.id,nombre:x.nombre.trim(),descripcion:x.descripcion?.trim()||null,completada:x.completada||!1,orden:x.orden||g+1,fecha_creacion:new Date().toISOString()};yield this.actividadesService.createTarea(E)}}console.log("\u2705 [OnSubmit] Todas las tareas creadas exitosamente")}catch(g){console.error("\u274C [OnSubmit] Error al crear tareas:",g),this.snackBar.open("Actividad creada, pero hubo un error al crear algunas tareas","Cerrar",{duration:5e3,panelClass:["warning-snackbar"]})}}this.loading=!1,this.snackBar.open("Actividad creada exitosamente","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),this.router.navigate(["/actividades"])}catch(t){this.loading=!1,console.error("Error al crear actividad:",t),this.snackBar.open("Error al crear la actividad: "+(t.message||"Error desconocido"),"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}}else this.markFormGroupTouched(),this.snackBar.open("Por favor, complete todos los campos requeridos","Cerrar",{duration:3e3,panelClass:["warning-snackbar"]})})}markFormGroupTouched(){Object.keys(this.actividadForm.controls).forEach(e=>{this.actividadForm.get(e)?.markAsTouched()})}onCancel(){this.router.navigate(["/actividades"])}get nombre(){return this.actividadForm.get("nombre")}get descripcion(){return this.actividadForm.get("descripcion")}get tipo(){return this.actividadForm.get("tipo")}get prioridad(){return this.actividadForm.get("prioridad")}get frente_trabajo(){return this.actividadForm.get("frente_trabajo")}get responsable(){return this.actividadForm.get("responsable")}get fecha_inicio(){return this.actividadForm.get("fecha_inicio")}get fecha_fin_estimada(){return this.actividadForm.get("fecha_fin_estimada")}get kilometraje_inicio(){return this.actividadForm.get("kilometraje_inicio")}get kilometraje_fin(){return this.actividadForm.get("kilometraje_fin")}get progreso_inicial(){return this.actividadForm.get("progreso_inicial")}get progreso_general(){return this.actividadForm.get("progreso_general")}get tareasFormArray(){return this.actividadForm.get("tareas")}get progressText(){return`${this.progressoInicial}% completado`}get coordinatesText(){return this.currentLatitude===0&&this.currentLongitude===0?"No seleccionada":`${this.currentLatitude.toFixed(6)}, ${this.currentLongitude.toFixed(6)}`}agregarTarea(){let e=this.fb.group({nombre:["",[h.required,h.minLength(3)]],descripcion:[""],orden:[this.tareasFormArray.length+1],completada:[!1]});this.tareasFormArray.push(e),console.log("\u2705 [AgregarTarea] Nueva tarea agregada. Total:",this.tareasFormArray.length)}eliminarTarea(e){if(e>=0&&e<this.tareasFormArray.length){this.tareasFormArray.removeAt(e);for(let t=0;t<this.tareasFormArray.length;t++)this.tareasFormArray.at(t).get("orden")?.setValue(t+1);console.log("\u{1F5D1}\uFE0F [EliminarTarea] Tarea eliminada. Total:",this.tareasFormArray.length)}}static{this.\u0275fac=function(t){return new(t||i)(N(ct),N(ei),N(Yt),N(We),N(Ut),N(hi),N(ti))}}static{this.\u0275cmp=w({type:i,selectors:[["app-nueva-actividad"]],viewQuery:function(t,a){if(t&1&&V(ia,5),t&2){let s;v(s=b())&&(a.mapContainer=s.first)}},decls:197,vars:34,consts:[["fechaInicioPicker",""],["fechaFinPicker",""],[1,"nueva-actividad-container"],[1,"header-section"],[1,"title-section"],[1,"subtitle"],[1,"actions-section"],["mat-stroked-button","",3,"click","disabled"],[3,"ngSubmit","formGroup"],[1,"form-card"],[1,"form-row"],["appearance","outline",1,"full-width"],["matInput","","formControlName","nombre","placeholder","Ej: Pavimentaci\xF3n Tramo A"],[4,"ngIf"],["matInput","","formControlName","descripcion","rows","3","placeholder","Describe los detalles de la actividad..."],["appearance","outline",1,"half-width"],["formControlName","tipo"],[3,"value",4,"ngFor","ngForOf"],["formControlName","prioridad"],["formControlName","frente_trabajo"],["formControlName","responsable"],[1,"map-section"],[1,"map-container"],["id","nueva-actividad-map",1,"map"],[1,"map-controls"],[1,"map-instructions"],[1,"location-actions"],["mat-raised-button","","color","primary","type","button",3,"click"],["mat-stroked-button","","type","button",3,"click"],[1,"kilometraje-section"],["matInput","","type","number","formControlName","kilometraje_inicio","placeholder","0.000","step","0.001","readonly",""],["matInput","","type","number","formControlName","kilometraje_fin","placeholder","0.000","step","0.001","readonly",""],["class","distance-display",4,"ngIf"],[1,"progress-section"],["matInput","","type","number","formControlName","progreso_general","min","0","max","100","step","1"],[1,"progress-display","half-width"],["mode","determinate",3,"value"],[1,"progress-text"],["matInput","","formControlName","fecha_inicio",3,"matDatepicker"],["matIconSuffix","",3,"for"],["matInput","","formControlName","fecha_fin_estimada",3,"matDatepicker"],["class","form-error",4,"ngIf"],["matInput","","formControlName","recursos_necesarios","rows","2","placeholder","Ej: 2 excavadoras, 3 camiones, 10 operarios..."],["matInput","","formControlName","observaciones","rows","2","placeholder","Observaciones adicionales..."],[1,"checkbox-group"],["formControlName","requiere_evidencia"],["formControlName","notificar_inicio"],[1,"tareas-section"],[1,"tareas-header"],[1,"section-description"],["type","button","mat-raised-button","","color","accent",3,"click"],["class","tareas-list","formArrayName","tareas",4,"ngIf"],["class","no-tareas",4,"ngIf"],["class","tareas-summary",4,"ngIf"],[1,"actions-footer"],["type","button","mat-stroked-button","",3,"click","disabled"],["type","submit","mat-raised-button","","color","primary",3,"disabled"],["diameter","20","class","button-spinner",4,"ngIf"],[3,"value"],[1,"distance-display"],[1,"form-error"],["formArrayName","tareas",1,"tareas-list"],["class","tarea-item",3,"formGroupName",4,"ngFor","ngForOf"],[1,"tarea-item",3,"formGroupName"],[1,"tarea-content"],[1,"tarea-order"],[1,"order-number"],[1,"tarea-fields"],["appearance","outline",1,"tarea-nombre"],["matInput","","formControlName","nombre","placeholder","Ej: Excavaci\xF3n inicial"],["appearance","outline",1,"tarea-descripcion"],["matInput","","formControlName","descripcion","rows","2","placeholder","Detalles de la tarea..."],[1,"tarea-actions"],["type","button","mat-icon-button","","color","warn","matTooltip","Eliminar tarea",3,"click"],[1,"no-tareas"],[1,"hint"],[1,"tareas-summary"],[1,"summary-item"],["diameter","20",1,"button-spinner"]],template:function(t,a){if(t&1){let s=ae();o(0,"div",2)(1,"div",3)(2,"div",4)(3,"h1"),r(4,"Nueva Actividad"),n(),o(5,"p",5),r(6,"Crear una nueva actividad de construcci\xF3n"),n()(),o(7,"div",6)(8,"button",7),S("click",function(){return k(s),M(a.onCancel())}),o(9,"mat-icon"),r(10,"arrow_back"),n(),r(11," Volver "),n()()(),o(12,"form",8),S("ngSubmit",function(){return k(s),M(a.onSubmit())}),o(13,"mat-card",9)(14,"mat-card-header")(15,"mat-card-title")(16,"mat-icon"),r(17,"assignment"),n(),r(18," Informaci\xF3n B\xE1sica "),n()(),o(19,"mat-card-content")(20,"div",10)(21,"mat-form-field",11)(22,"mat-label"),r(23,"Nombre de la Actividad"),n(),y(24,"input",12),m(25,aa,2,0,"mat-error",13)(26,na,2,0,"mat-error",13),n()(),o(27,"div",10)(28,"mat-form-field",11)(29,"mat-label"),r(30,"Descripci\xF3n"),n(),o(31,"textarea",14),r(32,"            "),n(),m(33,oa,2,0,"mat-error",13)(34,ra,2,0,"mat-error",13),n()(),o(35,"div",10)(36,"mat-form-field",15)(37,"mat-label"),r(38,"Tipo de Actividad"),n(),o(39,"mat-select",16),m(40,sa,2,2,"mat-option",17),n(),m(41,la,2,0,"mat-error",13),n(),o(42,"mat-form-field",15)(43,"mat-label"),r(44,"Prioridad"),n(),o(45,"mat-select",18),m(46,ca,2,2,"mat-option",17),n(),m(47,da,2,0,"mat-error",13),n()()()(),o(48,"mat-card",9)(49,"mat-card-header")(50,"mat-card-title")(51,"mat-icon"),r(52,"map"),n(),r(53," Ubicaci\xF3n y Kilometraje "),n()(),o(54,"mat-card-content")(55,"div",10)(56,"mat-form-field",15)(57,"mat-label"),r(58,"Frente de Trabajo"),n(),o(59,"mat-select",19),m(60,pa,2,2,"mat-option",17),n(),m(61,ma,2,0,"mat-error",13),n(),o(62,"mat-form-field",15)(63,"mat-label"),r(64,"Responsable"),n(),o(65,"mat-select",20),m(66,ua,2,2,"mat-option",17),n(),m(67,ha,2,0,"mat-error",13),n()(),o(68,"div",21)(69,"div",22),y(70,"div",23),n(),o(71,"div",24)(72,"div",25)(73,"mat-icon"),r(74,"info"),n(),o(75,"span"),r(76,"Haga clic en el mapa para seleccionar el punto inicial y final de la actividad"),n()(),o(77,"div",26)(78,"button",27),S("click",function(){return k(s),M(a.clearMapPoints())}),o(79,"mat-icon"),r(80,"clear"),n(),r(81," Limpiar Puntos "),n(),o(82,"button",28),S("click",function(){return k(s),M(a.getCurrentLocation())}),o(83,"mat-icon"),r(84,"gps_fixed"),n(),r(85," Usar GPS "),n()(),o(86,"div",29)(87,"div",10)(88,"mat-form-field",15)(89,"mat-label"),r(90,"Kilometraje Inicio"),n(),y(91,"input",30),o(92,"mat-hint"),r(93,"Calculado autom\xE1ticamente desde el mapa"),n(),m(94,fa,2,0,"mat-error",13),n(),o(95,"mat-form-field",15)(96,"mat-label"),r(97,"Kilometraje Fin"),n(),y(98,"input",31),o(99,"mat-hint"),r(100,"Calculado autom\xE1ticamente desde el mapa"),n(),m(101,_a,2,0,"mat-error",13),n()(),m(102,ga,5,1,"div",32),n(),o(103,"div",33)(104,"mat-form-field",15)(105,"mat-label"),r(106,"Progreso Inicial (%)"),n(),y(107,"input",34),o(108,"mat-hint"),r(109,"Progreso inicial de la actividad (0-100%)"),n()(),o(110,"div",35)(111,"label"),r(112,"Vista previa del progreso:"),n(),y(113,"mat-progress-bar",36),o(114,"span",37),r(115),n()()()()()()(),o(116,"mat-card",9)(117,"mat-card-header")(118,"mat-card-title")(119,"mat-icon"),r(120,"schedule"),n(),r(121," Programaci\xF3n "),n()(),o(122,"mat-card-content")(123,"div",10)(124,"mat-form-field",15)(125,"mat-label"),r(126,"Fecha de Inicio"),n(),y(127,"input",38)(128,"mat-datepicker-toggle",39)(129,"mat-datepicker",null,0),m(131,va,2,0,"mat-error",13),n(),o(132,"mat-form-field",15)(133,"mat-label"),r(134,"Fecha Fin Estimada"),n(),y(135,"input",40)(136,"mat-datepicker-toggle",39)(137,"mat-datepicker",null,1),m(139,ba,2,0,"mat-error",13),n()(),m(140,ya,4,0,"div",41),n()(),o(141,"mat-card",9)(142,"mat-card-header")(143,"mat-card-title")(144,"mat-icon"),r(145,"description"),n(),r(146," Detalles Adicionales "),n()(),o(147,"mat-card-content")(148,"div",10)(149,"mat-form-field",11)(150,"mat-label"),r(151,"Recursos Necesarios"),n(),o(152,"textarea",42),r(153,"            "),n(),o(154,"mat-hint"),r(155,"Opcional: Especifique los recursos necesarios"),n()()(),o(156,"div",10)(157,"mat-form-field",11)(158,"mat-label"),r(159,"Observaciones"),n(),o(160,"textarea",43),r(161,"            "),n(),o(162,"mat-hint"),r(163,"Opcional: Informaci\xF3n adicional relevante"),n()()(),o(164,"div",10)(165,"div",44)(166,"mat-checkbox",45),r(167," Requiere evidencia fotogr\xE1fica "),n(),o(168,"mat-checkbox",46),r(169," Notificar al iniciar la actividad "),n()()()()(),o(170,"mat-card",9)(171,"mat-card-header")(172,"mat-card-title")(173,"mat-icon"),r(174,"task_alt"),n(),r(175," Tareas de la Actividad "),n()(),o(176,"mat-card-content")(177,"div",47)(178,"div",48)(179,"p",49),r(180," Agregue las tareas espec\xEDficas que componen esta actividad. El progreso se calcular\xE1 autom\xE1ticamente basado en las tareas completadas. "),n(),o(181,"button",50),S("click",function(){return k(s),M(a.agregarTarea())}),o(182,"mat-icon"),r(183,"add"),n(),r(184," Agregar Tarea "),n()(),m(185,ka,2,1,"div",51)(186,Ma,7,0,"div",52)(187,Oa,6,1,"div",53),n()()(),o(188,"div",54)(189,"button",55),S("click",function(){return k(s),M(a.onCancel())}),o(190,"mat-icon"),r(191,"cancel"),n(),r(192," Cancelar "),n(),o(193,"button",56),m(194,Ea,1,0,"mat-spinner",57)(195,Ia,2,0,"mat-icon",13),r(196),n()()()()}if(t&2){let s,d,g=Z(130),L=Z(138);l(8),p("disabled",a.loading),l(4),p("formGroup",a.actividadForm),l(13),p("ngIf",a.nombre==null?null:a.nombre.hasError("required")),l(),p("ngIf",a.nombre==null?null:a.nombre.hasError("minlength")),l(7),p("ngIf",a.descripcion==null?null:a.descripcion.hasError("required")),l(),p("ngIf",a.descripcion==null?null:a.descripcion.hasError("minlength")),l(6),p("ngForOf",a.tiposActividad),l(),p("ngIf",a.tipo==null?null:a.tipo.hasError("required")),l(5),p("ngForOf",a.prioridades),l(),p("ngIf",a.prioridad==null?null:a.prioridad.hasError("required")),l(13),p("ngForOf",a.frentes),l(),p("ngIf",a.frente_trabajo==null?null:a.frente_trabajo.hasError("required")),l(5),p("ngForOf",a.responsables),l(),p("ngIf",a.responsable==null?null:a.responsable.hasError("required")),l(27),p("ngIf",a.kilometraje_inicio==null?null:a.kilometraje_inicio.hasError("required")),l(7),p("ngIf",a.kilometraje_fin==null?null:a.kilometraje_fin.hasError("required")),l(),p("ngIf",a.totalDistance>0),l(11),p("value",((s=a.actividadForm.get("progreso_general"))==null?null:s.value)||0),l(2),T("",((d=a.actividadForm.get("progreso_general"))==null?null:d.value)||0,"%"),l(12),p("matDatepicker",g),l(),p("for",g),l(3),p("ngIf",a.fecha_inicio==null?null:a.fecha_inicio.hasError("required")),l(4),p("matDatepicker",L),l(),p("for",L),l(3),p("ngIf",a.fecha_fin_estimada==null?null:a.fecha_fin_estimada.hasError("required")),l(),p("ngIf",a.actividadForm.hasError("dateRange")),l(45),p("ngIf",a.tareasFormArray.length>0),l(),p("ngIf",a.tareasFormArray.length===0),l(),p("ngIf",a.tareasFormArray.length>0),l(2),p("disabled",a.loading),l(4),p("disabled",a.loading||a.actividadForm.invalid),l(),p("ngIf",a.loading),l(),p("ngIf",!a.loading),l(),T(" ",a.loading?"Guardando...":"Crear Actividad"," ")}},dependencies:[Ue,Ke,Qe,pt,tt,Xe,it,Je,et,lt,st,at,rt,nt,ot,dt,Ye,Ot,Ct,kt,Mt,St,jt,zt,Nt,fe,he,Ft,Pt,Et,At,It,wt,Dt,Tt,oi,ni,ai,pi,li,ci,di,mi,si,ri,Ht,Bt,Wt,Zt,Xt,vi,Jt,bi,ui,ii],styles:[".nueva-actividad-container[_ngcontent-%COMP%]{padding:20px}.header-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.title-section[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:#1976d2}.subtitle[_ngcontent-%COMP%]{margin:4px 0 0;color:#666}.form-card[_ngcontent-%COMP%]{margin-bottom:24px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.full-width[_ngcontent-%COMP%]{width:100%}.half-width[_ngcontent-%COMP%]{flex:1}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.form-error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#f44336;font-size:.875rem;margin-top:8px}.map-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.map-container[_ngcontent-%COMP%]{height:400px;border:2px solid #e0e0e0;border-radius:8px;overflow:hidden}.map[_ngcontent-%COMP%]{width:100%;height:100%}.location-controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.coordinates-display[_ngcontent-%COMP%]{display:flex;gap:16px}.location-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.progress-section[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:end}.progress-display[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.progress-display[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;color:#666;margin-bottom:4px}.progress-text[_ngcontent-%COMP%]{font-size:.875rem;color:#1976d2;font-weight:500;text-align:center;margin-top:4px}.actions-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:24px;padding-top:16px;border-top:1px solid #e0e0e0}.button-spinner[_ngcontent-%COMP%]{margin-right:8px}.km-marker[_ngcontent-%COMP%]{background:transparent;border:none}.km-marker-content[_ngcontent-%COMP%]{background:#2196f3;color:#fff;padding:4px 8px;border-radius:4px;font-size:12px;font-weight:700;text-align:center;box-shadow:0 2px 4px #0003;white-space:nowrap}.start-marker[_ngcontent-%COMP%]   .km-marker-content[_ngcontent-%COMP%]{background:#4caf50}.end-marker[_ngcontent-%COMP%]   .km-marker-content[_ngcontent-%COMP%]{background:#ff5722}@media (max-width: 768px){.nueva-actividad-container[_ngcontent-%COMP%]{padding:12px}.header-section[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:12px}.form-row[_ngcontent-%COMP%], .coordinates-display[_ngcontent-%COMP%]{flex-direction:column}.progress-section[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.location-actions[_ngcontent-%COMP%]{justify-content:stretch}.location-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}.map-container[_ngcontent-%COMP%], .map-section[_ngcontent-%COMP%]{height:300px}.location-controls[_ngcontent-%COMP%]{flex-direction:column}.location-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:4px 0}.progress-display[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.km-marker-content[_ngcontent-%COMP%]{font-size:10px;padding:2px 6px}}.tasks-section[_ngcontent-%COMP%]{margin-top:16px}.tasks-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.tasks-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#1976d2;font-size:1.1rem}.add-task-btn[_ngcontent-%COMP%]{min-width:auto;padding:8px 16px}.task-item[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-start;margin-bottom:16px;padding:16px;border:1px solid #e0e0e0;border-radius:8px;background:#fafafa}.task-fields[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:12px}.task-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.delete-task-btn[_ngcontent-%COMP%]{min-width:auto;padding:8px;color:#f44336}.tasks-summary[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background:#e3f2fd;border-radius:8px;border-left:4px solid #2196f3}.tasks-summary[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#1976d2;font-weight:500}.no-tasks-message[_ngcontent-%COMP%]{text-align:center;color:#666;font-style:italic;padding:20px}@media (max-width: 768px){.task-item[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.task-actions[_ngcontent-%COMP%]{align-self:flex-end}.tasks-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:12px}}"]})}}return i})();export{Lo as NuevaActividadComponent};
