import{a as ot}from"./chunk-OEJNJFL5.js";import{a as ze}from"./chunk-5XK2YORY.js";import{a as Re,b as Be,c as Le,d as Ue,e as He,f as Ge,g as Ye,h as Qe,i as We,j as Je,k as Xe,l as Ze}from"./chunk-WNWKSLW4.js";import{a as et,b as tt,c as it,d as nt}from"./chunk-EPNA6SYW.js";import{b as at}from"./chunk-ZLVJQ2UH.js";import"./chunk-SXXER37Y.js";import"./chunk-MS4AQ6UA.js";import{a as Ae,b as $e}from"./chunk-DMZJ7K26.js";import{c as Ne}from"./chunk-7BCONPA6.js";import"./chunk-CSWWTQFU.js";import{a as Ve,b as je}from"./chunk-MVE6Y23E.js";import{a as qe}from"./chunk-GOBT7UBB.js";import{a as De,b as Fe}from"./chunk-AZ2U4T3U.js";import"./chunk-SGYCFQGT.js";import"./chunk-2GVF4P32.js";import"./chunk-WFXXN3GR.js";import{a as Ke,b as Te}from"./chunk-YC5WDUOT.js";import"./chunk-G7YPFBNB.js";import{a as me,b as pe,c as ue,d as _e,f as fe,h as ge}from"./chunk-SNSQLCH6.js";import{b as Ee,c as Se}from"./chunk-BXKJ5BTH.js";import"./chunk-3RK6DDJD.js";import{A as he,B as be,C as ve,F as Me,G as Pe,b as Z,d as _,g as ee,h as te,l as ie,m as ne,n as ae,q as oe,r as re,s as ce,t as le,v as de,x as se,y as xe,z as Ce}from"./chunk-UJ3DDJ5Q.js";import{h as H,i as G,j as Y,m as Q,n as W,o as J,p as X,sa as Oe,ua as we,va as ye,wa as ke,xa as Ie}from"./chunk-4WMI5X77.js";import{Db as s,Nb as n,Ob as t,Pb as f,Qb as C,Rb as h,Tb as O,Xb as M,Yb as u,db as l,gc as I,hc as a,ib as S,ic as P,jc as x,kc as B,pa as b,pb as R,qa as v,sc as L,uc as w,vb as m,vc as U,wc as K,xc as T}from"./chunk-B6672ACT.js";import"./chunk-X5YLR3NI.js";import{i as E}from"./chunk-ODN5LVDJ.js";var ct=i=>({"general-kpi":i});function lt(i,c){i&1&&(n(0,"div",50)(1,"mat-card",51)(2,"mat-card-content")(3,"div",52)(4,"mat-icon",53),a(5,"warning"),t(),n(6,"span"),a(7,"No est\xE1 autenticado. Debe iniciar sesi\xF3n para crear KPIs."),t()()()()())}function dt(i,c){if(i&1&&(n(0,"mat-option",54),a(1),t()),i&2){let e=c.$implicit;s("value",e.id),l(),x(" ",e.nombre," ")}}function st(i,c){i&1&&(n(0,"mat-error"),a(1," La obra es requerida "),t())}function mt(i,c){if(i&1&&(n(0,"mat-option",54),a(1),t()),i&2){let e=c.$implicit,r=u();s("value",e.id),l(),B(" ",e.tipo_actividad," - ",r.getUbicacionDisplay(e.ubicacion)," ")}}function pt(i,c){i&1&&(n(0,"mat-error"),a(1," La fecha es requerida "),t())}function ut(i,c){i&1&&(n(0,"mat-error"),a(1," El avance f\xEDsico es requerido "),t())}function _t(i,c){i&1&&(n(0,"mat-error"),a(1," Debe estar entre 0 y 100 "),t())}function ft(i,c){i&1&&(n(0,"mat-error"),a(1," La productividad es requerida "),t())}function gt(i,c){i&1&&(n(0,"mat-error"),a(1," Debe ser mayor a 0 "),t())}function xt(i,c){i&1&&(n(0,"mat-error"),a(1," El personal asignado es requerido "),t())}function Ct(i,c){i&1&&(n(0,"mat-error"),a(1," La calidad es requerida "),t())}function ht(i,c){i&1&&(n(0,"mat-error"),a(1," Debe estar entre 0 y 100 "),t())}function bt(i,c){i&1&&(n(0,"mat-error"),a(1," La desviaci\xF3n del cronograma es requerida "),t())}function vt(i,c){i&1&&(n(0,"mat-error"),a(1," El costo ejecutado es requerido "),t())}function Mt(i,c){i&1&&(n(0,"mat-error"),a(1," El costo presupuestado es requerido "),t())}function Pt(i,c){i&1&&(n(0,"mat-icon"),a(1,"save"),t())}function Et(i,c){i&1&&f(0,"mat-spinner",55)}function St(i,c){i&1&&(n(0,"span"),a(1,"Guardando..."),t())}function Ot(i,c){if(i&1&&(n(0,"span"),a(1),t()),i&2){let e=u();l(),P(e.editingKpi?"Actualizar KPI":"Crear KPI")}}function wt(i,c){if(i&1){let e=O();n(0,"button",56),M("click",function(){b(e);let o=u();return v(o.resetForm())}),n(1,"mat-icon"),a(2,"cancel"),t(),a(3," Cancelar "),t()}if(i&2){let e=u();s("disabled",e.loading)}}function yt(i,c){if(i&1){let e=O();n(0,"div",57)(1,"mat-form-field",58)(2,"mat-label"),a(3,"Buscar KPIs"),t(),n(4,"input",59),M("keyup",function(o){b(e);let d=u();return v(d.applyFilter(o))}),t(),n(5,"mat-icon",60),a(6,"search"),t()(),n(7,"mat-form-field",61)(8,"mat-label"),a(9,"Filtrar por Estado"),t(),n(10,"mat-select",62),M("selectionChange",function(o){b(e);let d=u();return v(d.filterByStatus(o.value))}),n(11,"mat-option",16),a(12,"Todos"),t(),n(13,"mat-option",20),a(14,"Activo"),t(),n(15,"mat-option",21),a(16,"En Revisi\xF3n"),t(),n(17,"mat-option",22),a(18,"Aprobado"),t()()()()}}function kt(i,c){i&1&&(n(0,"th",83),a(1,"Obra"),t())}function It(i,c){if(i&1&&(n(0,"td",84),a(1),t()),i&2){let e=c.$implicit,r=u(3);l(),P(r.getObraNombre(e.obra_id))}}function Kt(i,c){i&1&&(n(0,"th",83),a(1,"Actividad"),t())}function Tt(i,c){if(i&1&&(n(0,"td",84)(1,"span",85)(2,"mat-icon"),a(3),t(),a(4),t()()),i&2){let e=c.$implicit,r=u(3);l(),s("ngClass",L(3,ct,!e.actividad_id)),l(2),P(e.actividad_id?"construction":"dashboard"),l(),x(" ",r.getActividadNombre(e.actividad_id)," ")}}function Dt(i,c){i&1&&(n(0,"th",83),a(1,"Fecha"),t())}function Ft(i,c){if(i&1&&(n(0,"td",84),a(1),w(2,"date"),t()),i&2){let e=c.$implicit;l(),P(K(2,1,e.fecha,"dd/MM/yyyy"))}}function qt(i,c){i&1&&(n(0,"th",83),a(1,"Estado"),t())}function Vt(i,c){if(i&1&&(n(0,"td",84)(1,"span",86)(2,"mat-icon"),a(3),t(),a(4),w(5,"titlecase"),t()()),i&2){let e=c.$implicit,r=u(3);l(),s("ngClass","status-"+e.estado),l(2),P(r.getStatusIcon(e.estado)),l(),x(" ",U(5,3,e.estado)," ")}}function jt(i,c){i&1&&(n(0,"th",83),a(1,"Avance F\xEDsico"),t())}function zt(i,c){if(i&1&&(n(0,"td",84)(1,"div",87)(2,"span",88),a(3),t(),f(4,"mat-progress-bar",89),t()()),i&2){let e=c.$implicit,r=u(3);l(3),x("",e.avance_fisico,"%"),l(),s("value",e.avance_fisico)("color",r.getProgressColor(e.avance_fisico))}}function Nt(i,c){i&1&&(n(0,"th",83),a(1,"Productividad"),t())}function At(i,c){if(i&1&&(n(0,"td",84)(1,"span",90),a(2),t()()),i&2){let e=c.$implicit,r=u(3);l(),s("ngClass",r.getMetricClass(e.productividad,80)),l(),x(" ",e.productividad,"% ")}}function $t(i,c){i&1&&(n(0,"th",83),a(1,"Calidad"),t())}function Rt(i,c){if(i&1&&(n(0,"td",84)(1,"span",90),a(2),t()()),i&2){let e=c.$implicit,r=u(3);l(),s("ngClass",r.getMetricClass(e.calidad,85)),l(),x(" ",e.calidad,"% ")}}function Bt(i,c){i&1&&(n(0,"th",83),a(1,"Personal"),t())}function Lt(i,c){if(i&1&&(n(0,"td",84)(1,"span",91)(2,"mat-icon"),a(3,"people"),t(),a(4),t()()),i&2){let e=c.$implicit;l(4),x(" ",e.personal_asignado," ")}}function Ut(i,c){i&1&&(n(0,"th",92),a(1,"Costos"),t())}function Ht(i,c){if(i&1&&(n(0,"td",84)(1,"div",93)(2,"div",94),a(3),w(4,"number"),t(),n(5,"div",95),a(6),w(7,"number"),t(),n(8,"div",96),a(9),t()()()),i&2){let e=c.$implicit,r=u(3);l(3),x("$",K(4,4,e.costo_ejecutado,"1.0-0"),""),l(3),x("$",K(7,7,e.costo_presupuestado,"1.0-0"),""),l(2),s("ngClass",r.getCostVarianceClass(e.costo_ejecutado,e.costo_presupuestado)),l(),x(" ",r.getCostVariancePercent(e.costo_ejecutado,e.costo_presupuestado),"% ")}}function Gt(i,c){i&1&&(n(0,"th",83),a(1,"Cronograma"),t())}function Yt(i,c){if(i&1&&(n(0,"td",84)(1,"span",97)(2,"mat-icon"),a(3),t(),a(4),t()()),i&2){let e=c.$implicit,r=u(3);l(),s("ngClass",r.getScheduleClass(e.desviacion_cronograma)),l(2),P(r.getScheduleIcon(e.desviacion_cronograma)),l(),x(" ",e.desviacion_cronograma," d\xEDas ")}}function Qt(i,c){i&1&&(n(0,"th",83),a(1,"Seguridad"),t())}function Wt(i,c){if(i&1&&(n(0,"td",84)(1,"span",98)(2,"mat-icon"),a(3),t(),a(4),t()()),i&2){let e=c.$implicit,r=u(3);l(),s("ngClass",r.getSafetyClass(e.incidentes_seguridad)),l(2),P(r.getSafetyIcon(e.incidentes_seguridad)),l(),x(" ",e.incidentes_seguridad||0," ")}}function Jt(i,c){i&1&&(n(0,"th",92),a(1,"Acciones"),t())}function Xt(i,c){if(i&1){let e=O();n(0,"td",84)(1,"div",99)(2,"button",100),M("click",function(){let o=b(e).$implicit,d=u(3);return v(d.editKpi(o))}),n(3,"mat-icon"),a(4,"edit"),t()(),n(5,"button",101),M("click",function(){let o=b(e).$implicit,d=u(3);return v(d.viewDetails(o))}),n(6,"mat-icon"),a(7,"visibility"),t()(),n(8,"button",102),M("click",function(){let o=b(e).$implicit,d=u(3);return v(d.deleteKpi(o))}),n(9,"mat-icon"),a(10,"delete"),t()()()()}if(i&2){let e=u(3);l(2),s("disabled",e.loading),l(3),s("disabled",e.loading),l(3),s("disabled",e.loading)}}function Zt(i,c){i&1&&f(0,"tr",103)}function ei(i,c){i&1&&f(0,"tr",104)}function ti(i,c){if(i&1&&(n(0,"table",65),C(1,66),m(2,kt,2,0,"th",67)(3,It,2,1,"td",68),h(),C(4,69),m(5,Kt,2,0,"th",67)(6,Tt,5,5,"td",68),h(),C(7,70),m(8,Dt,2,0,"th",67)(9,Ft,3,4,"td",68),h(),C(10,71),m(11,qt,2,0,"th",67)(12,Vt,6,5,"td",68),h(),C(13,72),m(14,jt,2,0,"th",67)(15,zt,5,3,"td",68),h(),C(16,73),m(17,Nt,2,0,"th",67)(18,At,3,2,"td",68),h(),C(19,74),m(20,$t,2,0,"th",67)(21,Rt,3,2,"td",68),h(),C(22,75),m(23,Bt,2,0,"th",67)(24,Lt,5,1,"td",68),h(),C(25,76),m(26,Ut,2,0,"th",77)(27,Ht,10,10,"td",68),h(),C(28,78),m(29,Gt,2,0,"th",67)(30,Yt,5,3,"td",68),h(),C(31,79),m(32,Qt,2,0,"th",67)(33,Wt,5,3,"td",68),h(),C(34,80),m(35,Jt,2,0,"th",77)(36,Xt,11,3,"td",68),h(),m(37,Zt,1,0,"tr",81)(38,ei,1,0,"tr",82),t()),i&2){let e=u(2);s("dataSource",e.dataSource),l(37),s("matHeaderRowDef",e.displayedColumns),l(),s("matRowDefColumns",e.displayedColumns)}}function ii(i,c){i&1&&(n(0,"div",105)(1,"mat-icon"),a(2,"analytics"),t(),n(3,"h3"),a(4,"No hay KPIs registrados"),t(),n(5,"p"),a(6,"Comience creando su primer KPI para monitorear el rendimiento"),t()())}function ni(i,c){if(i&1&&(n(0,"div",63),m(1,ti,39,3,"table",64)(2,ii,7,0,"ng-template",null,2,T),t()),i&2){let e=I(3),r=u();l(),s("ngIf",r.kpis.length>0)("ngIfElse",e)}}function ai(i,c){i&1&&(n(0,"div",106),f(1,"mat-spinner",107),t())}var ji=(()=>{class i{constructor(e,r,o,d,p){this.fb=e,this.kpisService=r,this.obrasService=o,this.directAuthService=d,this.snackBar=p,this.kpis=[],this.obras=[],this.actividades=[],this.loading=!1,this.submitting=!1,this.editingKpi=null,this.displayedColumns=["obra","actividad","fecha","estado","avance_fisico","productividad","calidad","personal_asignado","costos","desviacion_cronograma","incidentes_seguridad","actions"],this.dataSource=new Ze(this.kpis),this.initializeForm()}initializeForm(){this.kpiForm=this.fb.group({obra_id:["",_.required],actividad_id:[{value:"",disabled:!0}],fecha:[new Date,_.required],estado:["activo",_.required],avance_fisico:[0,[_.required,_.min(0),_.max(100)]],productividad:[0,[_.required,_.min(0)]],personal_asignado:[0,[_.required,_.min(0)]],maquinaria_utilizada:[""],calidad:[0,[_.required,_.min(0),_.max(100)]],incidentes_seguridad:[0,[_.min(0)]],clima_condiciones:[""],desviacion_cronograma:[0,[_.required]],costo_ejecutado:[0,[_.required,_.min(0)]],costo_presupuestado:[0,[_.required,_.min(0)]],observaciones_tecnicas:[""],metricas_adicionales:[""]})}ngOnInit(){if(!this.directAuthService.getCurrentUser()){this.showMessage("Debe iniciar sesi\xF3n para acceder a los KPIs. Redirigiendo al login..."),setTimeout(()=>{window.location.href="/login"},2e3);return}this.loadObras(),this.setupKpisSubscription()}setupKpisSubscription(){this.loading=!0,this.kpisService.kpis$.subscribe({next:e=>{this.kpis=e,this.dataSource.data=this.kpis,this.loading=!1},error:e=>{this.showMessage("Error al cargar los KPIs"),this.loading=!1}})}loadObras(){this.obrasService.obras$.subscribe({next:e=>{this.obras=e},error:e=>{this.showMessage("Error al cargar las obras")}})}onObraChange(e){return E(this,null,function*(){if(e)try{this.actividades=yield this.kpisService.getActividadesByObra(e),this.kpiForm.get("actividad_id")?.enable(),this.kpiForm.patchValue({actividad_id:""})}catch{this.showMessage("Error al cargar las actividades"),this.actividades=[],this.kpiForm.get("actividad_id")?.disable()}else this.actividades=[],this.kpiForm.get("actividad_id")?.disable(),this.kpiForm.patchValue({actividad_id:""})})}loadKpis(){this.loading=!0}onSubmit(){return E(this,null,function*(){if(this.kpiForm.valid&&!this.submitting){let e=this.directAuthService.getCurrentUser();if(!e){this.showMessage("Debe iniciar sesi\xF3n para crear KPIs. Por favor, inicie sesi\xF3n e intente nuevamente.");return}if(!this.directAuthService.getAccessToken()){this.showMessage("Token de autenticaci\xF3n no v\xE1lido. Por favor, inicie sesi\xF3n nuevamente.");return}try{this.loading=!0,this.submitting=!0;let o=this.kpiForm.getRawValue();if(!this.editingKpi&&(yield this.checkForDuplicateKPI(o))){this.showMessage("Ya existe un KPI para esta obra/actividad en la fecha seleccionada"),this.loading=!1,this.submitting=!1;return}let d={obra_id:o.obra_id,actividad_id:o.actividad_id||null,fecha:o.fecha instanceof Date?o.fecha.toISOString().split("T")[0]:o.fecha,avance_fisico:o.avance_fisico,productividad:o.productividad,calidad:o.calidad,desviacion_cronograma:o.desviacion_cronograma,costo_ejecutado:o.costo_ejecutado,costo_presupuestado:o.costo_presupuestado,personal_asignado:o.personal_asignado,maquinaria_utilizada:o.maquinaria_utilizada,incidentes_seguridad:o.incidentes_seguridad,clima_condiciones:o.clima_condiciones,observaciones_tecnicas:o.observaciones_tecnicas,estado:o.estado,metricas_adicionales:o.metricas_adicionales?{notas:o.metricas_adicionales}:null,created_by:e.id};this.editingKpi&&this.editingKpi.id?(yield this.kpisService.updateKPI(this.editingKpi.id,d),this.showMessage("KPI actualizado exitosamente")):(yield this.kpisService.createKPI(d),this.showMessage("KPI creado exitosamente")),this.resetForm()}catch(o){let d="Error al guardar el KPI";o?.message&&(o.message.includes("duplicate key")||o.message.includes("unique constraint")?d="Ya existe un KPI para esta obra/actividad en la fecha seleccionada":o.message.includes("permission denied")?d="No tiene permisos para crear/actualizar KPIs en esta obra":d=`Error: ${o.message}`),this.showMessage(d)}finally{this.loading=!1,this.submitting=!1}}else this.submitting})}editKpi(e){return E(this,null,function*(){this.editingKpi=e,e.obra_id?yield this.onObraChange(e.obra_id):this.kpiForm.get("actividad_id")?.disable(),this.kpiForm.patchValue({obra_id:e.obra_id,actividad_id:e.actividad_id||"",fecha:new Date(e.fecha),estado:e.estado||"activo",avance_fisico:e.avance_fisico||0,productividad:e.productividad||0,personal_asignado:e.personal_asignado||0,maquinaria_utilizada:e.maquinaria_utilizada||"",calidad:e.calidad||0,incidentes_seguridad:e.incidentes_seguridad||0,clima_condiciones:e.clima_condiciones||"",desviacion_cronograma:e.desviacion_cronograma||0,costo_ejecutado:e.costo_ejecutado||0,costo_presupuestado:e.costo_presupuestado||0,observaciones_tecnicas:e.observaciones_tecnicas||"",metricas_adicionales:e.metricas_adicionales?.notas||""})})}deleteKpi(e){return E(this,null,function*(){if(confirm("\xBFEst\xE1 seguro de que desea eliminar este KPI?"))try{this.loading=!0,e.id?(yield this.kpisService.deleteKPI(e.id),this.showMessage("KPI eliminado exitosamente")):this.showMessage("Error: KPI sin ID v\xE1lido")}catch(r){let o="Error al eliminar el KPI";r?.message&&(r.message.includes("permission denied")||r.message.includes("RLS")?o="No tiene permisos para eliminar este KPI. Verifique que est\xE9 asignado a la obra correspondiente.":r.message.includes("foreign key")||r.message.includes("constraint")?o="No se puede eliminar el KPI porque tiene registros relacionados.":r.message.includes("not found")?o="El KPI ya no existe o fue eliminado previamente.":o=`Error: ${r.message}`),this.showMessage(o)}finally{this.loading=!1}})}resetForm(){this.editingKpi=null,this.actividades=[],this.kpiForm.reset({obra_id:"",actividad_id:"",fecha:new Date,avance_fisico:0,productividad:0,calidad:0,desviacion_cronograma:0,metricas_adicionales:""}),this.kpiForm.get("actividad_id")?.disable()}checkForDuplicateKPI(e){return E(this,null,function*(){try{let r=e.fecha instanceof Date?e.fecha.toISOString().split("T")[0]:e.fecha;return this.kpis.filter(d=>{let p=new Date(d.fecha).toISOString().split("T")[0];if(!e.actividad_id&&!d.actividad_id){let g=d.obra_id===e.obra_id&&p===r;return g}if(e.actividad_id&&d.actividad_id){let g=d.obra_id===e.obra_id&&d.actividad_id===e.actividad_id&&p===r;return g}return!1}).length>0}catch{return!1}})}calculateOverallValue(e){let r={avance_fisico:.3,productividad:.3,calidad:.4};return Math.round(e.avance_fisico*r.avance_fisico+e.productividad*r.productividad+e.calidad*r.calidad)}showMessage(e){this.snackBar.open(e,"Cerrar",{duration:3e3,horizontalPosition:"right",verticalPosition:"top"})}getObraNombre(e){let r=this.obras.find(o=>o.id===e);return r?r.nombre:"Obra no encontrada"}getActividadNombre(e){if(!e)return"KPI General";let r=this.actividades.find(o=>o.id===e);return r?`${r.tipo_actividad} - ${this.getUbicacionDisplay(r.ubicacion)}`:"Actividad no encontrada"}getUbicacionDisplay(e){return e?typeof e=="object"&&e.lat&&e.lng?e.direccion||`Lat: ${e.lat}, Lng: ${e.lng}`:typeof e=="string"?e:"No especificada":"No especificada"}getStatusIcon(e){switch(e){case"activo":return"play_circle";case"revision":return"pending";case"aprobado":return"check_circle";default:return"help"}}getProgressColor(e){return e>=80?"primary":e>=60?"accent":"warn"}getMetricClass(e,r){return e>=r?"metric-good":e>=r*.7?"metric-warning":"metric-poor"}getCostVariancePercent(e,r){return r?Math.round((e-r)/r*100):0}getCostVarianceClass(e,r){let o=this.getCostVariancePercent(e,r);return o<=5?"cost-good":o<=15?"cost-warning":"cost-over"}getScheduleClass(e){return e<=0?"schedule-good":e<=5?"schedule-warning":"schedule-delayed"}getScheduleIcon(e){return e<=0?"schedule":e<=5?"schedule_send":"warning"}getSafetyClass(e){return e===0?"safety-good":e<=2?"safety-warning":"safety-critical"}getSafetyIcon(e){return e===0?"verified_user":e<=2?"warning":"dangerous"}applyFilter(e){let r=e.target.value;this.dataSource.filter=r.trim().toLowerCase()}filterByStatus(e){e?this.dataSource.data=this.kpis.filter(r=>r.estado===e):this.dataSource.data=this.kpis}viewDetails(e){}calculateProductivitySuggestion(e,r){let o=e/r,d=100/30;return o>=d?"Excelente ritmo de trabajo. Mantener el rendimiento actual.":o>=d*.8?"Ritmo adecuado. Considerar optimizar procesos para mejorar.":"Ritmo bajo. Revisar recursos y planificaci\xF3n urgentemente."}calculateCostProjection(e,r,o){if(r===0)return{proyeccion:o,varianza:0,alerta:!1};let d=e/r*100,p=(d-o)/o*100,g=p>10;return{proyeccion:Math.round(d),varianza:Math.round(p),alerta:g,mensaje:g?"Riesgo de sobrecosto detectado":"Costos dentro del rango esperado"}}calculateQualityIndex(e,r){let o=e;r>0&&(o-=r*10),o=Math.max(0,Math.min(100,o));let d="Excelente",p="#4caf50";return o<60?(d="Deficiente",p="#f44336"):o<80?(d="Regular",p="#ff9800"):o<90&&(d="Bueno",p="#2196f3"),{indice:o,categoria:d,color:p}}getWeatherImpactSuggestion(e){switch(e?.toLowerCase()){case"lluvia":return"Considerar actividades bajo techo. Revisar drenajes y protecciones.";case"viento fuerte":return"Suspender trabajos en altura. Asegurar materiales y equipos.";case"calor extremo":return"Programar descansos frecuentes. Hidrataci\xF3n constante del personal.";case"frio":return"Verificar equipos de calefacci\xF3n. Ajustar horarios de trabajo.";default:return"Condiciones favorables para el trabajo normal."}}calculateResourceOptimization(e,r){let o=r/e,d="",p="";return o>5?(d="Excelente eficiencia del personal",p="Mantener el equipo actual"):o>3?(d="Eficiencia adecuada",p="Considerar capacitaci\xF3n adicional"):(d="Baja eficiencia detectada",p="Revisar asignaci\xF3n de tareas y capacidades"),{eficiencia:Math.round(o*100)/100,sugerencia:d,accion:p}}applyAutomaticCalculations(){let e=this.kpiForm.value;if(e.avance_fisico&&e.personal_asignado){let r=this.calculateResourceOptimization(e.personal_asignado,e.avance_fisico);this.kpiForm.patchValue({observaciones_tecnicas:`${e.observaciones_tecnicas||""}

Sugerencias autom\xE1ticas:
- Eficiencia personal: ${r.eficiencia}%
- ${r.sugerencia}
- Acci\xF3n recomendada: ${r.accion}`})}e.costo_ejecutado&&e.avance_fisico&&e.costo_presupuestado&&this.calculateCostProjection(e.costo_ejecutado,e.avance_fisico,e.costo_presupuestado).alerta}static{this.\u0275fac=function(r){return new(r||i)(S(de),S(ze),S(ot),S(qe),S(De))}}static{this.\u0275cmp=R({type:i,selectors:[["app-kpis"]],decls:202,vars:29,consts:[["picker",""],["loadingTemplate",""],["noDataTemplate",""],[1,"kpis-container"],[1,"header"],["class","auth-status",4,"ngIf"],[1,"form-card"],[1,"kpi-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"section-title"],[1,"form-row"],["appearance","outline"],["formControlName","obra_id","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","actividad_id"],["value",""],["matInput","","formControlName","fecha","required","",3,"matDatepicker"],["matSuffix","",3,"for"],["formControlName","estado","required",""],["value","activo"],["value","revision"],["value","aprobado"],["matInput","","type","number","formControlName","avance_fisico","min","0","max","100","required",""],["matInput","","type","number","formControlName","productividad","min","0","required",""],["matInput","","type","number","formControlName","personal_asignado","min","0","required",""],["matInput","","formControlName","maquinaria_utilizada","rows","2","placeholder","Ej: Excavadora CAT 320, Volqueta 10m\xB3, Compactadora..."],["matInput","","type","number","formControlName","calidad","min","0","max","100","required",""],["matInput","","type","number","formControlName","incidentes_seguridad","min","0"],["formControlName","clima_condiciones"],["value","soleado"],["value","nublado"],["value","lluvioso"],["value","ventoso"],["value","adverso"],["matInput","","type","number","formControlName","desviacion_cronograma","required",""],["matInput","","type","number","formControlName","costo_ejecutado","min","0","required",""],["matPrefix",""],["matInput","","type","number","formControlName","costo_presupuestado","min","0","required",""],[1,"form-row","full-width"],["matInput","","formControlName","observaciones_tecnicas","rows","3","placeholder","Describa aspectos t\xE9cnicos relevantes, dificultades encontradas, soluciones implementadas..."],["matInput","","formControlName","metricas_adicionales","rows","2","placeholder","Informaci\xF3n adicional, m\xE9tricas especiales, comentarios generales..."],[1,"form-actions"],["type","button","mat-raised-button","","color","accent",3,"click","disabled"],["mat-raised-button","","color","primary","type","button",3,"click","disabled"],["diameter","20","style","display: inline-block; margin-right: 8px;",4,"ngIf"],["mat-button","","type","button",3,"disabled","click",4,"ngIf"],[1,"table-card"],["class","table-filters",4,"ngIf"],["class","table-container",4,"ngIf","ngIfElse"],[1,"auth-status"],[1,"warning-card"],[1,"warning-content"],["color","warn"],[3,"value"],["diameter","20",2,"display","inline-block","margin-right","8px"],["mat-button","","type","button",3,"click","disabled"],[1,"table-filters"],["appearance","outline",1,"search-field"],["matInput","","placeholder","Buscar por obra, fecha...",3,"keyup"],["matSuffix",""],["appearance","outline",1,"filter-field"],[3,"selectionChange"],[1,"table-container"],["mat-table","","class","kpi-table","matSort","",3,"dataSource",4,"ngIf","ngIfElse"],["mat-table","","matSort","",1,"kpi-table",3,"dataSource"],["matColumnDef","obra"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","actividad"],["matColumnDef","fecha"],["matColumnDef","estado"],["matColumnDef","avance_fisico"],["matColumnDef","productividad"],["matColumnDef","calidad"],["matColumnDef","personal_asignado"],["matColumnDef","costos"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","desviacion_cronograma"],["matColumnDef","incidentes_seguridad"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","kpi-row",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[1,"actividad-info",3,"ngClass"],[1,"status-badge",3,"ngClass"],[1,"progress-cell"],[1,"progress-text"],["mode","determinate",3,"value","color"],[1,"metric-value",3,"ngClass"],[1,"personnel-count"],["mat-header-cell",""],[1,"cost-info"],[1,"cost-executed"],[1,"cost-budget"],[1,"cost-variance",3,"ngClass"],[1,"schedule-deviation",3,"ngClass"],[1,"safety-incidents",3,"ngClass"],[1,"action-buttons"],["mat-icon-button","","color","primary","matTooltip","Editar KPI",3,"click","disabled"],["mat-icon-button","","color","accent","matTooltip","Ver Detalles",3,"click","disabled"],["mat-icon-button","","color","warn","matTooltip","Eliminar KPI",3,"click","disabled"],["mat-header-row",""],["mat-row","",1,"kpi-row"],[1,"no-data"],[1,"loading-spinner"],["diameter","50"]],template:function(r,o){if(r&1){let d=O();n(0,"div",3)(1,"div",4)(2,"h1"),a(3,"Gesti\xF3n de KPIs"),t(),n(4,"p"),a(5,"Ingrese los datos de rendimiento que alimentar\xE1n los gr\xE1ficos del dashboard"),t(),m(6,lt,8,0,"div",5),t(),n(7,"mat-card",6)(8,"mat-card-header")(9,"mat-card-title")(10,"mat-icon"),a(11,"analytics"),t(),a(12),t(),n(13,"mat-card-subtitle"),a(14,"Complete todos los campos para un registro detallado del rendimiento"),t()(),n(15,"mat-card-content")(16,"form",7),M("ngSubmit",function(g){return b(d),v(g.preventDefault())}),n(17,"div",8)(18,"h3",9)(19,"mat-icon"),a(20,"info"),t(),a(21," Informaci\xF3n General "),t(),n(22,"div",10)(23,"mat-form-field",11)(24,"mat-label"),a(25,"Obra"),t(),n(26,"mat-select",12),M("selectionChange",function(g){return b(d),v(o.onObraChange(g.value))}),m(27,dt,2,2,"mat-option",13),t(),m(28,st,2,0,"mat-error",14),t(),n(29,"mat-form-field",11)(30,"mat-label"),a(31,"Actividad (Opcional)"),t(),n(32,"mat-select",15)(33,"mat-option",16),a(34,"-- Sin actividad espec\xEDfica --"),t(),m(35,mt,2,3,"mat-option",13),t(),n(36,"mat-hint"),a(37,"Seleccione una actividad espec\xEDfica o deje vac\xEDo para KPI general de la obra"),t()(),n(38,"mat-form-field",11)(39,"mat-label"),a(40,"Fecha"),t(),f(41,"input",17)(42,"mat-datepicker-toggle",18)(43,"mat-datepicker",null,0),m(45,pt,2,0,"mat-error",14),t(),n(46,"mat-form-field",11)(47,"mat-label"),a(48,"Estado"),t(),n(49,"mat-select",19)(50,"mat-option",20),a(51,"Activo"),t(),n(52,"mat-option",21),a(53,"En Revisi\xF3n"),t(),n(54,"mat-option",22),a(55,"Aprobado"),t()()()()(),n(56,"div",8)(57,"h3",9)(58,"mat-icon"),a(59,"trending_up"),t(),a(60," M\xE9tricas de Rendimiento "),t(),n(61,"div",10)(62,"mat-form-field",11)(63,"mat-label"),a(64,"Avance F\xEDsico (%)"),t(),f(65,"input",23),n(66,"mat-hint"),a(67,"Porcentaje de avance f\xEDsico de la obra"),t(),m(68,ut,2,0,"mat-error",14)(69,_t,2,0,"mat-error",14),t(),n(70,"mat-form-field",11)(71,"mat-label"),a(72,"Productividad (%)"),t(),f(73,"input",24),n(74,"mat-hint"),a(75,"Eficiencia del equipo de trabajo"),t(),m(76,ft,2,0,"mat-error",14)(77,gt,2,0,"mat-error",14),t()(),n(78,"div",10)(79,"mat-form-field",11)(80,"mat-label"),a(81,"Personal Asignado"),t(),f(82,"input",25),n(83,"mat-hint"),a(84,"N\xFAmero de trabajadores asignados"),t(),m(85,xt,2,0,"mat-error",14),t(),n(86,"mat-form-field",11)(87,"mat-label"),a(88,"Maquinaria Utilizada"),t(),f(89,"textarea",26),n(90,"mat-hint"),a(91,"Descripci\xF3n de equipos y maquinaria"),t()()()(),n(92,"div",8)(93,"h3",9)(94,"mat-icon"),a(95,"security"),t(),a(96," Calidad y Seguridad "),t(),n(97,"div",10)(98,"mat-form-field",11)(99,"mat-label"),a(100,"Calidad (%)"),t(),f(101,"input",27),n(102,"mat-hint"),a(103,"\xCDndice de calidad de los trabajos ejecutados"),t(),m(104,Ct,2,0,"mat-error",14)(105,ht,2,0,"mat-error",14),t(),n(106,"mat-form-field",11)(107,"mat-label"),a(108,"Incidentes de Seguridad"),t(),f(109,"input",28),n(110,"mat-hint"),a(111,"N\xFAmero de incidentes reportados"),t()(),n(112,"mat-form-field",11)(113,"mat-label"),a(114,"Condiciones Clim\xE1ticas"),t(),n(115,"mat-select",29)(116,"mat-option",30),a(117,"Soleado"),t(),n(118,"mat-option",31),a(119,"Nublado"),t(),n(120,"mat-option",32),a(121,"Lluvioso"),t(),n(122,"mat-option",33),a(123,"Ventoso"),t(),n(124,"mat-option",34),a(125,"Adverso"),t()(),n(126,"mat-hint"),a(127,"Condiciones durante el per\xEDodo"),t()()()(),n(128,"div",8)(129,"h3",9)(130,"mat-icon"),a(131,"schedule"),t(),a(132," Cronograma y Costos "),t(),n(133,"div",10)(134,"mat-form-field",11)(135,"mat-label"),a(136,"Desviaci\xF3n Cronograma (d\xEDas)"),t(),f(137,"input",35),n(138,"mat-hint"),a(139,"Valores negativos = adelanto, positivos = retraso"),t(),m(140,bt,2,0,"mat-error",14),t(),n(141,"mat-form-field",11)(142,"mat-label"),a(143,"Costo Ejecutado"),t(),f(144,"input",36),n(145,"span",37),a(146,"$ \xA0"),t(),n(147,"mat-hint"),a(148,"Costo real ejecutado hasta la fecha"),t(),m(149,vt,2,0,"mat-error",14),t(),n(150,"mat-form-field",11)(151,"mat-label"),a(152,"Costo Presupuestado"),t(),f(153,"input",38),n(154,"span",37),a(155,"$ \xA0"),t(),n(156,"mat-hint"),a(157,"Costo presupuestado para el per\xEDodo"),t(),m(158,Mt,2,0,"mat-error",14),t()()(),n(159,"div",8)(160,"h3",9)(161,"mat-icon"),a(162,"note"),t(),a(163," Observaciones y Notas "),t(),n(164,"div",39)(165,"mat-form-field",11)(166,"mat-label"),a(167,"Observaciones T\xE9cnicas"),t(),f(168,"textarea",40),n(169,"mat-hint"),a(170,"Informaci\xF3n t\xE9cnica detallada del per\xEDodo"),t()()(),n(171,"div",39)(172,"mat-form-field",11)(173,"mat-label"),a(174,"M\xE9tricas Adicionales"),t(),f(175,"textarea",41),n(176,"mat-hint"),a(177,"Informaci\xF3n complementaria opcional"),t()()()(),n(178,"div",42)(179,"button",43),M("click",function(){return b(d),v(o.applyAutomaticCalculations())}),n(180,"mat-icon"),a(181,"auto_fix_high"),t(),a(182," Calcular Sugerencias "),t(),n(183,"button",44),M("click",function(){return b(d),v(o.onSubmit())}),m(184,Pt,2,0,"mat-icon",14)(185,Et,1,0,"mat-spinner",45)(186,St,2,0,"span",14)(187,Ot,2,1,"span",14),t(),m(188,wt,4,1,"button",46),t()()()(),n(189,"mat-card",47)(190,"mat-card-header")(191,"mat-card-title")(192,"mat-icon"),a(193,"table_chart"),t(),a(194," KPIs Registrados "),t(),n(195,"mat-card-subtitle"),a(196,"Visualizaci\xF3n detallada de todos los indicadores de rendimiento"),t()(),n(197,"mat-card-content"),m(198,yt,19,0,"div",48)(199,ni,4,2,"div",49)(200,ai,2,0,"ng-template",null,1,T),t()()()}if(r&2){let d,p,g,y,D,F,q,V,k,j,z,N,A,$=I(44),rt=I(201);l(6),s("ngIf",!o.directAuthService.getCurrentUser()),l(6),x(" ",o.editingKpi?"Editar KPI":"Nuevo KPI"," "),l(4),s("formGroup",o.kpiForm),l(11),s("ngForOf",o.obras),l(),s("ngIf",(d=o.kpiForm.get("obra_id"))==null?null:d.hasError("required")),l(7),s("ngForOf",o.actividades),l(6),s("matDatepicker",$),l(),s("for",$),l(3),s("ngIf",(p=o.kpiForm.get("fecha"))==null?null:p.hasError("required")),l(23),s("ngIf",(g=o.kpiForm.get("avance_fisico"))==null?null:g.hasError("required")),l(),s("ngIf",((y=o.kpiForm.get("avance_fisico"))==null?null:y.hasError("min"))||((y=o.kpiForm.get("avance_fisico"))==null?null:y.hasError("max"))),l(7),s("ngIf",(D=o.kpiForm.get("productividad"))==null?null:D.hasError("required")),l(),s("ngIf",(F=o.kpiForm.get("productividad"))==null?null:F.hasError("min")),l(8),s("ngIf",(q=o.kpiForm.get("personal_asignado"))==null?null:q.hasError("required")),l(19),s("ngIf",(V=o.kpiForm.get("calidad"))==null?null:V.hasError("required")),l(),s("ngIf",((k=o.kpiForm.get("calidad"))==null?null:k.hasError("min"))||((k=o.kpiForm.get("calidad"))==null?null:k.hasError("max"))),l(35),s("ngIf",(j=o.kpiForm.get("desviacion_cronograma"))==null?null:j.hasError("required")),l(9),s("ngIf",(z=o.kpiForm.get("costo_ejecutado"))==null?null:z.hasError("required")),l(9),s("ngIf",(N=o.kpiForm.get("costo_presupuestado"))==null?null:N.hasError("required")),l(21),s("disabled",!((A=o.kpiForm.get("avance_fisico"))!=null&&A.value)),l(4),s("disabled",!o.kpiForm.valid||o.loading||o.submitting),l(),s("ngIf",!o.submitting),l(),s("ngIf",o.submitting),l(),s("ngIf",o.submitting),l(),s("ngIf",!o.submitting),l(),s("ngIf",o.editingKpi),l(10),s("ngIf",o.kpis.length>0),l(),s("ngIf",!o.loading)("ngIfElse",rt)}},dependencies:[X,H,G,Y,J,Q,W,se,ie,Z,ne,ee,te,le,ce,re,ae,oe,ge,me,ue,fe,_e,pe,Pe,Me,xe,he,Ce,be,ve,Se,Ee,$e,Ae,Ne,nt,et,tt,it,at,ye,we,Oe,Xe,Re,Le,Ye,Ue,Be,Qe,He,Ge,We,Je,Ie,ke,Fe,Te,Ke,je,Ve],styles:[".kpis-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto;background:#f5f7fa;min-height:100vh}.auth-status[_ngcontent-%COMP%]{margin-bottom:20px}.warning-card[_ngcontent-%COMP%]{background-color:#fff3cd;border:1px solid #ffeaa7;border-radius:8px}.warning-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#856404;font-weight:500}.warning-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#ff9800}.form-card[_ngcontent-%COMP%]{margin-bottom:30px;box-shadow:0 4px 12px #0000001a;border-radius:12px;background:#fff}.form-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px 12px 0 0;padding:20px}.form-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:1.5rem;font-weight:600}.form-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{color:#fffc;margin-top:8px}.kpi-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px;padding:20px}.form-section[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;padding:20px;border-left:4px solid #667eea}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin:0 0 20px;color:#333;font-size:1.2rem;font-weight:500}.section-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.form-row[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:flex-start;margin-bottom:15px}.form-row[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{flex:1}.form-row.full-width[_ngcontent-%COMP%]{flex-direction:column}.form-row.full-width[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;gap:15px;justify-content:flex-end;margin-top:30px;padding:20px;background:#f8f9fa;border-radius:0 0 12px 12px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:140px;height:45px;font-weight:500}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.table-card[_ngcontent-%COMP%]{margin-top:30px;box-shadow:0 8px 24px #0000001f;border-radius:16px;background:#fff;overflow:hidden}.table-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#7c3aed);color:#fff;padding:24px}.table-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:1.5rem;font-weight:600;margin:0}.table-card[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{color:#ffffffe6;margin-top:8px;font-size:.95rem}.table-filters[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:24px;padding:20px;background:#f8fafc;border-radius:12px;align-items:flex-end}.search-field[_ngcontent-%COMP%], .filter-field[_ngcontent-%COMP%]{flex:1;max-width:300px}.table-container[_ngcontent-%COMP%]{overflow-x:auto;background:#fff}.kpi-table[_ngcontent-%COMP%]{width:100%;min-width:1200px;background:#fff}.kpi-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8fafc;color:#374151;font-weight:600;font-size:.875rem;text-transform:uppercase;letter-spacing:.05em;padding:16px 12px;border-bottom:2px solid #e5e7eb}.kpi-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px 12px;border-bottom:1px solid #f3f4f6;vertical-align:middle}.kpi-row[_ngcontent-%COMP%]{transition:all .2s ease;cursor:pointer}.kpi-row[_ngcontent-%COMP%]:hover{background-color:#f9fafb;transform:translateY(-1px);box-shadow:0 4px 12px #0000000d}.actividad-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:500}.actividad-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.general-kpi[_ngcontent-%COMP%]{color:#7c3aed}.general-kpi[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#7c3aed}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:20px;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em}.status-activo[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.status-revision[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-aprobado[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.status-pausado[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.status-cancelado[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.progress-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;min-width:100px}.progress-text[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;color:#374151}mat-progress-bar[_ngcontent-%COMP%]{height:6px;border-radius:3px}.metric-value[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;padding:4px 8px;border-radius:6px}.metric-good[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.metric-warning[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.metric-danger[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.personnel-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-weight:500;color:#374151}.personnel-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#6b7280}.cost-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;min-width:120px}.cost-executed[_ngcontent-%COMP%]{font-weight:600;color:#374151;font-size:.875rem}.cost-budget[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280}.cost-variance[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;padding:2px 6px;border-radius:4px}.cost-over[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.cost-under[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.cost-on-budget[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.schedule-deviation[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-weight:500;padding:4px 8px;border-radius:6px}.schedule-on-time[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.schedule-delayed[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.schedule-ahead[_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.safety-incidents[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;font-weight:600;padding:4px 8px;border-radius:6px}.safety-good[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.safety-warning[_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.safety-danger[_ngcontent-%COMP%]{background:#fee2e2;color:#dc2626}.mat-column-actions[_ngcontent-%COMP%]{width:140px;text-align:center}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px;justify-content:center;align-items:center}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:8px;transition:all .2s ease}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.no-data[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#6b7280}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#d1d5db;margin-bottom:16px}.no-data[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:16px 0 8px;color:#374151;font-size:1.25rem;font-weight:600}.no-data[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:60px}@media (max-width: 1024px){.kpis-container[_ngcontent-%COMP%]{padding:16px}.table-filters[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.search-field[_ngcontent-%COMP%], .filter-field[_ngcontent-%COMP%]{max-width:100%}.kpi-table[_ngcontent-%COMP%]{min-width:1000px}}@media (max-width: 768px){.kpis-container[_ngcontent-%COMP%]{padding:12px;background:#fff}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.table-card[_ngcontent-%COMP%]{margin-top:20px;border-radius:12px}.table-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:16px}.table-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.25rem}.table-filters[_ngcontent-%COMP%]{padding:16px;margin-bottom:16px}.kpi-table[_ngcontent-%COMP%]{min-width:900px}.kpi-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .kpi-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 8px;font-size:.875rem}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:32px;height:32px}.no-data[_ngcontent-%COMP%]{padding:40px 16px}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}}@media (max-width: 480px){.kpis-container[_ngcontent-%COMP%]{padding:8px}.table-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{padding:12px}.table-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:1.125rem;gap:8px}.table-filters[_ngcontent-%COMP%]{padding:12px}.kpi-table[_ngcontent-%COMP%]{min-width:800px}.kpi-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .kpi-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 6px;font-size:.8125rem}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;font-size:.6875rem}.progress-cell[_ngcontent-%COMP%]{min-width:80px}.cost-info[_ngcontent-%COMP%]{min-width:100px}.action-buttons[_ngcontent-%COMP%]{gap:2px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:28px;height:28px}.no-data[_ngcontent-%COMP%]{padding:32px 12px}.no-data[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px}.no-data[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.125rem}}mat-card[_ngcontent-%COMP%]{border-radius:12px;transition:box-shadow .3s ease}mat-card[_ngcontent-%COMP%]:hover{box-shadow:0 12px 28px #00000026}mat-form-field[_ngcontent-%COMP%]{width:100%}.mat-mdc-raised-button[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029;transition:all .3s ease}.mat-mdc-raised-button[_ngcontent-%COMP%]:hover{box-shadow:0 6px 12px #0003;transform:translateY(-1px)}.mat-mdc-icon-button[_ngcontent-%COMP%]{margin:0 2px;transition:all .2s ease}.mat-mdc-icon-button[_ngcontent-%COMP%]:hover{background-color:#0000000a}.kpi-table[_ngcontent-%COMP%], .table-filters[_ngcontent-%COMP%], .form-section[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .5s ease-out}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:2px solid #4f46e5;outline-offset:2px}.status-badge[_ngcontent-%COMP%]:focus{outline:2px solid #4f46e5;outline-offset:2px}@media print{.kpis-container[_ngcontent-%COMP%]{background:#fff;padding:0}.form-card[_ngcontent-%COMP%], .action-buttons[_ngcontent-%COMP%]{display:none}.table-card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #e5e7eb}.kpi-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f9fafb!important;color:#000!important}.kpi-row[_ngcontent-%COMP%]:hover{background:transparent!important;transform:none!important;box-shadow:none!important}}"]})}}return i})();export{ji as KpisComponent};
