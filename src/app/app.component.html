<div class="app-container">
  <!-- Loading State -->
  <div *ngIf="!isInitialized" class="loading-layout">
    <div class="loading-container">
      <div class="loading-spinner"></div>
      <p>Verificando autenticaci贸n...</p>
    </div>
  </div>

  <!-- Authenticated Layout -->
  <div *ngIf="isInitialized && isAuthenticated" class="authenticated-layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <mat-icon class="logo-icon">construction</mat-icon>
          <span class="logo-text">SGR Obras viales</span>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <a routerLink="/dashboard" class="nav-item" routerLinkActive="active">
          <div class="nav-link">
            <mat-icon>dashboard</mat-icon>
            <span>Dashboard</span>
          </div>
        </a>
        <a routerLink="/actividades" class="nav-item" routerLinkActive="active">
          <div class="nav-link">
            <mat-icon>assignment</mat-icon>
            <span>Actividades</span>
          </div>
        </a>
        <a routerLink="/mapa" class="nav-item" routerLinkActive="active">
          <div class="nav-link">
            <mat-icon>map</mat-icon>
            <span>Mapa</span>
          </div>
        </a>
        <a routerLink="/evaluaciones" class="nav-item" routerLinkActive="active">
          <div class="nav-link">
            <mat-icon>assessment</mat-icon>
            <span>Evaluaciones</span>
          </div>
        </a>
        <a routerLink="/kpis" class="nav-item" routerLinkActive="active">
          <div class="nav-link">
            <mat-icon>analytics</mat-icon>
            <span>KPIs</span>
          </div>
        </a>
        <a routerLink="/reportes" class="nav-item" routerLinkActive="active">
          <div class="nav-link">
            <mat-icon>description</mat-icon>
            <span>Reportes</span>
          </div>
        </a>
        <a routerLink="/main" class="nav-item" routerLinkActive="active" *ngIf="currentProfile?.rol === 'residente'">
          <div class="nav-link">
            <mat-icon>build</mat-icon>
            <span>Crear Reportes</span>
          </div>
        </a>

        <a routerLink="/partidas" class="nav-item" routerLinkActive="active" *ngIf="currentProfile?.rol === 'residente'">
          <div class="nav-link">
            <mat-icon>inventory</mat-icon>
            <span>Administraci贸n de Partidas</span>
          </div>
        </a>
        <a routerLink="/obras" class="nav-item" routerLinkActive="active" *ngIf="currentProfile?.rol === 'residente'">
          <div class="nav-link">
            <mat-icon>business</mat-icon>
            <span>Obras</span>
          </div>
        </a>

        <a routerLink="/usuarios" class="nav-item" routerLinkActive="active" *ngIf="currentProfile?.rol === 'residente'">
          <div class="nav-link">
            <mat-icon>group</mat-icon>
            <span>Gesti贸n de Usuarios</span>
          </div>
        </a>
      </nav>
      
      <div class="sidebar-footer">
        <div class="user-info">
          <mat-icon>person</mat-icon>
          <div class="user-details">
            <span class="user-name">{{ currentProfile?.nombre || currentUser?.nombre || 'Usuario' }}</span>
            <span class="user-role">{{ currentProfile?.rol || 'Sin rol' }}</span>
          </div>
        </div>
        <button mat-icon-button (click)="logout()" class="logout-btn" matTooltip="Cerrar sesi贸n">
          <mat-icon>logout</mat-icon>
        </button>
      </div>
    </aside>

    <!-- Main Content Area -->
    <div class="main-content">
      <!-- Page Content -->
      <main class="page-content">
        <router-outlet></router-outlet>
      </main>
    </div>
  </div>

  <!-- Unauthenticated Layout -->
  <div *ngIf="isInitialized && !isAuthenticated" class="unauthenticated-layout">
    <router-outlet></router-outlet>
  </div>
</div>
