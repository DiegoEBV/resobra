<div class="location-selector-dialog">
  <h2 mat-dialog-title>
    <mat-icon>location_on</mat-icon>
    Seleccionar Ubicación
  </h2>
  
  <mat-dialog-content>
    <div class="location-form">
      <form [formGroup]="locationForm">
        <div class="coordinates-section">
          <h3>Coordenadas</h3>
          
          <div class="coordinates-row">
            <mat-form-field appearance="outline" class="coordinate-field">
              <mat-label>Latitud</mat-label>
              <input matInput 
                     type="number" 
                     formControlName="lat"
                     step="0.000001"
                     placeholder="-12.0464">
              <mat-icon matSuffix>my_location</mat-icon>
              <mat-error *ngIf="locationForm.get('lat')?.hasError('required')">
                La latitud es requerida
              </mat-error>
              <mat-error *ngIf="locationForm.get('lat')?.hasError('min') || locationForm.get('lat')?.hasError('max')">
                Latitud debe estar entre -90 y 90
              </mat-error>
            </mat-form-field>
            
            <mat-form-field appearance="outline" class="coordinate-field">
              <mat-label>Longitud</mat-label>
              <input matInput 
                     type="number" 
                     formControlName="lng"
                     step="0.000001"
                     placeholder="-77.0428">
              <mat-icon matSuffix>my_location</mat-icon>
              <mat-error *ngIf="locationForm.get('lng')?.hasError('required')">
                La longitud es requerida
              </mat-error>
              <mat-error *ngIf="locationForm.get('lng')?.hasError('min') || locationForm.get('lng')?.hasError('max')">
                Longitud debe estar entre -180 y 180
              </mat-error>
            </mat-form-field>
          </div>
          
          <div class="location-actions">
            <button mat-stroked-button 
                    type="button"
                    (click)="getCurrentLocation()"
                    [disabled]="gettingLocation">
              <mat-icon>gps_fixed</mat-icon>
              {{ gettingLocation ? 'Obteniendo...' : 'Usar Mi Ubicación' }}
            </button>
            
            <button mat-stroked-button 
                    type="button"
                    (click)="centerMap()"
                    [disabled]="!locationForm.valid">
              <mat-icon>center_focus_strong</mat-icon>
              Centrar Mapa
            </button>
          </div>
        </div>
        
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Dirección (opcional)</mat-label>
          <input matInput 
                 formControlName="direccion"
                 placeholder="Ingrese la dirección o descripción del lugar">
          <mat-icon matSuffix>place</mat-icon>
        </mat-form-field>
      </form>
    </div>
    
    <div class="map-section">
      <h3>Mapa Interactivo</h3>
      <div class="map-container">
        <div id="location-map" class="map"></div>
        <div class="map-instructions">
          <mat-icon>info</mat-icon>
          <span>Haz clic en el mapa para seleccionar una ubicación</span>
        </div>
      </div>
    </div>
    
    <div class="selected-location" *ngIf="locationForm.valid">
      <mat-icon>check_circle</mat-icon>
      <div class="location-info">
        <strong>Ubicación Seleccionada:</strong>
        <span>{{ locationForm.get('lat')?.value | number:'1.6-6' }}, {{ locationForm.get('lng')?.value | number:'1.6-6' }}</span>
        <span *ngIf="locationForm.get('direccion')?.value" class="address">
          {{ locationForm.get('direccion')?.value }}
        </span>
      </div>
    </div>
  </mat-dialog-content>
  
  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">
      <mat-icon>cancel</mat-icon>
      Cancelar
    </button>
    
    <button mat-raised-button 
            color="primary" 
            (click)="onConfirm()"
            [disabled]="locationForm.invalid">
      <mat-icon>save</mat-icon>
      Confirmar Ubicación
    </button>
  </mat-dialog-actions>
</div>