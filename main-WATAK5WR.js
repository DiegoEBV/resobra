import{a as Oe}from"./chunk-5XK2YORY.js";import{a as R,b as Wt}from"./chunk-GJB63F4V.js";import{a as jt,b as Kt,c as Nt,d as Ut,e as Bt,f as Gt}from"./chunk-ZRWTJLBH.js";import{a as Ht}from"./chunk-2VCPFRHH.js";import{c as qt}from"./chunk-ZLVJQ2UH.js";import"./chunk-SXXER37Y.js";import"./chunk-7BCONPA6.js";import{a as Zt}from"./chunk-4W4CX7QI.js";import{a as zt,b as Lt}from"./chunk-ZOXEDHNH.js";import{a as Rt,d as Ft}from"./chunk-ZBUPANVT.js";import"./chunk-F5X5MWHG.js";import{a as Se,b as ye}from"./chunk-WI2E4B7N.js";import"./chunk-CSWWTQFU.js";import{a as $t}from"./chunk-6DYBOFBA.js";import{a as At,b as Tt}from"./chunk-MVE6Y23E.js";import{a as D}from"./chunk-GOBT7UBB.js";import{a as It,b as Dt}from"./chunk-AZ2U4T3U.js";import"./chunk-SGYCFQGT.js";import{a as Vt}from"./chunk-WFXXN3GR.js";import{a as wt,b as kt}from"./chunk-YC5WDUOT.js";import{b as dt,c as W,d as fe,e as ct,f as lt,g as pt}from"./chunk-YMTLAEZG.js";import"./chunk-G7YPFBNB.js";import{a as ve,b as be,c as Ce,d as xe,f as Pe,h as _e}from"./chunk-SNSQLCH6.js";import{b as Ot,c as Et}from"./chunk-BXKJ5BTH.js";import"./chunk-3RK6DDJD.js";import{C as Mt,F as St,G as yt,b as mt,d as se,g as gt,h as ut,l as ht,n as ft,q as vt,t as bt,v as Ct,x as xt,y as Pt,z as _t}from"./chunk-UJ3DDJ5Q.js";import{a as et,i as tt,j as J,n as nt,o as at,p as X,r as it,s as rt,sa as Q,u as Te,ua as Me,va as ee,w as Re,wa as te,x as ot,xa as ne,y as st}from"./chunk-4WMI5X77.js";import{$ as We,B as H,Ba as T,Bb as Ae,Bc as Qe,C as Ie,Cc as Y,Db as u,E as Ue,F as Be,Gb as L,I as z,Ma as $e,Nb as a,Ob as r,Pa as He,Pb as C,Q as Ge,Tb as q,W as oe,X as De,Xb as A,Yb as E,_ as N,ba as y,c as K,db as l,ea as le,f as $,g as ke,ga as O,gb as Ze,gc as Je,ha as U,hc as o,ib as M,ic as w,jb as qe,jc as P,ka as pe,kc as ge,l as ie,lc as Xe,p as Ke,pa as B,pb as Z,q as re,qa as G,uc as ue,va as me,vb as I,wc as he,y as Ne,ya as Ve,zb as Ye}from"./chunk-B6672ACT.js";import"./chunk-X5YLR3NI.js";import{a as je,i as f}from"./chunk-ODN5LVDJ.js";function gn(i,d){i&1&&(a(0,"mat-error"),o(1," El email es requerido "),r())}function un(i,d){i&1&&(a(0,"mat-error"),o(1," Ingrese un email v\xE1lido "),r())}function hn(i,d){i&1&&(a(0,"mat-error"),o(1," La contrase\xF1a es requerida "),r())}function fn(i,d){i&1&&C(0,"mat-spinner",10)}function vn(i,d){i&1&&(a(0,"span"),o(1,"Iniciar Sesi\xF3n"),r())}var Qt=(()=>{class i{constructor(e,n,t,s,c,p){this.fb=e,this.directAuthService=n,this.router=t,this.snackBar=s,this.ngZone=c,this.cdr=p,this.hidePassword=!0,this.isLoading=!1,this.loginForm=this.fb.group({email:["",[se.required,se.email]],password:["",[se.required,se.minLength(6)]]})}onSubmit(){return f(this,null,function*(){if(this.loginForm.valid){this.isLoading=!0;let{email:e,password:n}=this.loginForm.value;console.log("\u{1F4E4} Usando DirectAuthService para login...");try{let t=yield this.directAuthService.login(e,n);if(this.isLoading=!1,t.user&&!t.error)this.snackBar.open("Inicio de sesi\xF3n exitoso","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),console.log("\u2705 Login exitoso, navegando al dashboard..."),this.router.navigate(["/dashboard"]);else{let s=t.error?.message||"Error al iniciar sesi\xF3n";s.includes("Invalid login credentials")&&(s="Credenciales inv\xE1lidas. Por favor verifique su email y contrase\xF1a."),this.snackBar.open(s,"Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}}catch(t){this.isLoading=!1,console.error("\u274C Error de conexi\xF3n:",t),this.snackBar.open("Error de conexi\xF3n. Intente nuevamente m\xE1s tarde.","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}}else console.log("\u26A0\uFE0F Formulario de login inv\xE1lido")})}static{this.\u0275fac=function(n){return new(n||i)(M(Ct),M(D),M(W),M(It),M(T),M(Y))}}static{this.\u0275cmp=Z({type:i,selectors:[["app-login"]],decls:26,vars:9,consts:[[1,"login-container"],[1,"login-card"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","type","email","formControlName","email","required",""],[4,"ngIf"],["matInput","","formControlName","password","required","",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"full-width","login-button",3,"disabled"],["diameter","20",4,"ngIf"],["diameter","20"]],template:function(n,t){if(n&1&&(a(0,"div",0)(1,"mat-card",1)(2,"mat-card-header")(3,"mat-card-title"),o(4,"Sistema de Gesti\xF3n de Carreteras"),r(),a(5,"mat-card-subtitle"),o(6,"Iniciar Sesi\xF3n"),r()(),a(7,"mat-card-content")(8,"form",2),A("ngSubmit",function(){return t.onSubmit()}),a(9,"mat-form-field",3)(10,"mat-label"),o(11,"Email"),r(),C(12,"input",4),I(13,gn,2,0,"mat-error",5)(14,un,2,0,"mat-error",5),r(),a(15,"mat-form-field",3)(16,"mat-label"),o(17,"Contrase\xF1a"),r(),C(18,"input",6),a(19,"button",7),A("click",function(){return t.hidePassword=!t.hidePassword}),a(20,"mat-icon"),o(21),r()(),I(22,hn,2,0,"mat-error",5),r(),a(23,"button",8),I(24,fn,1,0,"mat-spinner",9)(25,vn,2,0,"span",5),r()()()()()),n&2){let s,c,p;l(8),u("formGroup",t.loginForm),l(5),u("ngIf",(s=t.loginForm.get("email"))==null?null:s.hasError("required")),l(),u("ngIf",(c=t.loginForm.get("email"))==null?null:c.hasError("email")),l(4),u("type",t.hidePassword?"password":"text"),l(3),w(t.hidePassword?"visibility_off":"visibility"),l(),u("ngIf",(p=t.loginForm.get("password"))==null?null:p.hasError("required")),l(),u("disabled",t.loginForm.invalid||t.isLoading),l(),u("ngIf",t.isLoading),l(),u("ngIf",!t.isLoading)}},dependencies:[X,J,xt,ht,mt,gt,ut,bt,ft,vt,_e,ve,Ce,Pe,xe,be,yt,St,Pt,_t,Mt,Et,Ot,ee,Me,Q,ne,te,kt,wt,Dt],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:20px}.login-card[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:20px}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.login-button[_ngcontent-%COMP%]{height:48px;margin-top:16px}mat-card-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}"]})}}return i})();var en=(()=>{class i{constructor(e,n,t,s,c){this.supabase=e,this.directAuthService=n,this.evaluacionesService=t,this.evidenciaService=s,this.kpisService=c,this.statsSubject=new ke({totalEvaluaciones:0,evaluacionesCompletadas:0,evaluacionesPendientes:0,totalEvidencias:0,evidenciasEstesMes:0,evidenciasPorObra:{},promedioKPIs:0,kpisCriticos:0,tendenciaGeneral:"estable",actividadesCompletadas:0,actividadesTotales:0,actividadesEnProgreso:0,obrasActivas:0,progresoPromedio:0}),this.chartsSubject=new ke({evaluacionesPorMes:{labels:[],datasets:[]},evidenciasPorObra:{labels:[],datasets:[]},kpisPorCategoria:{labels:[],datasets:[]},progresoActividades:{labels:[],datasets:[]},tendenciaCalidad:{labels:[],datasets:[]}}),this.stats$=this.statsSubject.asObservable(),this.charts$=this.chartsSubject.asObservable()}loadDashboardData(){return f(this,null,function*(){try{if(!this.directAuthService.getCurrentUser())return;let[n,t]=yield Promise.all([this.loadDashboardStats(),this.loadDashboardCharts()]);this.statsSubject.next(n),this.chartsSubject.next(t)}catch(e){throw e}})}loadDashboardStats(){return f(this,null,function*(){try{let e=this.directAuthService.getCurrentUser(),n=this.directAuthService.getAccessToken();if(!e||!n)throw new Error("Usuario no autenticado");let{data:t}=yield this.supabase.client.from("user_obras").select("obra_id").eq("user_id",e.id),s=t?.map(v=>v.obra_id)||[];if(s.length===0)return this.getEmptyStats();let[c,p,g,m,b]=yield Promise.all([this.getEvaluacionesStats(),this.getEvidenciasStats(s),this.getKPIsStats(s),this.getActividadesStats(s),this.getObrasStats(s)]);return{totalEvaluaciones:c.totalEvaluaciones||0,evaluacionesCompletadas:c.evaluacionesCompletadas||0,evaluacionesPendientes:c.evaluacionesPendientes||0,totalEvidencias:p.totalEvidencias||0,evidenciasEstesMes:p.evidenciasEstesMes||0,evidenciasPorObra:p.evidenciasPorObra||{},promedioKPIs:g.promedioKPIs||0,kpisCriticos:g.kpisCriticos||0,tendenciaGeneral:g.tendenciaGeneral||"estable",actividadesCompletadas:m.actividadesCompletadas||0,actividadesTotales:m.actividadesTotales||0,actividadesEnProgreso:m.actividadesEnProgreso||0,obrasActivas:b.obrasActivas||0,progresoPromedio:b.progresoPromedio||0}}catch{return this.getEmptyStats()}})}getEvaluacionesStats(){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:n,error:t}=yield this.supabase.client.from("evaluaciones").select("id, estado, created_at");if(t)throw t;let s=n?.length||0,c=n?.filter(g=>g.estado==="completada"||g.estado==="aprobada").length||0,p=s-c;return{totalEvaluaciones:s,evaluacionesCompletadas:c,evaluacionesPendientes:p}}catch{return{totalEvaluaciones:0,evaluacionesCompletadas:0,evaluacionesPendientes:0}}})}getEvidenciasStats(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t}=yield this.supabase.client.from("actividades").select("id, obra_id").in("obra_id",e),s=t?.map(v=>v.id)||[];if(s.length===0)return{totalEvidencias:0,evidenciasEstesMes:0,evidenciasPorObra:{}};let{data:c,error:p}=yield this.supabase.client.from("evidencia_fotografica").select("id, actividad_id, created_at").in("actividad_id",s);if(p)throw p;let g=c?.length||0,m=new Date;m.setDate(1),m.setHours(0,0,0,0);let b=c?.filter(v=>new Date(v.created_at||"")>=m).length||0,h={};return t?.forEach(v=>{let S=v.obra_id,_=c?.filter(k=>k.actividad_id===v.id).length||0;h[S]=(h[S]||0)+_}),{totalEvidencias:g,evidenciasEstesMes:b,evidenciasPorObra:h}}catch{return{totalEvidencias:0,evidenciasEstesMes:0,evidenciasPorObra:{}}}})}getKPIsStats(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t,error:s}=yield this.supabase.client.from("kpis").select("avance_fisico, productividad, calidad, desviacion_cronograma, created_at").in("obra_id",e).gte("created_at",new Date(Date.now()-30*24*60*60*1e3).toISOString());if(s)throw s;if(console.log("KPIs stats data:",t),!t||t.length===0)return console.log("No KPIs found, returning empty stats"),{promedioKPIs:0,kpisCriticos:0,tendenciaGeneral:"estable"};let c=t.map(h=>{let v=[h.avance_fisico||0,h.productividad||0,h.calidad||0,100-(h.desviacion_cronograma||0)].filter(S=>S>0);return v.length>0?v.reduce((S,_)=>S+_,0)/v.length:0}),p=c.length>0?c.reduce((h,v)=>h+v,0)/c.length:0,g=c.filter(h=>h<70).length,m="estable";if(t.length>=4){let h=Math.floor(t.length/2),v=c.slice(0,h),S=c.slice(h),_=v.reduce((V,we)=>V+we,0)/v.length,F=S.reduce((V,we)=>V+we,0)/S.length-_;F>5?m="subiendo":F<-5&&(m="bajando")}let b={promedioKPIs:Math.round(p),kpisCriticos:g,tendenciaGeneral:m};return console.log("KPIs stats calculated:",b),b}catch(n){return console.error("Error obteniendo estad\xEDsticas de KPIs:",n),{promedioKPIs:0,kpisCriticos:0,tendenciaGeneral:"estable"}}})}getActividadesStats(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t,error:s}=yield this.supabase.client.from("actividades").select("id, estado, progreso_porcentaje").in("obra_id",e);if(s)throw s;let c=t?.length||0,p=t?.filter(m=>m.estado==="finalizado").length||0,g=t?.filter(m=>m.estado==="ejecucion").length||0;return console.log("\u{1F4CA} [DashboardService] Estad\xEDsticas de actividades:",{total:c,completadas:p,enProgreso:g,actividades:t?.map(m=>({estado:m.estado,progreso:m.progreso_porcentaje}))}),{actividadesTotales:c,actividadesCompletadas:p,actividadesEnProgreso:g}}catch(n){return console.error("\u274C [DashboardService] Error obteniendo estad\xEDsticas de actividades:",n),{actividadesTotales:0,actividadesCompletadas:0,actividadesEnProgreso:0}}})}getObrasStats(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t,error:s}=yield this.supabase.client.from("obras").select("id, estado, progreso").in("id",e);if(s)throw s;console.log("Obras stats data:",t);let c=t?.filter(m=>m.estado==="activa").length||0,p=t&&t.length>0?t.reduce((m,b)=>m+(b.progreso||0),0)/t.length:0,g={obrasActivas:c,progresoPromedio:Math.round(p)};return console.log("Obras stats calculated:",g),g}catch(n){return console.error("Error obteniendo estad\xEDsticas de obras:",n),{obrasActivas:0,progresoPromedio:0}}})}loadDashboardCharts(){return f(this,null,function*(){try{let e=this.directAuthService.getCurrentUser(),n=this.directAuthService.getAccessToken();if(!e||!n)throw new Error("Usuario no autenticado");let{data:t}=yield this.supabase.client.from("user_obras").select("obra_id").eq("user_id",e.id),s=t?.map(h=>h.obra_id)||[];if(s.length===0)return this.getEmptyCharts();let[c,p,g,m,b]=yield Promise.all([this.getEvaluacionesPorMesChart(),this.getEvidenciasPorObraChart(s),this.getKPIsPorCategoriaChart(s),this.getProgresoActividadesChart(s),this.getTendenciaCalidadChart(s)]);return{evaluacionesPorMes:c,evidenciasPorObra:p,kpisPorCategoria:g,progresoActividades:m,tendenciaCalidad:b}}catch{return this.getEmptyCharts()}})}getEvaluacionesPorMesChart(){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:n,error:t}=yield this.supabase.client.from("evaluaciones").select("created_at, estado").gte("created_at",new Date(Date.now()-6*30*24*60*60*1e3).toISOString());if(t)throw t;let s=[],c=[],p=[];for(let g=5;g>=0;g--){let m=new Date;m.setMonth(m.getMonth()-g);let b=m.toLocaleDateString("es-ES",{month:"short"});s.push(b);let h=new Date(m.getFullYear(),m.getMonth(),1),v=new Date(m.getFullYear(),m.getMonth()+1,0),S=n?.filter(F=>{let V=new Date(F.created_at||"");return V>=h&&V<=v})||[],_=S.filter(F=>F.estado==="completada"||F.estado==="aprobada").length,k=S.length-_;c.push(_),p.push(k)}return{labels:s,datasets:[{label:"Completadas",data:c,backgroundColor:"#4caf50",borderColor:"#4caf50",borderWidth:1},{label:"Pendientes",data:p,backgroundColor:"#ff9800",borderColor:"#ff9800",borderWidth:1}]}}catch{return this.getEmptyChart(["Ene","Feb","Mar","Abr","May","Jun"])}})}getEvidenciasPorObraChart(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t}=yield this.supabase.client.from("obras").select("id, nombre").in("id",e),{data:s}=yield this.supabase.client.from("actividades").select("id, obra_id").in("obra_id",e),c=s?.map(h=>h.id)||[];if(c.length===0){let h=t?.map(v=>v.nombre)||["Sin obras"];return this.getEmptyChart(h)}let{data:p}=yield this.supabase.client.from("evidencia_fotografica").select("actividad_id").in("actividad_id",c),g=[],m=[],b=["#2196f3","#4caf50","#ff9800","#f44336","#9c27b0","#00bcd4"];return t?.forEach((h,v)=>{g.push(h.nombre);let S=s?.filter(k=>k.obra_id===h.id)||[],_=p?.filter(k=>S.some(F=>F.id===k.actividad_id)).length||0;m.push(_)}),{labels:g,datasets:[{label:"Evidencias",data:m,backgroundColor:b.slice(0,g.length),borderWidth:1}]}}catch{return this.getEmptyChart(["Obra 1","Obra 2","Obra 3"])}})}getKPIsPorCategoriaChart(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t,error:s}=yield this.supabase.client.from("kpis").select("avance_fisico, productividad, calidad, desviacion_cronograma").in("obra_id",e).gte("created_at",new Date(Date.now()-30*24*60*60*1e3).toISOString());if(s)throw s;let c=["Avance F\xEDsico","Productividad","Calidad","Cronograma"];if(!t||t.length===0)return{labels:c,datasets:[{label:"Promedio (%)",data:[0,0,0,0],backgroundColor:["#2196f3","#4caf50","#ff9800","#f44336"],borderWidth:1}]};let p=t.reduce((h,v)=>h+(v.avance_fisico||0),0)/t.length,g=t.reduce((h,v)=>h+(v.productividad||0),0)/t.length,m=t.reduce((h,v)=>h+(v.calidad||0),0)/t.length,b=100-t.reduce((h,v)=>h+(v.desviacion_cronograma||0),0)/t.length;return{labels:c,datasets:[{label:"Promedio (%)",data:[Math.round(p),Math.round(g),Math.round(m),Math.round(b)],backgroundColor:["#2196f3","#4caf50","#ff9800","#f44336"],borderWidth:1}]}}catch{return this.getEmptyChart(["Avance F\xEDsico","Productividad","Calidad","Cronograma"])}})}getProgresoActividadesChart(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t,error:s}=yield this.supabase.client.from("actividades").select("estado").in("obra_id",e);if(s)throw s;let c=t?.filter(m=>m.estado==="finalizado").length||0,p=t?.filter(m=>m.estado==="ejecucion").length||0,g=t?.filter(m=>m.estado==="programado").length||0;return{labels:["Completadas","En Progreso","Pendientes"],datasets:[{data:[c,p,g],backgroundColor:["#4caf50","#2196f3","#ff9800"],borderWidth:2,borderColor:"#fff"}]}}catch{return{labels:["Completadas","En Progreso","Pendientes"],datasets:[{data:[0,0,0],backgroundColor:["#4caf50","#2196f3","#ff9800"],borderWidth:2,borderColor:"#fff"}]}}})}getTendenciaCalidadChart(e){return f(this,null,function*(){try{if(!this.directAuthService.getAccessToken())throw new Error("Token de autenticaci\xF3n no disponible");let{data:t,error:s}=yield this.supabase.client.from("kpis").select("calidad, created_at").in("obra_id",e).gte("created_at",new Date(Date.now()-30*24*60*60*1e3).toISOString()).order("created_at");if(s)throw s;let c=[],p=[];for(let g=6;g>=0;g--){let m=new Date;m.setDate(m.getDate()-g),c.push(m.toLocaleDateString("es-ES",{weekday:"short"}));let b=new Date(m);b.setHours(0,0,0,0);let h=new Date(m);h.setHours(23,59,59,999);let v=t?.filter(_=>{let k=new Date(_.created_at||"");return k>=b&&k<=h})||[],S=v.length>0?v.reduce((_,k)=>_+(k.calidad||0),0)/v.length:0;p.push(Math.round(S))}return{labels:c,datasets:[{label:"Calidad (%)",data:p,borderColor:"#2196f3",backgroundColor:"rgba(33, 150, 243, 0.1)",borderWidth:2,fill:!0,tension:.4}]}}catch{return{labels:["Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b","Dom"],datasets:[{label:"Calidad (%)",data:[0,0,0,0,0,0,0],borderColor:"#2196f3",backgroundColor:"rgba(33, 150, 243, 0.1)",borderWidth:2,fill:!0,tension:.4}]}}})}getEmptyStats(){return{totalEvaluaciones:0,evaluacionesCompletadas:0,evaluacionesPendientes:0,totalEvidencias:0,evidenciasEstesMes:0,evidenciasPorObra:{},promedioKPIs:0,kpisCriticos:0,tendenciaGeneral:"estable",actividadesCompletadas:0,actividadesTotales:0,actividadesEnProgreso:0,obrasActivas:0,progresoPromedio:0}}getEmptyCharts(){return{evaluacionesPorMes:this.getEmptyChart(["Ene","Feb","Mar","Abr","May","Jun"]),evidenciasPorObra:this.getEmptyChart(["Sin obras"]),kpisPorCategoria:this.getEmptyChart(["Avance F\xEDsico","Productividad","Calidad","Cronograma"]),progresoActividades:{labels:["Completadas","En Progreso","Pendientes"],datasets:[{data:[0,0,0],backgroundColor:["#4caf50","#2196f3","#ff9800"],borderWidth:2,borderColor:"#fff"}]},tendenciaCalidad:{labels:["Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b","Dom"],datasets:[{label:"Calidad (%)",data:[0,0,0,0,0,0,0],borderColor:"#2196f3",backgroundColor:"rgba(33, 150, 243, 0.1)",borderWidth:2,fill:!0,tension:.4}]}}}getEmptyChart(e){return{labels:e,datasets:[{label:"Sin datos",data:new Array(e.length).fill(0),backgroundColor:"#e0e0e0",borderColor:"#bdbdbd",borderWidth:1}]}}refreshDashboard(){return f(this,null,function*(){yield this.loadDashboardData()})}getCurrentStats(){return this.statsSubject.value}getCurrentCharts(){return this.chartsSubject.value}static{this.\u0275fac=function(n){return new(n||i)(O(Vt),O(D),O(Ht),O(Zt),O(Oe))}}static{this.\u0275prov=y({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function Pn(i,d){i&1&&(a(0,"div",17)(1,"mat-icon"),o(2,"check_circle"),r(),a(3,"span"),o(4,"No hay alertas activas"),r()())}function _n(i,d){if(i&1){let e=q();a(0,"div",18)(1,"div",19)(2,"div",20),o(3,"Alerta de KPI"),r(),a(4,"div",21),o(5),r(),a(6,"div",22),o(7),ue(8,"date"),r()(),a(9,"div",23)(10,"button",24),A("click",function(){let t=B(e).$implicit,s=E();return G(s.resolveAlert(t))}),a(11,"mat-icon"),o(12,"visibility"),r()(),a(13,"button",25),A("click",function(){let t=B(e).$implicit,s=E();return G(s.deleteAlert(t))}),a(14,"mat-icon"),o(15,"delete"),r()()()()}if(i&2){let e=d.$implicit;l(5),ge("Avance F\xEDsico: ",e.avance_fisico,"% | Calidad: ",e.calidad,"%"),l(2),w(he(8,3,e.fecha,"short"))}}function Mn(i,d){i&1&&C(0,"mat-divider")}function Sn(i,d){i&1&&(a(0,"div",26)(1,"span"),o(2,"Ver todas las alertas"),r()())}function yn(i,d){i&1&&(a(0,"div",27),C(1,"mat-progress-bar",28),a(2,"p"),o(3,"Cargando datos del dashboard..."),r()())}function On(i,d){if(i&1&&(a(0,"div",40)(1,"mat-card",41)(2,"mat-card-content")(3,"div",42)(4,"mat-icon"),o(5,"engineering"),r()(),a(6,"div",43)(7,"div",44),o(8),r(),a(9,"div",45),o(10,"Actividades de Campo"),r()()()(),a(11,"mat-card",46)(12,"mat-card-content")(13,"div",42)(14,"mat-icon"),o(15,"rate_review"),r()(),a(16,"div",43)(17,"div",44),o(18),r(),a(19,"div",45),o(20,"Evaluaciones Realizadas"),r()()()(),a(21,"mat-card",47)(22,"mat-card-content")(23,"div",42)(24,"mat-icon"),o(25,"construction"),r()(),a(26,"div",43)(27,"div",44),o(28),r(),a(29,"div",45),o(30,"Progreso de Obra"),r()()()(),a(31,"mat-card",48)(32,"mat-card-content")(33,"div",42)(34,"mat-icon"),o(35,"security"),r()(),a(36,"div",43)(37,"div",44),o(38),r(),a(39,"div",45),o(40,"Incidentes de Seguridad"),r()()()()()),i&2){let e=E(2);l(8),w(e.stats.actividadesCampo),l(10),w(e.stats.evaluacionesPersonal),l(10),P("",e.stats.progresoObra,"%"),l(10),w(e.stats.incidentesSeguridad)}}function En(i,d){if(i&1&&(a(0,"div",40)(1,"mat-card",41)(2,"mat-card-content")(3,"div",42)(4,"mat-icon"),o(5,"business"),r()(),a(6,"div",43)(7,"div",44),o(8),r(),a(9,"div",45),o(10,"Obras Activas"),r()()()(),a(11,"mat-card",46)(12,"mat-card-content")(13,"div",42)(14,"mat-icon"),o(15,"attach_money"),r()(),a(16,"div",43)(17,"div",44),o(18),ue(19,"number"),r(),a(20,"div",45),o(21,"Presupuesto Ejecutado"),r()()()(),a(22,"mat-card",47)(23,"mat-card-content")(24,"div",42)(25,"mat-icon"),o(26,"inventory"),r()(),a(27,"div",43)(28,"div",44),o(29),r(),a(30,"div",45),o(31,"Recursos Asignados"),r()()()(),a(32,"mat-card",48)(33,"mat-card-content")(34,"div",42)(35,"mat-icon"),o(36,"schedule"),r()(),a(37,"div",43)(38,"div",44),o(39),r(),a(40,"div",45),o(41,"Proyectos Retrasados"),r()()()()()),i&2){let e=E(2);l(8),w(e.stats.obrasActivas),l(10),P("$",he(19,4,e.stats.presupuestoEjecutado,"1.0-0"),""),l(11),w(e.stats.recursosAsignados),l(10),w(e.stats.proyectosRetrasados)}}function wn(i,d){i&1&&(a(0,"div",49)(1,"mat-card",50)(2,"mat-card-header")(3,"mat-card-title"),o(4,"Actividades de Campo"),r(),a(5,"mat-card-subtitle"),o(6,"Estado de actividades en terreno"),r()(),a(7,"mat-card-content")(8,"div",51),C(9,"canvas",52),r()()(),a(10,"mat-card",50)(11,"mat-card-header")(12,"mat-card-title"),o(13,"Evaluaciones de Personal"),r(),a(14,"mat-card-subtitle"),o(15,"Desempe\xF1o del equipo de trabajo"),r()(),a(16,"mat-card-content")(17,"div",51),C(18,"canvas",53),r()()(),a(19,"mat-card",54)(20,"mat-card-header")(21,"mat-card-title"),o(22,"Progreso Semanal de Obra"),r(),a(23,"mat-card-subtitle"),o(24,"Avance de construcci\xF3n por semana"),r()(),a(25,"mat-card-content")(26,"div",51),C(27,"canvas",55),r()()()())}function kn(i,d){i&1&&(a(0,"div",49)(1,"mat-card",50)(2,"mat-card-header")(3,"mat-card-title"),o(4,"Estado de Actividades"),r(),a(5,"mat-card-subtitle"),o(6,"Distribuci\xF3n por estado de actividades"),r()(),a(7,"mat-card-content")(8,"div",51),C(9,"canvas",56),r()()(),a(10,"mat-card",50)(11,"mat-card-header")(12,"mat-card-title"),o(13,"An\xE1lisis de Costos"),r(),a(14,"mat-card-subtitle"),o(15,"Presupuesto vs Ejecutado"),r()(),a(16,"mat-card-content")(17,"div",51),C(18,"canvas",57),r()()(),a(19,"mat-card",54)(20,"mat-card-header")(21,"mat-card-title"),o(22,"Cronograma de Proyectos"),r(),a(23,"mat-card-subtitle"),o(24,"Planificaci\xF3n vs Ejecuci\xF3n mensual"),r()(),a(25,"mat-card-content")(26,"div",51),C(27,"canvas",58),r()()()())}function In(i,d){if(i&1&&(a(0,"mat-card",59)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Indicadores de Campo"),r(),a(4,"mat-card-subtitle"),o(5,"KPIs relevantes para actividades de obra"),r()(),a(6,"mat-card-content")(7,"div",60)(8,"div",61)(9,"div",62)(10,"mat-icon",63),o(11,"verified"),r(),a(12,"span",64),o(13,"Calidad de Obra"),r()(),a(14,"div",65)(15,"span",66),o(16),r(),a(17,"mat-icon",67),o(18),r()(),a(19,"div",68),C(20,"mat-progress-bar",69),r()(),a(21,"div",61)(22,"div",62)(23,"mat-icon",63),o(24,"security"),r(),a(25,"span",64),o(26,"Seguridad"),r()(),a(27,"div",65)(28,"span",66),o(29),r(),a(30,"mat-icon",67),o(31),r()(),a(32,"div",68),C(33,"mat-progress-bar",69),r()(),a(34,"div",61)(35,"div",62)(36,"mat-icon",63),o(37,"speed"),r(),a(38,"span",64),o(39,"Productividad"),r()(),a(40,"div",65)(41,"span",66),o(42),r(),a(43,"mat-icon",67),o(44),r()(),a(45,"div",68),C(46,"mat-progress-bar",69),r()(),a(47,"div",61)(48,"div",62)(49,"mat-icon",63),o(50,"schedule"),r(),a(51,"span",64),o(52,"Cumplimiento"),r()(),a(53,"div",65)(54,"span",66),o(55),r(),a(56,"mat-icon",67),o(57),r()(),a(58,"div",68),C(59,"mat-progress-bar",69),r()()()()()),i&2){let e=E(2);l(16),P("",e.dashboardKPIs.calidad.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.calidad.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.calidad.tendencia)," "),l(2),u("value",e.dashboardKPIs.calidad.promedio)("color",e.getProgressColor(e.dashboardKPIs.calidad.promedio)),l(9),P("",e.dashboardKPIs.seguridad.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.seguridad.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.seguridad.tendencia)," "),l(2),u("value",e.dashboardKPIs.seguridad.promedio)("color",e.getProgressColor(e.dashboardKPIs.seguridad.promedio)),l(9),P("",e.dashboardKPIs.rendimiento.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.rendimiento.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.rendimiento.tendencia)," "),l(2),u("value",e.dashboardKPIs.rendimiento.promedio)("color",e.getProgressColor(e.dashboardKPIs.rendimiento.promedio)),l(9),P("",e.dashboardKPIs.tiempo.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.tiempo.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.tiempo.tendencia)," "),l(2),u("value",e.dashboardKPIs.tiempo.promedio)("color",e.getProgressColor(e.dashboardKPIs.tiempo.promedio))}}function Dn(i,d){if(i&1&&(a(0,"mat-card",59)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Indicadores de Gesti\xF3n"),r(),a(4,"mat-card-subtitle"),o(5,"KPIs relevantes para planificaci\xF3n y recursos"),r()(),a(6,"mat-card-content")(7,"div",60)(8,"div",61)(9,"div",62)(10,"mat-icon",63),o(11,"attach_money"),r(),a(12,"span",64),o(13,"Control de Costos"),r()(),a(14,"div",65)(15,"span",66),o(16),r(),a(17,"mat-icon",67),o(18),r()(),a(19,"div",68),C(20,"mat-progress-bar",69),r()(),a(21,"div",61)(22,"div",62)(23,"mat-icon",63),o(24,"schedule"),r(),a(25,"span",64),o(26,"Cronograma"),r()(),a(27,"div",65)(28,"span",66),o(29),r(),a(30,"mat-icon",67),o(31),r()(),a(32,"div",68),C(33,"mat-progress-bar",69),r()(),a(34,"div",61)(35,"div",62)(36,"mat-icon",63),o(37,"speed"),r(),a(38,"span",64),o(39,"Eficiencia"),r()(),a(40,"div",65)(41,"span",66),o(42),r(),a(43,"mat-icon",67),o(44),r()(),a(45,"div",68),C(46,"mat-progress-bar",69),r()(),a(47,"div",61)(48,"div",62)(49,"mat-icon",63),o(50,"inventory"),r(),a(51,"span",64),o(52,"Recursos"),r()(),a(53,"div",65)(54,"span",66),o(55),r(),a(56,"mat-icon",67),o(57),r()(),a(58,"div",68),C(59,"mat-progress-bar",69),r()()()()()),i&2){let e=E(2);l(16),P("",e.dashboardKPIs.costo.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.costo.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.costo.tendencia)," "),l(2),u("value",e.dashboardKPIs.costo.promedio)("color",e.getProgressColor(e.dashboardKPIs.costo.promedio)),l(9),P("",e.dashboardKPIs.tiempo.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.tiempo.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.tiempo.tendencia)," "),l(2),u("value",e.dashboardKPIs.tiempo.promedio)("color",e.getProgressColor(e.dashboardKPIs.tiempo.promedio)),l(9),P("",e.dashboardKPIs.rendimiento.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.rendimiento.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.rendimiento.tendencia)," "),l(2),u("value",e.dashboardKPIs.rendimiento.promedio)("color",e.getProgressColor(e.dashboardKPIs.rendimiento.promedio)),l(9),P("",e.dashboardKPIs.calidad.promedio,"%"),l(),L("trend-"+e.dashboardKPIs.calidad.tendencia),l(),P(" ",e.getTrendIcon(e.dashboardKPIs.calidad.tendencia)," "),l(2),u("value",e.dashboardKPIs.calidad.promedio)("color",e.getProgressColor(e.dashboardKPIs.calidad.promedio))}}function An(i,d){i&1&&(a(0,"mat-card",70)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Acciones de Campo"),r(),a(4,"mat-card-subtitle"),o(5,"Funciones para actividades de obra"),r()(),a(6,"mat-card-content")(7,"div",71)(8,"button",72)(9,"mat-icon"),o(10,"add_task"),r(),a(11,"span"),o(12,"Registrar Actividad"),r()(),a(13,"button",73)(14,"mat-icon"),o(15,"assessment"),r(),a(16,"span"),o(17,"Evaluar Personal"),r()(),a(18,"button",74)(19,"mat-icon"),o(20,"map"),r(),a(21,"span"),o(22,"Ubicar Frentes"),r()(),a(23,"button",75)(24,"mat-icon"),o(25,"analytics"),r(),a(26,"span"),o(27,"Reportes de Obra"),r()(),a(28,"button",76)(29,"mat-icon"),o(30,"camera_alt"),r(),a(31,"span"),o(32,"Subir Evidencias"),r()(),a(33,"button",77)(34,"mat-icon"),o(35,"security"),r(),a(36,"span"),o(37,"Control Seguridad"),r()(),a(38,"button",78)(39,"mat-icon"),o(40,"straighten"),r(),a(41,"span"),o(42,"Vista Kilom\xE9trica"),r()()()()())}function Tn(i,d){i&1&&(a(0,"mat-card",70)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Acciones de Gesti\xF3n"),r(),a(4,"mat-card-subtitle"),o(5,"Funciones para planificaci\xF3n y control"),r()(),a(6,"mat-card-content")(7,"div",71)(8,"button",79)(9,"mat-icon"),o(10,"business"),r(),a(11,"span"),o(12,"Gestionar Obras"),r()(),a(13,"button",80)(14,"mat-icon"),o(15,"analytics"),r(),a(16,"span"),o(17,"An\xE1lisis de Costos"),r()(),a(18,"button",81)(19,"mat-icon"),o(20,"schedule"),r(),a(21,"span"),o(22,"Planificaci\xF3n"),r()(),a(23,"button",82)(24,"mat-icon"),o(25,"map"),r(),a(26,"span"),o(27,"Vista General"),r()(),a(28,"button",75)(29,"mat-icon"),o(30,"inventory"),r(),a(31,"span"),o(32,"Control Recursos"),r()(),a(33,"button",83)(34,"mat-icon"),o(35,"trending_up"),r(),a(36,"span"),o(37,"KPIs Globales"),r()(),a(38,"button",78)(39,"mat-icon"),o(40,"straighten"),r(),a(41,"span"),o(42,"Vista Kilom\xE9trica"),r()()()()())}function Rn(i,d){if(i&1){let e=q();a(0,"div",88)(1,"div",89)(2,"mat-icon",90),o(3,"warning"),r()(),a(4,"div",19)(5,"div",20),o(6),r(),a(7,"div",21),o(8),r(),a(9,"div",91)(10,"span",22),o(11),ue(12,"date"),r(),a(13,"mat-chip",92),o(14," Revisar "),r()()(),a(15,"div",93)(16,"button",24),A("click",function(){let t=B(e).$implicit,s=E(3);return G(s.resolveAlert(t))}),a(17,"mat-icon"),o(18,"visibility"),r()(),a(19,"button",25),A("click",function(){let t=B(e).$implicit,s=E(3);return G(s.deleteAlert(t))}),a(20,"mat-icon"),o(21,"delete"),r()()()()}if(i&2){let e=d.$implicit;l(6),w(e.obra_nombre||"KPI de Obra"),l(2),Xe("Avance: ",e.avance_fisico,"% | Productividad: ",e.productividad,"% | Calidad: ",e.calidad,"%"),l(3),w(he(12,5,e.fecha,"short"))}}function Fn(i,d){if(i&1&&(a(0,"div",94)(1,"button",95),o(2),a(3,"mat-icon"),o(4,"arrow_forward"),r()()()),i&2){let e=E(3);l(2),P(" Ver todas las alertas (",e.alertas.length,") ")}}function zn(i,d){if(i&1&&(a(0,"mat-card",84)(1,"mat-card-header")(2,"mat-card-title"),o(3,"Alertas Recientes"),r(),a(4,"mat-card-subtitle"),o(5,"Requieren tu atenci\xF3n"),r()(),a(6,"mat-card-content")(7,"div",85),I(8,Rn,22,8,"div",86),r(),I(9,Fn,5,1,"div",87),r()()),i&2){let e=E(2);l(8),u("ngForOf",e.alertas.slice(0,3)),l(),u("ngIf",e.alertas.length>3)}}function Ln(i,d){if(i&1&&(a(0,"div",29),I(1,On,41,4,"div",30)(2,En,42,7,"div",30),a(3,"mat-card",31)(4,"mat-card-header")(5,"mat-card-title"),o(6,"Progreso General del Proyecto"),r()(),a(7,"mat-card-content")(8,"div",32)(9,"div",33),o(10),r(),a(11,"div",34),o(12),r()(),C(13,"mat-progress-bar",35),r()(),I(14,wn,28,0,"div",36)(15,kn,28,0,"div",36)(16,In,60,24,"mat-card",37)(17,Dn,60,24,"mat-card",37)(18,An,43,0,"mat-card",38)(19,Tn,43,0,"mat-card",38)(20,zn,10,2,"mat-card",39),r()),i&2){let e=E();l(),u("ngIf",(e.userProfile==null?null:e.userProfile.rol)==="residente"),l(),u("ngIf",(e.userProfile==null?null:e.userProfile.rol)==="logistica"),l(8),P("",e.getOverallProgress(),"%"),l(2),ge(" ",e.stats.actividadesCompletadas," de ",e.stats.totalActividades," actividades completadas "),l(),u("value",e.getOverallProgress())("color",e.getProgressColor()),l(),u("ngIf",(e.userProfile==null?null:e.userProfile.rol)==="residente"),l(),u("ngIf",(e.userProfile==null?null:e.userProfile.rol)==="logistica"),l(),u("ngIf",e.dashboardKPIs&&(e.userProfile==null?null:e.userProfile.rol)==="residente"),l(),u("ngIf",e.dashboardKPIs&&(e.userProfile==null?null:e.userProfile.rol)==="logistica"),l(),u("ngIf",(e.userProfile==null?null:e.userProfile.rol)==="residente"),l(),u("ngIf",(e.userProfile==null?null:e.userProfile.rol)==="logistica"),l(),u("ngIf",e.alertas.length>0)}}R.register(...Wt);var tn=(()=>{class i{constructor(e,n,t,s,c,p){this.directAuthService=e,this.kpisService=n,this.actividadesService=t,this.dashboardService=s,this.cdr=c,this.ngZone=p,this.destroy$=new $,this.isLoading=!0,this.currentUser=null,this.userProfile=null,this.stats={totalActividades:0,actividadesCompletadas:0,actividadesEnProgreso:0,progresoPromedio:0,alertasActivas:0,kpisCriticos:0},this.dashboardKPIs=null,this.alertas=[],this.progressChart=null,this.kpiChart=null,this.activityChart=null,this.costChart=null,this.planificacionChart=null,this.campoChart=null,this.evaluacionChart=null,this.obrasChart=null,this.progressChartData={labels:[],datasets:[]},this.kpiChartData={labels:[],datasets:[]},this.activityChartData={labels:[],datasets:[]},this.costChartData={labels:[],datasets:[]},this.planificacionChartData={labels:[],datasets:[]}}ngOnInit(){return f(this,null,function*(){console.log("\u{1F680} [DashboardComponent] Inicializando dashboard...");try{this.isLoading=!0,this.cdr.detectChanges(),yield this.loadDataWithErrorHandling(),this.runDebugDiagnostic().catch(e=>{console.warn("\u26A0\uFE0F [DashboardComponent] Diagn\xF3stico fall\xF3, continuando:",e)}),this.ngZone.run(()=>{this.isLoading=!1,this.cdr.detectChanges()}),setTimeout(()=>{this.ngZone.run(()=>{this.initializeCharts(),this.cdr.detectChanges()})},500)}catch(e){console.error("\u274C [DashboardComponent] Error cr\xEDtico inicializando dashboard:",e),this.ngZone.run(()=>{this.isLoading=!1,this.loadFallbackData(),this.cdr.detectChanges(),setTimeout(()=>this.initializeCharts(),500)})}this.directAuthService.isAuthenticated()&&(console.log("\u2705 [Dashboard] Usuario autenticado, inicializando servicios..."),yield this.initializeServices())})}initializeServices(){return f(this,null,function*(){try{console.log("\u{1F527} [Dashboard] Inicializando servicio KpisService..."),yield this.kpisService.initialize(),console.log("\u2705 [Dashboard] Servicio KpisService inicializado correctamente"),this.loadDashboardDataSafely()}catch(e){console.error("\u274C [Dashboard] Error inicializando servicio KpisService:",e),this.loadDashboardDataSafely()}this.refreshKPIsData(),this.runDebugDiagnostic()})}runDebugDiagnostic(){return f(this,null,function*(){try{console.log("\u{1F527} [DASHBOARD] Ejecutando diagn\xF3stico de debug..."),yield this.actividadesService.debugUserData()}catch(e){console.error("\u274C [DASHBOARD] Error en diagn\xF3stico:",e)}})}refreshKPIsData(){return f(this,null,function*(){try{console.log("\u{1F504} Refrescando datos de KPIs desde Supabase..."),yield this.kpisService.refresh(),console.log("\u2705 Datos de KPIs actualizados correctamente")}catch(e){console.error("\u274C Error refrescando datos de KPIs:",e)}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.destroyCharts()}loadUserDataSafely(){return f(this,null,function*(){try{console.log("\u{1F464} [DashboardComponent] Cargando datos del usuario...");let e=this.directAuthService.getCurrentUser();if(e){this.ngZone.run(()=>{this.currentUser=e,this.cdr.detectChanges()}),console.log("\u2705 [DashboardComponent] Usuario actual cargado:",e.email);let n=this.directAuthService.getCurrentProfile();n?(this.ngZone.run(()=>{this.userProfile=n,this.cdr.detectChanges()}),console.log("\u2705 [DashboardComponent] Perfil del usuario cargado:",n.rol),this.loadRoleSpecificData()):(console.warn("\u26A0\uFE0F [DashboardComponent] No se pudo cargar el perfil del usuario"),this.loadFallbackUserData())}else console.warn("\u26A0\uFE0F [DashboardComponent] No hay usuario autenticado - usando datos por defecto"),this.loadFallbackUserData()}catch(e){console.error("\u274C [DashboardComponent] Error cargando datos del usuario:",e),this.loadFallbackUserData()}})}loadDataWithErrorHandling(){return f(this,null,function*(){let e=[this.loadUserDataSafely(),this.loadRealDashboardDataSafely()];(yield Promise.allSettled(e)).forEach((t,s)=>{t.status==="rejected"&&console.warn(`\u26A0\uFE0F [DashboardComponent] Error cargando ${s===0?"datos de usuario":"datos del dashboard"}:`,t.reason)})})}loadRealDashboardDataSafely(){return f(this,null,function*(){try{console.log("\u{1F4CA} [Dashboard] Cargando datos reales del dashboard..."),yield this.dashboardService.loadDashboardData(),this.dashboardService.stats$.subscribe({next:e=>{this.ngZone.run(()=>{this.updateStatsFromService(e),this.cdr.detectChanges()})},error:e=>{console.error("\u274C [DashboardComponent] Error en stats$:",e),this.loadFallbackStats()}}),this.dashboardService.charts$.subscribe({next:e=>{this.ngZone.run(()=>{console.log("\u{1F4C8} [Dashboard] Datos de gr\xE1ficos recibidos:",e),this.updateChartsFromService(e),setTimeout(()=>this.initializeCharts(),100),this.cdr.detectChanges()})},error:e=>{console.error("\u274C [DashboardComponent] Error en charts$:",e),this.loadFallbackCharts(),setTimeout(()=>this.initializeCharts(),100)}}),console.log("\u2705 [Dashboard] Datos reales del dashboard cargados")}catch(e){console.error("\u274C [Dashboard] Error cargando datos reales del dashboard:",e),yield this.loadDashboardDataSafely()}})}loadDashboardDataSafely(){return f(this,null,function*(){try{this.kpisService.isServiceInitialized()?console.log("\u2705 [Dashboard] Servicio ya inicializado, suscribiendo a datos..."):(console.warn("\u26A0\uFE0F [Dashboard] Servicio KpisService no est\xE1 inicializado, esperando..."),yield this.kpisService.initialize().then(()=>{console.log("\u2705 [Dashboard] Servicio inicializado, cargando datos...")}).catch(e=>{throw console.error("\u274C [Dashboard] Error en inicializaci\xF3n tard\xEDa:",e),e})),this.kpisService.dashboardKPIs$.pipe(De(this.destroy$)).subscribe({next:e=>{this.dashboardKPIs=e,this.updateStats(),this.updateCharts()},error:e=>{console.error("\u274C [Dashboard] Error en dashboardKPIs$:",e),this.loadFallbackStats()}}),this.kpisService.alertas$.pipe(De(this.destroy$)).subscribe({next:e=>{this.alertas=e,this.stats.alertasActivas=e.length},error:e=>{console.error("\u274C [Dashboard] Error en alertas$:",e),this.alertas=[],this.stats.alertasActivas=0}}),yield this.loadActivityStatsSafely()}catch(e){throw this.loadFallbackData(),e}})}loadRoleSpecificData(){if(!this.userProfile?.rol){console.warn("\u26A0\uFE0F [DashboardComponent] No se puede cargar datos espec\xEDficos del rol: perfil no disponible");return}console.log("\u{1F4CB} [DashboardComponent] Cargando datos espec\xEDficos para el rol:",this.userProfile.rol)}loadActivityStatsSafely(){return f(this,null,function*(){try{console.log("\u{1F50D} [DASHBOARD] Iniciando carga de estad\xEDsticas de actividades..."),console.log("\u{1F50D} [DASHBOARD] Estado del observable actividades$:",this.actividadesService.actividades$);let e=yield this.actividadesService.actividades$.pipe(z(1)).toPromise();console.log("\u{1F50D} [DASHBOARD] Actividades recibidas del observable:",e),console.log("\u{1F50D} [DASHBOARD] Tipo de datos:",typeof e),console.log("\u{1F50D} [DASHBOARD] Es array:",Array.isArray(e)),console.log("\u{1F50D} [DASHBOARD] Longitud:",e?e.length:"null/undefined"),e?(this.stats.totalActividades=e.length,this.stats.actividadesCompletadas=e.filter(n=>n.estado==="finalizado").length,this.stats.actividadesEnProgreso=e.filter(n=>n.estado==="ejecucion").length,console.log("\u{1F50D} [DASHBOARD] Estad\xEDsticas calculadas:",{total:this.stats.totalActividades,completadas:this.stats.actividadesCompletadas,enProgreso:this.stats.actividadesEnProgreso}),e.length>0&&(this.stats.progresoPromedio=Math.round(this.stats.actividadesCompletadas/e.length*100),console.log("\u{1F50D} [DASHBOARD] Progreso promedio calculado:",this.stats.progresoPromedio+"%"))):(console.warn("\u26A0\uFE0F [DASHBOARD] No se recibieron actividades del observable"),this.loadFallbackActivityStats())}catch(e){console.error("\u274C [DASHBOARD] Error loading activity stats:",e),this.loadFallbackActivityStats()}})}loadFallbackData(){console.log("\u{1F504} [Dashboard] Cargando datos de respaldo..."),this.loadFallbackUserData(),this.loadFallbackStats(),this.loadFallbackCharts()}loadFallbackUserData(){this.currentUser={email:"usuario@ejemplo.com"},this.userProfile={rol:"residente",nombre:"Usuario"}}loadFallbackStats(){this.stats={totalActividades:0,actividadesCompletadas:0,actividadesEnProgreso:0,progresoPromedio:0,alertasActivas:0,kpisCriticos:0,actividadesCampo:0,evaluacionesPersonal:0,progresoObra:0,incidentesSeguridad:0}}loadFallbackActivityStats(){this.stats.totalActividades=0,this.stats.actividadesCompletadas=0,this.stats.actividadesEnProgreso=0,this.stats.progresoPromedio=0}loadFallbackCharts(){this.progressChartData={labels:["Sin datos"],datasets:[]},this.kpiChartData={labels:["Sin datos"],datasets:[]},this.activityChartData={labels:["Sin datos"],datasets:[]},this.costChartData={labels:["Sin datos"],datasets:[]},this.planificacionChartData={labels:["Sin datos"],datasets:[]}}updateStats(){this.dashboardKPIs?(this.stats.kpisCriticos=this.dashboardKPIs.rendimiento.criticos+this.dashboardKPIs.calidad.criticos+this.dashboardKPIs.seguridad.criticos+this.dashboardKPIs.costo.criticos+this.dashboardKPIs.tiempo.criticos,console.log("\u{1F4CA} Estad\xEDsticas actualizadas con datos reales:",{kpisCriticos:this.stats.kpisCriticos,alertasActivas:this.stats.alertasActivas,rendimiento:this.dashboardKPIs.rendimiento.promedio,calidad:this.dashboardKPIs.calidad.promedio})):(console.warn("\u26A0\uFE0F No hay datos de KPIs disponibles en la base de datos"),console.log("\u{1F4A1} Esto puede ocurrir si:"),console.log("   - No hay obras asignadas al usuario"),console.log("   - No hay actividades registradas en las obras"),console.log("   - Los KPIs autom\xE1ticos a\xFAn no se han calculado"),this.stats.kpisCriticos=0,console.log("\u{1F4CA} Estad\xEDsticas inicializadas con valores por defecto:",this.stats))}initializeCharts(){return f(this,null,function*(){console.log("\u{1F4CA} [Dashboard] Inicializando gr\xE1ficos..."),this.destroyCharts(),setTimeout(()=>f(this,null,function*(){try{this.userProfile?.rol==="residente"?(this.createCampoChart(),this.createEvaluacionChart(),yield this.createProgressChart()):this.userProfile?.rol==="logistica"&&(this.createObrasChart(),this.createCostChart(),this.createPlanificacionChart()),console.log("\u2705 [Dashboard] Gr\xE1ficos inicializados correctamente")}catch(e){console.error("\u274C [Dashboard] Error inicializando gr\xE1ficos:",e)}}),100)})}updateCharts(){return f(this,null,function*(){console.log("\u{1F504} [Dashboard] Actualizando gr\xE1ficos..."),yield this.initializeCharts()})}createProgressChart(){return f(this,null,function*(){let e=document.getElementById("progresoChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas progresoChart no encontrado");return}this.progressChart&&this.progressChart.destroy();let n=e.getContext("2d");if(!n)return;let t=yield this.getProgresoSemanalData();t.labels.length||(t=yield this.generateProgressFromActivities()),this.progressChart=new R(n,{type:"line",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(s){return s+"%"}}}},plugins:{legend:{display:!0,position:"top"},tooltip:{callbacks:{label:function(s){return`${s.dataset.label}: ${s.parsed.y}%`}}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de progreso semanal creado con datos reales")})}getProgresoSemanalData(){return f(this,null,function*(){try{return this.progressChartData&&this.progressChartData.labels.length>0?this.progressChartData:yield this.generateProgressFromActivities()}catch(e){return console.error("\u274C [Dashboard] Error obteniendo datos de progreso semanal:",e),yield this.generateProgressFromActivities()}})}generateProgressFromActivities(){return f(this,null,function*(){try{let e=yield this.actividadesService.actividades$.pipe(z(1)).toPromise();if(!e||e.length===0)return{labels:["Sin datos"],datasets:[{label:"Progreso de Obra (%)",data:[0],borderColor:"#4caf50",backgroundColor:"rgba(76, 175, 80, 0.1)",borderWidth:3,fill:!0,tension:.4}]};let n=[],t=[],s=new Date;for(let c=7;c>=0;c--){let p=new Date(s);p.setDate(s.getDate()-c*7);let g=new Date(p);g.setDate(p.getDate()-p.getDay()),g.setHours(0,0,0,0);let m=new Date(g);m.setDate(g.getDate()+6),m.setHours(23,59,59,999);let b=`Sem ${8-c}`;n.push(b);let h=e.filter(_=>new Date(_.fecha_fin||_.updated_at||_.created_at)<=m),v=h.filter(_=>_.estado==="finalizado").length,S=h.length>0?Math.round(v/e.length*100):0;t.push(S)}return{labels:n,datasets:[{label:"Progreso de Obra (%)",data:t,borderColor:"#4caf50",backgroundColor:"rgba(76, 175, 80, 0.1)",borderWidth:3,fill:!0,tension:.4}]}}catch(e){console.error("\u274C [Dashboard] Error generando progreso desde actividades:",e);let n=this.getOverallProgress(),t=["Sem 1","Sem 2","Sem 3","Sem 4","Sem 5","Sem 6","Sem 7","Sem 8"],s=[];for(let c=0;c<8;c++){let p=Math.round(n/8*(c+1));s.push(Math.min(p,n))}return{labels:t,datasets:[{label:"Progreso de Obra (%)",data:s,borderColor:"#4caf50",backgroundColor:"rgba(76, 175, 80, 0.1)",borderWidth:3,fill:!0,tension:.4}]}}})}createKPIChart(){let e=document.getElementById("kpiChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas kpiChart no encontrado");return}this.kpiChart&&this.kpiChart.destroy();let n=e.getContext("2d");if(!n)return;let t=this.kpiChartData;if(!t.labels.length){let s=["Calidad","Tiempo","Costo","Seguridad"],c=[85,78,92,88],p=["#4caf50","#2196f3","#ff9800","#f44336"];t={labels:s,datasets:[{label:"KPI (%)",data:c,backgroundColor:p,borderColor:p,borderWidth:1}]}}this.kpiChart=new R(n,{type:"doughnut",data:t,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de KPIs creado")}createActivityChart(){let e=document.getElementById("actividadesChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas actividadesChart no encontrado");return}this.activityChart&&this.activityChart.destroy();let n=e.getContext("2d");if(!n)return;let t=this.activityChartData;t.labels.length||(t={labels:["Ene","Feb","Mar","Abr","May","Jun"],datasets:[{label:"Completadas",data:[12,18,25,32,28,35],backgroundColor:"#4caf50",borderColor:"#4caf50",borderWidth:1},{label:"Pendientes",data:[8,12,15,18,22,15],backgroundColor:"#ff9800",borderColor:"#ff9800",borderWidth:1}]}),this.activityChart=new R(n,{type:"bar",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0}},plugins:{legend:{position:"top",labels:{padding:20,usePointStyle:!0}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de actividades creado")}createCostChart(){let e=document.getElementById("costosChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas costosChart no encontrado");return}this.costChart&&this.costChart.destroy();let n=e.getContext("2d");if(!n)return;let t=this.costChartData;t.labels.length||(t={labels:["Ene","Feb","Mar","Abr","May","Jun"],datasets:[{label:"Presupuestado",data:[85e4,92e4,11e5,125e4,14e5,155e4],backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1},{label:"Ejecutado",data:[78e4,89e4,105e4,118e4,132e4,148e4],backgroundColor:"rgba(255, 99, 132, 0.6)",borderColor:"rgba(255, 99, 132, 1)",borderWidth:1}]}),this.costChart=new R(n,{type:"bar",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(s){return"$"+(Number(s)/1e3).toFixed(0)+"K"}}}},plugins:{legend:{position:"top",labels:{padding:20,usePointStyle:!0}},tooltip:{callbacks:{label:function(s){return s.dataset.label+": $"+s.parsed.y.toLocaleString()}}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de costos creado")}createPlanificacionChart(){let e=document.getElementById("planificacionChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas planificacionChart no encontrado");return}this.planificacionChart&&this.planificacionChart.destroy();let n=e.getContext("2d");if(!n)return;let t=this.planificacionChartData;t.labels.length||(t={labels:["Ene","Feb","Mar","Abr","May","Jun"],datasets:[{label:"Avance Planificado",data:[15,28,42,58,75,90],borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",borderWidth:2,fill:!1,tension:.4},{label:"Avance Real",data:[12,25,38,52,68,85],borderColor:"rgba(255, 159, 64, 1)",backgroundColor:"rgba(255, 159, 64, 0.2)",borderWidth:2,fill:!1,tension:.4}]}),this.planificacionChart=new R(n,{type:"line",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100,ticks:{callback:function(s){return s+"%"}}}},plugins:{legend:{position:"top",labels:{padding:20,usePointStyle:!0}},tooltip:{callbacks:{label:function(s){return s.dataset.label+": "+s.parsed.y+"%"}}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de planificaci\xF3n creado")}createCampoChart(){let e=document.getElementById("campoChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas campoChart no encontrado");return}this.campoChart&&this.campoChart.destroy();let n=e.getContext("2d");if(!n)return;let t={labels:["Excavaci\xF3n","Cimentaci\xF3n","Estructura","Acabados"],datasets:[{label:"Actividades Completadas",data:[12,8,15,6],backgroundColor:["rgba(76, 175, 80, 0.8)","rgba(33, 150, 243, 0.8)","rgba(255, 152, 0, 0.8)","rgba(156, 39, 176, 0.8)"],borderColor:["rgba(76, 175, 80, 1)","rgba(33, 150, 243, 1)","rgba(255, 152, 0, 1)","rgba(156, 39, 176, 1)"],borderWidth:2}]};this.campoChart=new R(n,{type:"doughnut",data:t,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0}},tooltip:{callbacks:{label:function(s){return s.label+": "+s.parsed+" actividades"}}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de campo creado")}createEvaluacionChart(){let e=document.getElementById("evaluacionChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas evaluacionChart no encontrado");return}this.evaluacionChart&&this.evaluacionChart.destroy();let n=e.getContext("2d");if(!n)return;let t={labels:["Excelente","Bueno","Regular","Deficiente"],datasets:[{label:"Evaluaciones",data:[25,45,20,10],backgroundColor:["rgba(76, 175, 80, 0.8)","rgba(33, 150, 243, 0.8)","rgba(255, 193, 7, 0.8)","rgba(244, 67, 54, 0.8)"],borderColor:["rgba(76, 175, 80, 1)","rgba(33, 150, 243, 1)","rgba(255, 193, 7, 1)","rgba(244, 67, 54, 1)"],borderWidth:2}]};this.evaluacionChart=new R(n,{type:"bar",data:t,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,ticks:{callback:function(s){return s+"%"}}}},plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(s){return s.label+": "+s.parsed.y+"%"}}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de evaluaciones creado")}createObrasChart(){let e=document.getElementById("obrasChart");if(!e){console.warn("\u26A0\uFE0F [Dashboard] Canvas obrasChart no encontrado");return}this.obrasChart&&this.obrasChart.destroy();let n=e.getContext("2d");if(!n)return;let t={labels:["En Progreso","Completadas","Pausadas","Planificadas"],datasets:[{label:"Actividades",data:[8,12,3,5],backgroundColor:["rgba(33, 150, 243, 0.8)","rgba(76, 175, 80, 0.8)","rgba(255, 193, 7, 0.8)","rgba(156, 39, 176, 0.8)"],borderColor:["rgba(33, 150, 243, 1)","rgba(76, 175, 80, 1)","rgba(255, 193, 7, 1)","rgba(156, 39, 176, 1)"],borderWidth:2}]};this.obrasChart=new R(n,{type:"pie",data:t,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0}},tooltip:{callbacks:{label:function(s){return s.label+": "+s.parsed+" actividades"}}}}}}),console.log("\u2705 [Dashboard] Gr\xE1fico de actividades creado")}destroyCharts(){this.progressChart&&(this.progressChart.destroy(),this.progressChart=null),this.kpiChart&&(this.kpiChart.destroy(),this.kpiChart=null),this.activityChart&&(this.activityChart.destroy(),this.activityChart=null),this.costChart&&(this.costChart.destroy(),this.costChart=null),this.planificacionChart&&(this.planificacionChart.destroy(),this.planificacionChart=null),this.campoChart&&(this.campoChart.destroy(),this.campoChart=null),this.evaluacionChart&&(this.evaluacionChart.destroy(),this.evaluacionChart=null),this.obrasChart&&(this.obrasChart.destroy(),this.obrasChart=null)}getStatusColor(e){switch(e){case"excelente":return"success";case"normal":return"primary";case"alerta":return"warn";case"critico":return"danger";default:return"primary"}}getStatusIcon(e){switch(e){case"excelente":return"trending_up";case"normal":return"trending_flat";case"alerta":return"warning";case"critico":return"error";default:return"info"}}getGreeting(){let e=new Date().getHours();return e<12?"Buenos d\xEDas":e<18?"Buenas tardes":"Buenas noches"}refreshData(){return f(this,null,function*(){try{this.isLoading=!0,yield this.dashboardService.refreshDashboard(),yield this.refreshKPIsData()}catch{yield this.loadDashboardDataSafely()}finally{this.isLoading=!1}})}navigateToSection(e){console.log("Navigating to:",e)}resolveAlert(e){console.log("Resolving alert:",e)}deleteAlert(e){console.log("Deleting alert:",e),this.alertas=this.alertas.filter(n=>n!==e),this.stats.alertasActivas=this.alertas.length}getOverallProgress(){return this.stats.totalActividades===0?0:Math.round(this.stats.actividadesCompletadas/this.stats.totalActividades*100)}getProgressColor(e){let n=e!==void 0?e:this.getOverallProgress();return n>=80?"primary":n>=60?"accent":"warn"}updateStatsFromService(e){this.stats={totalActividades:e.actividadesTotales||0,actividadesCompletadas:e.actividadesCompletadas||0,actividadesEnProgreso:e.actividadesEnProgreso||0,progresoPromedio:e.progresoPromedio||0,alertasActivas:0,kpisCriticos:e.kpisCriticos||0,actividadesCampo:e.actividadesTotales||0,evaluacionesPersonal:e.totalEvaluaciones||0,progresoObra:Math.round(e.progresoPromedio||0),incidentesSeguridad:0,obrasActivas:e.obrasActivas||0,presupuestoEjecutado:0,recursosAsignados:0,proyectosRetrasados:0},console.log("\u{1F4CA} Estad\xEDsticas actualizadas desde servicio:",this.stats)}updateChartsFromService(e){this.activityChartData=e.evaluacionesPorMes,this.costChartData=e.evidenciasPorObra,this.kpiChartData=e.kpisPorCategoria,this.progressChartData=e.progresoActividades,this.planificacionChartData=e.tendenciaCalidad,this.ngZone.runOutsideAngular(()=>{setTimeout(()=>f(this,null,function*(){this.ngZone.run(()=>f(this,null,function*(){this.destroyCharts(),this.createActivityChart(),this.createCostChart(),this.createKPIChart(),yield this.createProgressChart(),this.createPlanificacionChart(),this.cdr.detectChanges()}))}),200)}),console.log("\u{1F4C8} Gr\xE1ficos actualizados desde servicio")}getTrendIcon(e){switch(e){case"subiendo":return"trending_up";case"bajando":return"trending_down";case"estable":return"trending_flat";default:return"trending_flat"}}static{this.\u0275fac=function(n){return new(n||i)(M(D),M(Oe),M($t),M(en),M(Y),M(T))}}static{this.\u0275cmp=Z({type:i,selectors:[["app-dashboard"]],decls:26,vars:13,consts:[["alertMenu","matMenu"],[1,"dashboard-container"],[1,"dashboard-header"],[1,"welcome-section"],[1,"welcome-title"],[1,"welcome-subtitle"],[1,"header-actions"],["mat-icon-button","","matTooltip","Actualizar datos",3,"click"],["mat-icon-button","","matBadgeColor","warn","matTooltip","Alertas",3,"matMenuTriggerFor","matBadge","matBadgeHidden"],[1,"alert-menu"],["mat-menu-item","","disabled","",1,"alert-header"],["mat-menu-item","","disabled","","class","no-alerts",4,"ngIf"],["mat-menu-item","","class","alert-item",4,"ngFor","ngForOf"],[4,"ngIf"],["mat-menu-item","","routerLink","/alertas",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","dashboard-content",4,"ngIf"],["mat-menu-item","","disabled","",1,"no-alerts"],["mat-menu-item","",1,"alert-item"],[1,"alert-content"],[1,"alert-title"],[1,"alert-description"],[1,"alert-time"],[1,"alert-menu-actions"],["mat-icon-button","","matTooltip","Ver detalles",3,"click"],["mat-icon-button","","matTooltip","Eliminar alerta","color","warn",3,"click"],["mat-menu-item","","routerLink","/alertas"],[1,"loading-container"],["mode","indeterminate"],[1,"dashboard-content"],["class","stats-grid",4,"ngIf"],[1,"progress-card"],[1,"progress-info"],[1,"progress-value"],[1,"progress-description"],[1,"progress-bar",3,"value","color"],["class","charts-grid",4,"ngIf"],["class","kpis-card",4,"ngIf"],["class","actions-card",4,"ngIf"],["class","alerts-card",4,"ngIf"],[1,"stats-grid"],[1,"stat-card","primary"],[1,"stat-icon"],[1,"stat-info"],[1,"stat-value"],[1,"stat-label"],[1,"stat-card","success"],[1,"stat-card","info"],[1,"stat-card","warning"],[1,"charts-grid"],[1,"chart-card"],[1,"chart-container"],["id","campoChart"],["id","evaluacionChart"],[1,"chart-card","full-width"],["id","progresoChart"],["id","obrasChart"],["id","costosChart"],["id","planificacionChart"],[1,"kpis-card"],[1,"kpis-grid"],[1,"kpi-item"],[1,"kpi-header"],[1,"kpi-icon"],[1,"kpi-title"],[1,"kpi-value"],[1,"value"],[1,"trend-icon"],[1,"kpi-progress"],["mode","determinate",3,"value","color"],[1,"actions-card"],[1,"actions-grid"],["mat-raised-button","","color","primary","routerLink","/actividades",1,"action-button"],["mat-raised-button","","color","accent","routerLink","/evaluaciones",1,"action-button"],["mat-raised-button","","color","warn","routerLink","/mapa",1,"action-button"],["mat-raised-button","","routerLink","/reportes",1,"action-button"],["mat-raised-button","","routerLink","/actividades",1,"action-button"],["mat-raised-button","","routerLink","/evaluaciones",1,"action-button"],["mat-raised-button","","routerLink","/dashboard-kilometrico",1,"action-button"],["mat-raised-button","","color","primary","routerLink","/obras",1,"action-button"],["mat-raised-button","","color","accent","routerLink","/reportes",1,"action-button"],["mat-raised-button","","color","warn","routerLink","/actividades",1,"action-button"],["mat-raised-button","","routerLink","/mapa",1,"action-button"],["mat-raised-button","","routerLink","/obras",1,"action-button"],[1,"alerts-card"],[1,"alerts-list"],["class","alert-item-card",4,"ngFor","ngForOf"],["class","alerts-footer",4,"ngIf"],[1,"alert-item-card"],[1,"alert-icon"],[1,"alert-warning"],[1,"alert-meta"],["color","warn","selected","","size","small"],[1,"alert-actions"],[1,"alerts-footer"],["mat-button","","routerLink","/alertas"]],template:function(n,t){if(n&1){let s=q();a(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1",4),o(4),r(),a(5,"p",5),o(6),r()(),a(7,"div",6)(8,"button",7),A("click",function(){return B(s),G(t.refreshData())}),a(9,"mat-icon"),o(10,"refresh"),r()(),a(11,"button",8)(12,"mat-icon"),o(13,"notifications"),r()(),a(14,"mat-menu",9,0)(16,"div",10)(17,"strong"),o(18),r()(),C(19,"mat-divider"),I(20,Pn,5,0,"div",11)(21,_n,16,6,"div",12)(22,Mn,1,0,"mat-divider",13)(23,Sn,3,0,"div",14),r()()(),I(24,yn,4,0,"div",15)(25,Ln,21,14,"div",16),r()}if(n&2){let s=Je(15);l(4),ge(" ",t.getGreeting(),", ",(t.userProfile==null?null:t.userProfile.nombre)||(t.currentUser==null?null:t.currentUser.email)||"Usuario"," "),l(2),P(" ",(t.userProfile==null?null:t.userProfile.rol)==="residente"?"Residente de Obra":"Produccion"," "),l(5),u("matMenuTriggerFor",s)("matBadge",t.alertas.length)("matBadgeHidden",t.alertas.length===0),l(7),P("Alertas Activas (",t.alertas.length,")"),l(2),u("ngIf",t.alertas.length===0),l(),u("ngForOf",t.alertas.slice(0,5)),l(),u("ngIf",t.alertas.length>0),l(),u("ngIf",t.alertas.length>5),l(),u("ngIf",t.isLoading),l(),u("ngIf",!t.isLoading)}},dependencies:[X,tt,J,at,nt,_e,ve,Ce,Pe,xe,be,ee,Me,Q,ne,te,Tt,At,Ft,Rt,Lt,zt,Ut,Kt,jt,Nt,ye,Se,Gt,Bt,pt,fe],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:24px;background-color:#f8f9fa;min-height:100vh}.dashboard-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;background:#fff;color:#1e3a8a;padding:24px;border-radius:12px;box-shadow:0 4px 20px #0000001a;border:1px solid #e5e7eb}.welcome-section[_ngcontent-%COMP%]{flex:1}.welcome-title[_ngcontent-%COMP%]{font-size:28px;font-weight:600;margin:0 0 8px;text-shadow:0 2px 4px rgba(0,0,0,.2)}.welcome-subtitle[_ngcontent-%COMP%]{font-size:16px;opacity:.9;margin:0;font-weight:300}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#1e3a8a}.alert-menu[_ngcontent-%COMP%]{max-width:400px}.alert-header[_ngcontent-%COMP%]{padding:16px!important;font-weight:600;color:#333}.no-alerts[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#666;padding:16px!important}.alert-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:12px 16px!important;border-bottom:1px solid #eee}.alert-title[_ngcontent-%COMP%]{font-weight:600;font-size:14px;margin-bottom:4px}.alert-description[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-bottom:4px}.alert-time[_ngcontent-%COMP%]{font-size:11px;color:#999}.resolve-btn[_ngcontent-%COMP%]{width:24px;height:24px;line-height:24px}.alert-menu-actions[_ngcontent-%COMP%]{display:flex;gap:4px}.alert-menu-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#666;transition:color .3s ease}.alert-menu-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#2196f3}.alert-menu-actions[_ngcontent-%COMP%]   button[color=warn][_ngcontent-%COMP%]:hover{color:#f44336}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:48px}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666}.dashboard-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px}.stat-card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease;cursor:pointer}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 25px #00000026}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:20px!important}.stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:12px;display:flex;align-items:center;justify-content:center;flex-shrink:0}.stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px;color:#fff}.stat-info[_ngcontent-%COMP%]{flex:1}.stat-value[_ngcontent-%COMP%]{font-size:32px;font-weight:700;line-height:1;margin-bottom:4px}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#666;font-weight:500}.stat-card.primary[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#1e3a8a}.stat-card.primary[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#1e3a8a}.stat-card.success[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#059669}.stat-card.success[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#059669}.stat-card.info[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#0284c7}.stat-card.info[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#0284c7}.stat-card.warning[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#dc2626}.stat-card.warning[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{color:#dc2626}.progress-card[_ngcontent-%COMP%]{background:#fff;color:#1e3a8a;border:1px solid #e5e7eb}.progress-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{color:#1e3a8a}.progress-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{color:#1e3a8a!important;font-size:20px;font-weight:600}.progress-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.progress-value[_ngcontent-%COMP%]{font-size:48px;font-weight:700;line-height:1}.progress-description[_ngcontent-%COMP%]{font-size:14px;opacity:.9;text-align:right}.progress-bar[_ngcontent-%COMP%]{height:8px;border-radius:4px;background-color:#e5e7eb}.charts-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,minmax(300px,1fr));gap:24px}.chart-card[_ngcontent-%COMP%]{overflow:hidden;transition:all .3s ease}.chart-card.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:20px!important;overflow:hidden}.chart-container[_ngcontent-%COMP%]{position:relative;height:350px;width:100%;min-height:250px;max-height:500px;overflow:hidden}.kpis-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px}.kpi-item[_ngcontent-%COMP%]{padding:20px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;transition:all .2s ease;box-shadow:0 1px 3px #0000001a}.kpi-item[_ngcontent-%COMP%]:hover{background:#f8f9fa;border-color:#1e3a8a;box-shadow:0 4px 6px #0000001a}.kpi-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.kpi-name[_ngcontent-%COMP%]{font-weight:600;font-size:16px}.kpi-values[_ngcontent-%COMP%]{margin-bottom:12px}.kpi-current[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#1e3a8a;margin-bottom:4px}.kpi-target[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.kpi-progress[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.kpi-progress[_ngcontent-%COMP%]   mat-progress-bar[_ngcontent-%COMP%]{flex:1;height:6px;border-radius:3px}.kpi-percentage[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#666;min-width:40px;text-align:right}.actions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px}.action-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:20px 16px!important;height:auto!important;min-height:80px;border-radius:12px!important;transition:all .2s ease}.action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 6px 20px #00000026}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:28px;width:28px;height:28px}.action-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;font-weight:500;text-align:center}.alerts-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.alert-item-card[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px;padding:16px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;transition:all .2s ease}.alert-item-card[_ngcontent-%COMP%]:hover{background:#f8f9fa;border-color:#1e3a8a}.alert-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.alert-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:#fff}.alert-critico[_ngcontent-%COMP%]   .alert-icon[_ngcontent-%COMP%]{background-color:#f44336}.alert-alerta[_ngcontent-%COMP%]   .alert-icon[_ngcontent-%COMP%]{background-color:#ff9800}.alert-normal[_ngcontent-%COMP%]   .alert-icon[_ngcontent-%COMP%]{background-color:#4caf50}.alert-content[_ngcontent-%COMP%]{flex:1}.alert-title[_ngcontent-%COMP%]{font-weight:600;font-size:16px;margin-bottom:4px;color:#333}.alert-description[_ngcontent-%COMP%]{font-size:14px;color:#666;margin-bottom:8px;line-height:1.4}.alert-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.alert-time[_ngcontent-%COMP%]{font-size:12px;color:#999}.alert-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.alerts-footer[_ngcontent-%COMP%]{margin-top:16px;text-align:center;border-top:1px solid #e5e7eb;padding-top:16px}.alerts-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.mat-mdc-card[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a!important;border-radius:12px!important}.mat-mdc-progress-bar[_ngcontent-%COMP%]{--mdc-linear-progress-track-height: 6px}mat-card[_ngcontent-%COMP%]{border-radius:12px!important;box-shadow:0 2px 12px #00000014!important;transition:all .2s ease}mat-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 20px #0000001f!important}mat-card-header[_ngcontent-%COMP%]{padding-bottom:16px!important}mat-card-title[_ngcontent-%COMP%]{font-size:18px!important;font-weight:600!important;color:#1e3a8a!important}mat-card-subtitle[_ngcontent-%COMP%]{font-size:14px!important;color:#6b7280!important;margin-top:4px!important}@media (max-width: 1024px) and (min-width: 769px){.charts-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px}.chart-container[_ngcontent-%COMP%]{height:320px;min-height:220px;max-height:400px}.chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:18px!important}}@media (max-width: 768px){.dashboard-container[_ngcontent-%COMP%]{padding:16px;overflow-x:hidden}.dashboard-header[_ngcontent-%COMP%]{flex-direction:column;gap:16px;text-align:center;padding:20px 16px;margin-bottom:24px}.header-actions[_ngcontent-%COMP%]{justify-content:center;flex-wrap:wrap}.welcome-title[_ngcontent-%COMP%]{font-size:22px}.welcome-subtitle[_ngcontent-%COMP%]{font-size:14px}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px!important}.stat-icon[_ngcontent-%COMP%]{width:50px;height:50px}.stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.stat-value[_ngcontent-%COMP%]{font-size:28px}.stat-label[_ngcontent-%COMP%]{font-size:13px}.charts-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}.chart-container[_ngcontent-%COMP%]{height:280px;min-height:200px;max-height:320px}.chart-card[_ngcontent-%COMP%]{margin-bottom:12px}.chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px!important}.kpis-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.kpi-item[_ngcontent-%COMP%]{padding:16px}.actions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:12px}.action-btn[_ngcontent-%COMP%]{padding:16px 12px!important;min-height:70px}.progress-info[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:12px}.progress-value[_ngcontent-%COMP%]{font-size:40px}.progress-description[_ngcontent-%COMP%]{text-align:center;font-size:13px}}@media (max-width: 480px){.dashboard-container[_ngcontent-%COMP%]{padding:12px;overflow-x:hidden}.dashboard-header[_ngcontent-%COMP%]{padding:16px 12px;margin-bottom:20px}.welcome-title[_ngcontent-%COMP%]{font-size:20px}.welcome-subtitle[_ngcontent-%COMP%]{font-size:13px}.header-actions[_ngcontent-%COMP%]{gap:8px}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:14px!important;gap:12px}.stat-icon[_ngcontent-%COMP%]{width:45px;height:45px}.stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.stat-value[_ngcontent-%COMP%]{font-size:24px}.stat-label[_ngcontent-%COMP%]{font-size:12px}.charts-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.chart-container[_ngcontent-%COMP%]{height:250px;min-height:180px;max-height:300px}.chart-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:12px!important}.chart-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:16px!important}.kpis-grid[_ngcontent-%COMP%]{gap:12px}.kpi-item[_ngcontent-%COMP%]{padding:14px}.kpi-name[_ngcontent-%COMP%]{font-size:14px}.kpi-current[_ngcontent-%COMP%]{font-size:20px}.kpi-target[_ngcontent-%COMP%]{font-size:11px}.actions-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:10px}.action-btn[_ngcontent-%COMP%]{padding:14px 10px!important;min-height:60px}.action-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.action-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:13px}.progress-value[_ngcontent-%COMP%]{font-size:36px}.progress-description[_ngcontent-%COMP%]{font-size:12px}.alert-item-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center;padding:12px}.alert-meta[_ngcontent-%COMP%]{justify-content:center}.alert-title[_ngcontent-%COMP%]{font-size:14px}.alert-description[_ngcontent-%COMP%]{font-size:12px}button[_ngcontent-%COMP%]{min-height:44px}*[_ngcontent-%COMP%]{max-width:100%;box-sizing:border-box}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.dashboard-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .6s ease-out}.dashboard-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(1){animation-delay:.1s}.dashboard-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.dashboard-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(3){animation-delay:.3s}.dashboard-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(4){animation-delay:.4s}.dashboard-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]:nth-child(5){animation-delay:.5s}"]})}}return i})();var x=(()=>{class i{constructor(e,n){this.directAuthService=e,this.router=n}canActivate(e,n){try{return this.directAuthService.getCurrentUser()?!0:(console.log("\u{1F512} Usuario no autenticado, redirigiendo al login con returnUrl:",n.url),this.router.navigate(["/login"],{queryParams:{returnUrl:n.url}}),!1)}catch(t){return console.error("Error en DirectAuthGuard:",t),this.router.navigate(["/login"],{queryParams:{returnUrl:n.url}}),!1}}static{this.\u0275fac=function(n){return new(n||i)(O(D),O(W))}}static{this.\u0275prov=y({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Fe=(()=>{class i{constructor(e,n){this.directAuthService=e,this.router=n}canActivate(e){let n=e.data.roles,t=this.directAuthService.getCurrentProfile();return t?n&&!n.includes(t.rol)?(this.router.navigate(["/unauthorized"]),new K(s=>{s.next(!1),s.complete()})):new K(s=>{s.next(!0),s.complete()}):(this.router.navigate(["/login"]),new K(s=>{s.next(!1),s.complete()}))}static{this.\u0275fac=function(n){return new(n||i)(O(D),O(W))}}static{this.\u0275prov=y({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var nn=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",component:Qt,title:"Sistema de Gesti\xF3n - Iniciar Sesi\xF3n"},{path:"register",loadComponent:()=>import("./chunk-DQFMA7ZA.js").then(i=>i.RegisterComponent),title:"Registro - Sistema de Gesti\xF3n"},{path:"dashboard",component:tn,canActivate:[x],title:"Dashboard - Sistema de Gesti\xF3n de Rendimiento"},{path:"main",loadComponent:()=>import("./chunk-HJ6XTLCC.js").then(i=>i.MainComponent),canActivate:[x,Fe],data:{roles:["residente"]},title:"Generador de Reportes por Partida"},{path:"actividades",loadComponent:()=>import("./chunk-SMFCG5KK.js").then(i=>i.ActividadesComponent),canActivate:[x],title:"Registro de Actividades"},{path:"actividades/nueva",loadComponent:()=>import("./chunk-FZDMM67G.js").then(i=>i.NuevaActividadComponent),canActivate:[x],title:"Nueva Actividad"},{path:"actividades/editar/:id",loadComponent:()=>import("./chunk-K6PACVY4.js").then(i=>i.EditarActividadComponent),canActivate:[x],title:"Editar Actividad"},{path:"actividades/:id",loadComponent:()=>import("./chunk-ZQ6U6ITH.js").then(i=>i.DetalleActividadComponent),canActivate:[x],title:"Detalle de Actividad"},{path:"mapa",loadComponent:()=>import("./chunk-L3WUZZE4.js").then(i=>i.MapaComponent),canActivate:[x],title:"Mapa de Frentes"},{path:"frentes",loadComponent:()=>import("./chunk-L3WUZZE4.js").then(i=>i.MapaComponent),canActivate:[x],title:"Gesti\xF3n de Frentes"},{path:"frentes/nuevo",loadComponent:()=>import("./chunk-CRWWTXYS.js").then(i=>i.FrenteFormComponent),canActivate:[x],title:"Crear Nuevo Frente"},{path:"frentes/:id/editar",loadComponent:()=>import("./chunk-QU22C2HJ.js").then(i=>i.FrenteEditComponent),canActivate:[x],title:"Editar Frente"},{path:"evaluaciones",loadComponent:()=>import("./chunk-PS33EJKQ.js").then(i=>i.EvaluacionesComponent),canActivate:[x],title:"Evaluaciones de Personal"},{path:"evaluaciones/nueva",loadComponent:()=>import("./chunk-T2KY3ZIT.js").then(i=>i.NuevaEvaluacionComponent),canActivate:[x],title:"Nueva Evaluaci\xF3n"},{path:"reportes",loadComponent:()=>import("./chunk-32QDIVQN.js").then(i=>i.ReportesComponent),canActivate:[x],title:"Reportes y Analytics"},{path:"reportes/exportar",loadComponent:()=>import("./chunk-W52WM7QW.js").then(i=>i.ExportarComponent),canActivate:[x],title:"Exportar Reportes"},{path:"generation",loadComponent:()=>import("./chunk-YST44EGI.js").then(i=>i.GenerationComponent),canActivate:[x],title:"Generaci\xF3n de Reportes"},{path:"partidas",loadComponent:()=>import("./chunk-5OBC5JZL.js").then(i=>i.AdminItemsComponent),canActivate:[x],title:"Administraci\xF3n de Partidas"},{path:"obras",loadComponent:()=>import("./chunk-RAZBOQFM.js").then(i=>i.ObrasComponent),canActivate:[x],title:"Gesti\xF3n de Obras"},{path:"obras/:id",loadComponent:()=>import("./chunk-SXLD26VT.js").then(i=>i.DetalleObraComponent),canActivate:[x],title:"Configuraci\xF3n de Obra"},{path:"perfil",loadComponent:()=>import("./chunk-NBR25TN2.js").then(i=>i.PerfilComponent),canActivate:[x],title:"Perfil de Usuario"},{path:"usuarios",loadComponent:()=>import("./chunk-NRUEPM4D.js").then(i=>i.UsuariosComponent),canActivate:[x],title:"Gesti\xF3n de Usuarios"},{path:"usuarios/crear",loadComponent:()=>import("./chunk-ADYD5H7P.js").then(i=>i.CrearUsuarioComponent),canActivate:[x],title:"Crear Usuario"},{path:"usuarios/editar/:id",loadComponent:()=>import("./chunk-R4POFNIF.js").then(i=>i.EditarUsuarioComponent),canActivate:[x],title:"Editar Usuario"},{path:"kpis",loadComponent:()=>import("./chunk-2DBWFB7A.js").then(i=>i.KpisComponent),canActivate:[x],title:"Gesti\xF3n de KPIs"},{path:"dashboard-kilometrico",loadComponent:()=>import("./chunk-WRKVAITU.js").then(i=>i.DashboardKilometricoComponent),canActivate:[x]},{path:"admin-projects",loadComponent:()=>import("./chunk-O3JHD5W3.js").then(i=>i.AdminProjectsComponent),canActivate:[x,Fe],data:{roles:["administrador","logistica"]},title:"Administraci\xF3n de Obras"},{path:"configuracion",loadComponent:()=>import("./chunk-WUUDVGUH.js").then(i=>i.ConfigurationComponent),canActivate:[x],title:"Configuraci\xF3n"},{path:"**",redirectTo:"/dashboard",pathMatch:"full"}];var jn="@",Kn=(()=>{class i{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=U(me);loadingSchedulerFn=U(Nn,{optional:!0});_engine;constructor(e,n,t,s,c){this.doc=e,this.delegate=n,this.zone=t,this.animationType=s,this.moduleImpl=c}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-5JM7Y6DQ.js").then(t=>t),n;return this.loadingSchedulerFn?n=this.loadingSchedulerFn(e):n=e(),n.catch(t=>{throw new N(5300,!1)}).then(({\u0275createEngine:t,\u0275AnimationRendererFactory:s})=>{this._engine=t(this.animationType,this.doc);let c=new s(this.delegate,this._engine,this.zone);return this.delegate=c,c})}createRenderer(e,n){let t=this.delegate.createRenderer(e,n);if(t.\u0275type===0)return t;typeof t.throwOnSyntheticProps=="boolean"&&(t.throwOnSyntheticProps=!1);let s=new ze(t);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(c=>{let p=c.createRenderer(e,n);s.use(p),this.scheduler??=this.injector.get(Ve,null,{optional:!0}),this.scheduler?.notify(10)}).catch(c=>{s.use(t)}),s}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(e){this._engine?.flush(),this.delegate.componentReplaced?.(e)}static \u0275fac=function(n){qe()};static \u0275prov=y({token:i,factory:i.\u0275fac})}return i})(),ze=class{delegate;replay=[];\u0275type=1;constructor(d){this.delegate=d}use(d){if(this.delegate=d,this.replay!==null){for(let e of this.replay)e(d);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(d,e){return this.delegate.createElement(d,e)}createComment(d){return this.delegate.createComment(d)}createText(d){return this.delegate.createText(d)}get destroyNode(){return this.delegate.destroyNode}appendChild(d,e){this.delegate.appendChild(d,e)}insertBefore(d,e,n,t){this.delegate.insertBefore(d,e,n,t)}removeChild(d,e,n){this.delegate.removeChild(d,e,n)}selectRootElement(d,e){return this.delegate.selectRootElement(d,e)}parentNode(d){return this.delegate.parentNode(d)}nextSibling(d){return this.delegate.nextSibling(d)}setAttribute(d,e,n,t){this.delegate.setAttribute(d,e,n,t)}removeAttribute(d,e,n){this.delegate.removeAttribute(d,e,n)}addClass(d,e){this.delegate.addClass(d,e)}removeClass(d,e){this.delegate.removeClass(d,e)}setStyle(d,e,n,t){this.delegate.setStyle(d,e,n,t)}removeStyle(d,e,n){this.delegate.removeStyle(d,e,n)}setProperty(d,e,n){this.shouldReplay(e)&&this.replay.push(t=>t.setProperty(d,e,n)),this.delegate.setProperty(d,e,n)}setValue(d,e){this.delegate.setValue(d,e)}listen(d,e,n,t){return this.shouldReplay(e)&&this.replay.push(s=>s.listen(d,e,n,t)),this.delegate.listen(d,e,n,t)}shouldReplay(d){return this.replay!==null&&d.startsWith(jn)}},Nn=new le("");function an(i="animations"){return He("NgAsyncAnimations"),pe([{provide:Ze,useFactory:(d,e,n)=>new Kn(d,e,n,i),deps:[et,it,T]},{provide:$e,useValue:i==="noop"?"NoopAnimations":"BrowserAnimations"}])}var Le="Service workers are disabled or not supported by this browser",ae=class{serviceWorker;worker;registration;events;constructor(d,e){if(this.serviceWorker=d,!d)this.worker=this.events=this.registration=new K(n=>n.error(new N(5601,!1)));else{let n=null,t=new $;this.worker=new K(m=>(n!==null&&m.next(n),t.subscribe(b=>m.next(b))));let s=()=>{let{controller:m}=d;m!==null&&(n=m,t.next(n))};d.addEventListener("controllerchange",s),s(),this.registration=this.worker.pipe(oe(()=>d.getRegistration()));let c=new $;this.events=c.asObservable();let p=m=>{let{data:b}=m;b?.type&&c.next(b)};d.addEventListener("message",p),e?.get(Ae,null,{optional:!0})?.onDestroy(()=>{d.removeEventListener("controllerchange",s),d.removeEventListener("message",p)})}}postMessage(d,e){return new Promise(n=>{this.worker.pipe(z(1)).subscribe(t=>{t.postMessage(je({action:d},e)),n()})})}postMessageWithOperation(d,e,n){let t=this.waitForOperationCompleted(n),s=this.postMessage(d,e);return Promise.all([s,t]).then(([,c])=>c)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(d){let e;return typeof d=="string"?e=n=>n.type===d:e=n=>d.includes(n.type),this.events.pipe(Ie(e))}nextEventOfType(d){return this.eventsOfType(d).pipe(z(1))}waitForOperationCompleted(d){return new Promise((e,n)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(Ie(t=>t.nonce===d),z(1),re(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).subscribe({next:e,error:n})})}get isEnabled(){return!!this.serviceWorker}},Un=(()=>{class i{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new $;constructor(e){if(this.sw=e,!e.isEnabled){this.messages=H,this.notificationClicks=H,this.subscription=H;return}this.messages=this.sw.eventsOfType("PUSH").pipe(re(t=>t.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(re(t=>t.data)),this.pushManager=this.sw.registration.pipe(re(t=>t.pushManager));let n=this.pushManager.pipe(oe(t=>t.getSubscription()));this.subscription=new K(t=>{let s=n.subscribe(t),c=this.subscriptionChanges.subscribe(t);return()=>{s.unsubscribe(),c.unsubscribe()}})}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(Le));let n={userVisibleOnly:!0},t=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(t.length));for(let c=0;c<t.length;c++)s[c]=t.charCodeAt(c);return n.applicationServerKey=s,new Promise((c,p)=>{this.pushManager.pipe(oe(g=>g.subscribe(n)),z(1)).subscribe({next:g=>{this.subscriptionChanges.next(g),c(g)},error:p})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(Le));let e=n=>{if(n===null)throw new N(5602,!1);return n.unsubscribe().then(t=>{if(!t)throw new N(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((n,t)=>{this.subscription.pipe(z(1),oe(e)).subscribe({next:n,error:t})})}decodeBase64(e){return atob(e)}static \u0275fac=function(n){return new(n||i)(O(ae))};static \u0275prov=y({token:i,factory:i.\u0275fac})}return i})(),Bn=(()=>{class i{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=H,this.unrecoverable=H;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Le));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new N(5601,!1));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static \u0275fac=function(n){return new(n||i)(O(ae))};static \u0275prov=y({token:i,factory:i.\u0275fac})}return i})();var on=new le("");function Gn(){let i=U(ce);if(!("serviceWorker"in navigator&&i.enabled!==!1))return;let d=U(on),e=U(T),n=U(Ae);e.runOutsideAngular(()=>{let t=navigator.serviceWorker,s=()=>t.controller?.postMessage({action:"INITIALIZE"});t.addEventListener("controllerchange",s),n.onDestroy(()=>{t.removeEventListener("controllerchange",s)})}),e.runOutsideAngular(()=>{let t,{registrationStrategy:s}=i;if(typeof s=="function")t=new Promise(c=>s().subscribe(()=>c()));else{let[c,...p]=(s||"registerWhenStable:30000").split(":");switch(c){case"registerImmediately":t=Promise.resolve();break;case"registerWithDelay":t=rn(+p[0]||0);break;case"registerWhenStable":t=Promise.race([n.whenStable(),rn(+p[0])]);break;default:throw new N(5600,!1)}}t.then(()=>{n.destroyed||navigator.serviceWorker.register(d,{scope:i.scope}).catch(c=>console.error(We(5604,!1)))})})}function rn(i){return new Promise(d=>setTimeout(d,i))}function Wn(i,d){return new ae(i.enabled!==!1?navigator.serviceWorker:void 0,d)}var ce=class{enabled;scope;registrationStrategy};function sn(i,d={}){return pe([Un,Bn,{provide:on,useValue:i},{provide:ce,useValue:d},{provide:ae,useFactory:Wn,deps:[ce,me]},Ye(Gn)])}var dn=(()=>{class i{constructor(){this.maxRetries=3,this.retryDelay=1e3}intercept(e,n){return n.handle(e)}isLockError(e){if(!e)return!1;let n=e.message||e.error?.message||"";return n.includes("NavigatorLockAcquireTimeoutError")||n.includes("lock")||n.includes("timeout")||e.status===0&&n.includes("Unknown Error")}clearLocks(){try{console.log("\u{1F513} Interceptor: Limpiando locks..."),["lock:sb-auth-token","lock:sb-auth-token-resobra","sb-auth-token","supabase.auth.token","sb-"+window.location.hostname+"-auth-token"].forEach(n=>{try{localStorage.removeItem(n),sessionStorage.removeItem(n)}catch(t){console.warn(`\u26A0\uFE0F Error removing lock key ${n}:`,t)}}),console.log("\u2705 Interceptor: Locks limpiados")}catch(e){console.warn("\u274C Interceptor: Error limpiando locks:",e)}}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=y({token:i,factory:i.\u0275fac})}}return i})();var cn=(()=>{class i{constructor(){this.DEFAULT_TIMEOUT=3e4,this.MAX_RETRIES=2,this.RETRY_DELAY=2e3}intercept(e,n){let t=this.getTimeoutForRequest(e);return n.handle(e).pipe(Ke(t),Ge(s=>s.pipe(Be((c,p)=>{if(this.shouldRetry(c,p)){let g=this.RETRY_DELAY*Math.pow(2,p);return console.log(`\u{1F504} Reintentando request despu\xE9s de timeout (intento ${p+1}/${this.MAX_RETRIES}) en ${g}ms`),console.log(`\u{1F4CD} URL: ${e.url}`),Ne(g)}return ie(()=>c)}))),Ue(s=>{if(s.name==="TimeoutError"){let c=new Te({error:{message:"La solicitud ha tardado demasiado tiempo. Por favor, verifica tu conexi\xF3n a internet.",code:"TIMEOUT_ERROR",originalError:s},status:0,statusText:"Timeout",url:e.url||void 0});return ie(()=>c)}if(s.status===0&&s.error instanceof ProgressEvent){console.error("\u274C Error de conexi\xF3n:",{url:e.url,error:s.message});let c=new Te({error:{message:"No se pudo conectar con el servidor. Verifica tu conexi\xF3n a internet.",code:"CONNECTION_ERROR",originalError:s},status:0,statusText:"Connection Error",url:e.url||void 0});return ie(()=>c)}return ie(()=>s)}))}getTimeoutForRequest(e){let n=e.url.toLowerCase();return n.includes("/auth/")||n.includes("supabase.co/auth/")?45e3:e.method==="POST"&&(n.includes("/storage/")||n.includes("upload"))?6e4:this.DEFAULT_TIMEOUT}shouldRetry(e,n){return n>=this.MAX_RETRIES?!1:e.name==="TimeoutError"||e.status===0&&e.error instanceof ProgressEvent||e.status>=500&&e.status<600}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275prov=y({token:i,factory:i.\u0275fac})}}return i})();var ln={providers:[lt(nn),an(),ot(st()),qt(),sn("ngsw-worker.js",{enabled:!Qe(),registrationStrategy:"registerWhenStable:30000"}),{provide:Re,useClass:cn,multi:!0},{provide:Re,useClass:dn,multi:!0}]};function Vn(i,d){i&1&&(a(0,"div",4)(1,"div",5),C(2,"div",6),a(3,"p"),o(4,"Verificando autenticaci\xF3n..."),r()()())}function $n(i,d){i&1&&(a(0,"a",33)(1,"div",15)(2,"mat-icon"),o(3,"build"),r(),a(4,"span"),o(5,"Crear Reportes"),r()()())}function Hn(i,d){i&1&&(a(0,"a",34)(1,"div",15)(2,"mat-icon"),o(3,"inventory"),r(),a(4,"span"),o(5,"Administraci\xF3n de Partidas"),r()()())}function Zn(i,d){i&1&&(a(0,"a",35)(1,"div",15)(2,"mat-icon"),o(3,"business"),r(),a(4,"span"),o(5,"Obras"),r()()())}function qn(i,d){i&1&&(a(0,"a",36)(1,"div",15)(2,"mat-icon"),o(3,"group"),r(),a(4,"span"),o(5,"Gesti\xF3n de Usuarios"),r()()())}function Yn(i,d){if(i&1){let e=q();a(0,"div",7)(1,"aside",8)(2,"div",9)(3,"div",10)(4,"mat-icon",11),o(5,"construction"),r(),a(6,"span",12),o(7,"SGR Obras viales"),r()()(),a(8,"nav",13)(9,"a",14)(10,"div",15)(11,"mat-icon"),o(12,"dashboard"),r(),a(13,"span"),o(14,"Dashboard"),r()()(),a(15,"a",16)(16,"div",15)(17,"mat-icon"),o(18,"assignment"),r(),a(19,"span"),o(20,"Actividades"),r()()(),a(21,"a",17)(22,"div",15)(23,"mat-icon"),o(24,"map"),r(),a(25,"span"),o(26,"Mapa"),r()()(),a(27,"a",18)(28,"div",15)(29,"mat-icon"),o(30,"assessment"),r(),a(31,"span"),o(32,"Evaluaciones"),r()()(),a(33,"a",19)(34,"div",15)(35,"mat-icon"),o(36,"analytics"),r(),a(37,"span"),o(38,"KPIs"),r()()(),a(39,"a",20)(40,"div",15)(41,"mat-icon"),o(42,"description"),r(),a(43,"span"),o(44,"Reportes"),r()()(),I(45,$n,6,0,"a",21)(46,Hn,6,0,"a",22)(47,Zn,6,0,"a",23)(48,qn,6,0,"a",24),r(),a(49,"div",25)(50,"div",26)(51,"mat-icon"),o(52,"person"),r(),a(53,"div",27)(54,"span",28),o(55),r(),a(56,"span",29),o(57),r()()(),a(58,"button",30),A("click",function(){B(e);let t=E();return G(t.logout())}),a(59,"mat-icon"),o(60,"logout"),r()()()(),a(61,"div",31)(62,"main",32),C(63,"router-outlet"),r()()()}if(i&2){let e=E();l(45),u("ngIf",(e.currentProfile==null?null:e.currentProfile.rol)==="residente"),l(),u("ngIf",(e.currentProfile==null?null:e.currentProfile.rol)==="residente"),l(),u("ngIf",(e.currentProfile==null?null:e.currentProfile.rol)==="residente"),l(),u("ngIf",(e.currentProfile==null?null:e.currentProfile.rol)==="residente"),l(7),w((e.currentProfile==null?null:e.currentProfile.nombre)||(e.currentUser==null?null:e.currentUser.nombre)||"Usuario"),l(2),w((e.currentProfile==null?null:e.currentProfile.rol)||"Sin rol")}}function Jn(i,d){i&1&&(a(0,"div",37),C(1,"router-outlet"),r())}var pn=(()=>{class i{constructor(e,n,t,s){this.directAuthService=e,this.router=n,this.cdr=t,this.ngZone=s,this.title="Sistema de Gesti\xF3n de Rendimiento en Construcci\xF3n de Carreteras",this.isAuthenticated=!1,this.isInitialized=!1,this.currentUser=null,this.currentProfile=null}ngOnInit(){this.ngZone.run(()=>{this.updateAuthState()}),setTimeout(()=>{this.ngZone.run(()=>{this.isInitialized=!0,this.cdr.detectChanges()})},300),this.checkProfileUpdates()}updateAuthState(){this.isAuthenticated=this.directAuthService.isAuthenticated(),this.currentUser=this.directAuthService.getCurrentUser(),this.currentProfile=this.directAuthService.getCurrentProfile(),console.log("\u{1F504} AppComponent - Estado actualizado:",{authenticated:this.isAuthenticated,user:this.currentUser?.email,profile:this.currentProfile?.rol}),this.cdr.detectChanges()}checkProfileUpdates(){let e=setInterval(()=>{let n=this.directAuthService.getCurrentProfile();n&&(!this.currentProfile||n.rol!==this.currentProfile?.rol)&&(console.log("\u2705 AppComponent - Perfil actualizado detectado"),this.ngZone.run(()=>{this.updateAuthState()}),clearInterval(e))},1e3);setTimeout(()=>{clearInterval(e)},3e4)}getCurrentDate(){let e=new Date,n={weekday:"long",year:"numeric",month:"long",day:"numeric"};return e.toLocaleDateString("es-ES",n)}logout(){return f(this,null,function*(){try{yield this.directAuthService.logout(),this.isAuthenticated=!1,this.currentUser=null,this.currentProfile=null,this.router.navigate(["/login"]),this.cdr.detectChanges()}catch(e){console.error("Error durante logout:",e)}})}static{this.\u0275fac=function(n){return new(n||i)(M(D),M(W),M(Y),M(T))}}static{this.\u0275cmp=Z({type:i,selectors:[["app-root"]],decls:4,vars:3,consts:[[1,"app-container"],["class","loading-layout",4,"ngIf"],["class","authenticated-layout",4,"ngIf"],["class","unauthenticated-layout",4,"ngIf"],[1,"loading-layout"],[1,"loading-container"],[1,"loading-spinner"],[1,"authenticated-layout"],[1,"sidebar"],[1,"sidebar-header"],[1,"logo"],[1,"logo-icon"],[1,"logo-text"],[1,"sidebar-nav"],["routerLink","/dashboard","routerLinkActive","active",1,"nav-item"],[1,"nav-link"],["routerLink","/actividades","routerLinkActive","active",1,"nav-item"],["routerLink","/mapa","routerLinkActive","active",1,"nav-item"],["routerLink","/evaluaciones","routerLinkActive","active",1,"nav-item"],["routerLink","/kpis","routerLinkActive","active",1,"nav-item"],["routerLink","/reportes","routerLinkActive","active",1,"nav-item"],["routerLink","/main","class","nav-item","routerLinkActive","active",4,"ngIf"],["routerLink","/partidas","class","nav-item","routerLinkActive","active",4,"ngIf"],["routerLink","/obras","class","nav-item","routerLinkActive","active",4,"ngIf"],["routerLink","/usuarios","class","nav-item","routerLinkActive","active",4,"ngIf"],[1,"sidebar-footer"],[1,"user-info"],[1,"user-details"],[1,"user-name"],[1,"user-role"],["mat-icon-button","","matTooltip","Cerrar sesi\xF3n",1,"logout-btn",3,"click"],[1,"main-content"],[1,"page-content"],["routerLink","/main","routerLinkActive","active",1,"nav-item"],["routerLink","/partidas","routerLinkActive","active",1,"nav-item"],["routerLink","/obras","routerLinkActive","active",1,"nav-item"],["routerLink","/usuarios","routerLinkActive","active",1,"nav-item"],[1,"unauthenticated-layout"]],template:function(n,t){n&1&&(a(0,"div",0),I(1,Vn,5,0,"div",1)(2,Yn,64,6,"div",2)(3,Jn,2,0,"div",3),r()),n&2&&(l(),u("ngIf",!t.isInitialized),l(),u("ngIf",t.isInitialized&&t.isAuthenticated),l(),u("ngIf",t.isInitialized&&!t.isAuthenticated))},dependencies:[X,J,dt,fe,ct,ne,te,ee,Q,ye,Se],styles:['.app-container[_ngcontent-%COMP%]{display:flex;height:100vh;background-color:#fafafa;overflow:hidden}.loading-layout[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;background:linear-gradient(135deg,#2d9596,#1a6b6c)}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:20px;color:#fff}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:500;margin:0}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid rgba(255,255,255,.3);border-top:4px solid white;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.authenticated-layout[_ngcontent-%COMP%]{display:flex;width:100%;height:100%}.unauthenticated-layout[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:100%;background:linear-gradient(135deg,#2d9596,#1a6b6c)}.sidebar[_ngcontent-%COMP%]{width:280px;background:#fff;display:flex;flex-direction:column;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d;z-index:1000;position:relative;border-right:1px solid #e5e7eb}.sidebar-header[_ngcontent-%COMP%]{padding:24px 20px;border-bottom:1px solid #e5e7eb}.sidebar-header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.sidebar-header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   .logo-icon[_ngcontent-%COMP%]{color:#1e3a8a;font-size:28px;background:#dbeafe;border-radius:12px}.sidebar-header[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   .logo-text[_ngcontent-%COMP%]{color:#1e3a8a;font-size:1.25rem;font-weight:600;letter-spacing:-.025em}.sidebar-nav[_ngcontent-%COMP%]{flex:1;padding:20px 16px;overflow-y:auto}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{display:block;margin-bottom:8px;border-radius:12px;text-decoration:none;transition:all .3s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:16px 20px;color:#374151;font-weight:500;font-size:.95rem;line-height:1.4;min-height:56px;border:none;background:none;width:100%;text-align:left;cursor:pointer}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px;transition:transform .3s ease}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{transition:transform .3s ease}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover{background:#dbeafe;transform:translate(4px);box-shadow:0 2px 8px #0000001a}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover   .nav-link[_ngcontent-%COMP%]{color:#1e3a8a}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover   .nav-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{transform:translate(2px)}.sidebar-nav[_ngcontent-%COMP%]   .nav-item.active[_ngcontent-%COMP%]{background:#1e3a8a;box-shadow:0 4px 12px #1e3a8a26}.sidebar-nav[_ngcontent-%COMP%]   .nav-item.active[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#fff;font-weight:600}.sidebar-nav[_ngcontent-%COMP%]   .nav-item.active[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;width:4px;height:100%;background:#1e3a8a;border-radius:0 4px 4px 0;box-shadow:0 0 8px #1e3a8a80}.sidebar-footer[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #e5e7eb}.sidebar-footer[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.sidebar-footer[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#1e3a8a;font-size:32px;width:32px;height:32px}.sidebar-footer[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:space-between}.sidebar-footer[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{color:#1e3a8a;font-weight:500;font-size:.9rem}.sidebar-footer[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]{color:#6b7280}.sidebar-footer[_ngcontent-%COMP%]   .user-profile[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]:hover{color:#1e3a8a;background:#dbeafe}.main-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden;background:#fff}.main-header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #E5E7EB;padding:24px 32px}.main-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;max-width:1400px;margin:0 auto;width:100%}.main-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;color:#2c3e50;margin:0 0 4px;letter-spacing:-.025em}.main-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{color:#6b7280;font-size:.95rem;margin:0;font-weight:400}.main-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .create-btn[_ngcontent-%COMP%]{background:#1e3a8a!important;color:#fff!important;border-radius:12px;padding:12px 24px;font-weight:600;font-size:.9rem;letter-spacing:.025em;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;transition:all .2s ease}.main-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .create-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:18px}.main-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]   .create-btn[_ngcontent-%COMP%]:hover{background:#1e40af!important;box-shadow:0 10px 15px -3px #0000001a,0 4px 6px -2px #0000000d}.page-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:32px;background:#fafafa}@media (max-width: 1024px){.sidebar[_ngcontent-%COMP%]{width:240px}.main-header[_ngcontent-%COMP%]{padding:20px 24px}.main-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.5rem}.page-content[_ngcontent-%COMP%]{padding:24px}}@media (max-width: 900px){.sidebar[_ngcontent-%COMP%]{width:180px}.main-content[_ngcontent-%COMP%]{margin-left:180px}.page-header[_ngcontent-%COMP%]{padding:10px 14px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.page-content[_ngcontent-%COMP%]{padding:14px}}@media (max-width: 768px){.app-container[_ngcontent-%COMP%]{flex-direction:column}.sidebar[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;width:100%;height:auto;z-index:1000;box-shadow:0 -2px 8px #0000001a;background:#fff}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%], .sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]{display:none}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]{display:flex;justify-content:space-around;padding:8px 4px;background:#fff;border-top:1px solid #E5E7EB;min-height:64px;margin:0}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{flex:1;margin:0;border-radius:12px;transition:all .3s cubic-bezier(.4,0,.2,1);transform:none;position:relative;overflow:hidden}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover{background:#dbeafe;transform:none;box-shadow:0 2px 8px #1e3a8a33}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item.active[_ngcontent-%COMP%]{background:#dbeafe;box-shadow:0 4px 12px #1e3a8a40}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item.active[_ngcontent-%COMP%]:before{display:none}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item.active[_ngcontent-%COMP%]:after{content:"";position:absolute;top:0;left:50%;transform:translate(-50%);width:24px;height:3px;background:#1e3a8a;border-radius:0 0 4px 4px;box-shadow:0 2px 4px #1e3a8a80}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item.active[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#1e3a8a;font-weight:600}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{flex-direction:column;font-size:.75rem;min-height:56px;padding:12px 8px;gap:6px;color:#6b7280;text-align:center;transition:all .3s ease}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px;margin:0;transition:transform .3s ease}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.7rem;line-height:1.2;max-width:60px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:500}.main-content[_ngcontent-%COMP%]{margin-left:0;padding-bottom:80px}.page-header[_ngcontent-%COMP%]{padding:12px 16px;background:#fff;border-bottom:1px solid #E5E7EB;position:sticky;top:0;z-index:100}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.375rem;margin:0}.page-content[_ngcontent-%COMP%]{padding:16px}}@media (max-width: 480px){.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]{padding:6px 2px;min-height:60px}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{min-height:52px;padding:10px 6px;gap:4px;transition:all .3s ease}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;transition:transform .3s ease}.sidebar[_ngcontent-%COMP%]   .sidebar-nav[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.65rem;max-width:50px;font-weight:500;line-height:1.2}.main-content[_ngcontent-%COMP%]{padding-bottom:74px}.main-header[_ngcontent-%COMP%]{padding:12px 16px}.main-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:1.125rem}.main-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .page-subtitle[_ngcontent-%COMP%]{font-size:.8rem}.page-content[_ngcontent-%COMP%]{padding:12px}}']})}}return i})();rt(pn,ln).catch(i=>{});
