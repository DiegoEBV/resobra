import{a as Jt}from"./chunk-VTM53OAN.js";import{a as Yt}from"./chunk-MFOD52JF.js";import{a as Ot,b as Et,c as St,d as Tt,e as zt,f as It}from"./chunk-ZRWTJLBH.js";import"./chunk-OGQ77C6X.js";import{a as qt}from"./chunk-42EQRTQ5.js";import{a as ni}from"./chunk-NXOYKD4N.js";import"./chunk-EPNA6SYW.js";import"./chunk-ZLVJQ2UH.js";import"./chunk-SXXER37Y.js";import{a as Kt}from"./chunk-IBAGYEH7.js";import{c as Lt,g as Bt}from"./chunk-JUW7GNWS.js";import"./chunk-MS4AQ6UA.js";import{a as Rt,b as $t}from"./chunk-DMZJ7K26.js";import{c as jt}from"./chunk-7BCONPA6.js";import{a as Ut,b as Nt,c as Wt,d as Gt,f as Qt,g as Ht,h as Zt}from"./chunk-BRP3ETBH.js";import"./chunk-ZOXEDHNH.js";import{a as kt,c as Pt,d as Ft}from"./chunk-ZBUPANVT.js";import"./chunk-F5X5MWHG.js";import{a as At,b as Dt}from"./chunk-WI2E4B7N.js";import"./chunk-CSWWTQFU.js";import{a as Vt}from"./chunk-6DYBOFBA.js";import{a as yt}from"./chunk-GOBT7UBB.js";import{a as xt,b as Mt}from"./chunk-AZ2U4T3U.js";import"./chunk-SGYCFQGT.js";import"./chunk-2GVF4P32.js";import"./chunk-WFXXN3GR.js";import{a as vt,b as bt}from"./chunk-YC5WDUOT.js";import{c as $e,d as Ke,g as Ue}from"./chunk-YMTLAEZG.js";import"./chunk-G7YPFBNB.js";import{a as Xe,b as et,c as tt,d as it,e as nt,f as at,g as ot,h as rt}from"./chunk-SNSQLCH6.js";import{b as pt,c as mt}from"./chunk-BXKJ5BTH.js";import"./chunk-3RK6DDJD.js";import{C as ct,F as dt,G as lt,b as Ne,g as We,k as Ge,w as Qe,y as st}from"./chunk-UJ3DDJ5Q.js";import{F as te,H as ge,Ja as wt,K as He,Ka as $,La as Ct,Ma as _e,S as Ze,T as qe,Y as Ye,a as Le,ca as Je,ea as fe,fa as V,h as Be,i as Ve,j as je,p as Re,sa as ht,ua as ut,va as gt,wa as ft,xa as _t}from"./chunk-4WMI5X77.js";import{A as ke,Aa as Q,Ba as H,C as j,Cb as me,Cc as ee,Db as h,Ea as Z,Eb as z,Fb as E,G as Pe,Ha as Ee,I as Fe,Ib as U,J as se,Ma as Se,Nb as o,Ob as r,Pb as q,Ra as pe,Tb as A,V as ce,X as M,Xb as _,Yb as b,Zb as I,_b as P,ac as N,bc as he,ca as Oe,cc as L,db as d,dc as B,ea as de,f as O,gc as De,ha as m,hb as Te,hc as s,ib as S,ic as D,jc as x,kc as ue,mc as Y,nc as J,oc as X,pa as g,pb as T,q as re,qa as f,qb as Ae,qc as R,rc as ze,sc as Ie,ta as G,tb as K,va as le,vb as y,x as ye}from"./chunk-B6672ACT.js";import"./chunk-X5YLR3NI.js";import{a as xe,b as Me,g as ii,i as k}from"./chunk-ODN5LVDJ.js";var p=ii(ni());var ae=["*"],ri=["content"],si=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],ci=["mat-drawer","mat-drawer-content","*"];function di(a,w){if(a&1){let e=A();o(0,"div",1),_("click",function(){g(e);let i=b();return f(i._onBackdropClicked())}),r()}if(a&2){let e=b();E("mat-drawer-shown",e._isShowingBackdrop())}}function li(a,w){a&1&&(o(0,"mat-drawer-content"),P(1,2),r())}var pi=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],mi=["mat-sidenav","mat-sidenav-content","*"];function hi(a,w){if(a&1){let e=A();o(0,"div",1),_("click",function(){g(e);let i=b();return f(i._onBackdropClicked())}),r()}if(a&2){let e=b();E("mat-drawer-shown",e._isShowingBackdrop())}}function ui(a,w){a&1&&(o(0,"mat-sidenav-content"),P(1,2),r())}var gi=`.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color, var(--mat-sys-on-background));background-color:var(--mat-sidenav-content-background-color, var(--mat-sys-background));box-sizing:border-box;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color, color-mix(in srgb, var(--mat-sys-neutral-variant20) 40%, transparent))}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}@media(forced-colors: active){.mat-drawer-backdrop{opacity:.5}}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-content.mat-drawer-content-hidden{opacity:0}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color, var(--mat-sys-on-surface-variant));box-shadow:var(--mat-sidenav-container-elevation-shadow, none);background-color:var(--mat-sidenav-container-background-color, var(--mat-sys-surface));border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));width:var(--mat-sidenav-container-width, 360px);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}@media(forced-colors: active){.mat-drawer,[dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}}@media(forced-colors: active){[dir=rtl] .mat-drawer,.mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-transition .mat-drawer{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating){visibility:hidden;box-shadow:none}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating) .mat-drawer-inner-container{display:none}.mat-drawer.mat-drawer-opened.mat-drawer-opened{transform:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto}.mat-sidenav-fixed{position:fixed}
`;var fi=new de("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:_i}),we=new de("MAT_DRAWER_CONTAINER");function _i(){return!1}var ie=(()=>{class a extends ${_platform=m(te);_changeDetectorRef=m(ee);_container=m(be);constructor(){let e=m(Z),t=m(wt),i=m(H);super(e,t,i)}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}_shouldBeHidden(){if(this._platform.isBrowser)return!1;let{start:e,end:t}=this._container;return e!=null&&e.mode!=="over"&&e.opened||t!=null&&t.mode!=="over"&&t.opened}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=T({type:a,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:6,hostBindings:function(t,i){t&2&&(z("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px"),E("mat-drawer-content-hidden",i._shouldBeHidden()))},features:[R([{provide:$,useExisting:a}]),K],ngContentSelectors:ae,decls:1,vars:0,template:function(t,i){t&1&&(I(),P(0))},encapsulation:2,changeDetection:0})}return a})(),ve=(()=>{class a{_elementRef=m(Z);_focusTrapFactory=m(qe);_focusMonitor=m(He);_platform=m(te);_ngZone=m(H);_renderer=m(Te);_interactivityChecker=m(Ze);_doc=m(Le,{optional:!0});_container=m(we,{optional:!0});_focusTrap=null;_elementFocusedBeforeDrawerWasOpened=null;_eventCleanups;_isAttached;_anchor;get position(){return this._position}set position(e){e=e==="end"?"end":"start",e!==this._position&&(this._isAttached&&this._updatePositionInParent(e),this._position=e,this.onPositionChanged.emit())}_position="start";get mode(){return this._mode}set mode(e){this._mode=e,this._updateFocusTrapState(),this._modeChanged.next()}_mode="over";get disableClose(){return this._disableClose}set disableClose(e){this._disableClose=V(e)}_disableClose=!1;get autoFocus(){let e=this._autoFocus;return e??(this.mode==="side"?"dialog":"first-tabbable")}set autoFocus(e){(e==="true"||e==="false"||e==null)&&(e=V(e)),this._autoFocus=e}_autoFocus;get opened(){return this._opened}set opened(e){this.toggle(V(e))}_opened=!1;_openedVia;_animationStarted=new O;_animationEnd=new O;openedChange=new Q(!0);_openedStream=this.openedChange.pipe(j(e=>e),re(()=>{}));openedStart=this._animationStarted.pipe(j(()=>this.opened),se(void 0));_closedStream=this.openedChange.pipe(j(e=>!e),re(()=>{}));closedStart=this._animationStarted.pipe(j(()=>!this.opened),se(void 0));_destroyed=new O;onPositionChanged=new Q;_content;_modeChanged=new O;_injector=m(le);_changeDetectorRef=m(ee);constructor(){this.openedChange.pipe(M(this._destroyed)).subscribe(e=>{e?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{let e=this._elementRef.nativeElement;ye(e,"keydown").pipe(j(t=>t.keyCode===27&&!this.disableClose&&!Ye(t)),M(this._destroyed)).subscribe(t=>this._ngZone.run(()=>{this.close(),t.stopPropagation(),t.preventDefault()})),this._eventCleanups=[this._renderer.listen(e,"transitionrun",this._handleTransitionEvent),this._renderer.listen(e,"transitionend",this._handleTransitionEvent),this._renderer.listen(e,"transitioncancel",this._handleTransitionEvent)]}),this._animationEnd.subscribe(()=>{this.openedChange.emit(this._opened)})}_forceFocus(e,t){this._interactivityChecker.isFocusable(e)||(e.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{let i=()=>{n(),c(),e.removeAttribute("tabindex")},n=this._renderer.listen(e,"blur",i),c=this._renderer.listen(e,"mousedown",i)})),e.focus(t)}_focusByCssSelector(e,t){let i=this._elementRef.nativeElement.querySelector(e);i&&this._forceFocus(i,t)}_takeFocus(){if(!this._focusTrap)return;let e=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":pe(()=>{!this._focusTrap.focusInitialElement()&&typeof e.focus=="function"&&e.focus()},{injector:this._injector});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus);break}}_restoreFocus(e){this.autoFocus!=="dialog"&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,e):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){let e=this._doc.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}ngAfterViewInit(){this._isAttached=!0,this._position==="end"&&this._updatePositionInParent("end"),this._platform.isBrowser&&(this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState())}ngOnDestroy(){this._eventCleanups.forEach(e=>e()),this._focusTrap?.destroy(),this._anchor?.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(e){return this.toggle(!0,e)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(e=!this.opened,t){e&&t&&(this._openedVia=t);let i=this._setOpen(e,!e&&this._isFocusWithinDrawer(),this._openedVia||"program");return e||(this._openedVia=null),i}_setOpen(e,t,i){return e===this._opened?Promise.resolve(e?"open":"close"):(this._opened=e,this._container?._transitionsEnabled?this._setIsAnimating(!0):setTimeout(()=>{this._animationStarted.next(),this._animationEnd.next()}),this._elementRef.nativeElement.classList.toggle("mat-drawer-opened",e),!e&&t&&this._restoreFocus(i),this._changeDetectorRef.markForCheck(),this._updateFocusTrapState(),new Promise(n=>{this.openedChange.pipe(Fe(1)).subscribe(c=>n(c?"open":"close"))}))}_setIsAnimating(e){this._elementRef.nativeElement.classList.toggle("mat-drawer-animating",e)}_getWidth(){return this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=!!this._container?.hasBackdrop&&this.opened)}_updatePositionInParent(e){if(!this._platform.isBrowser)return;let t=this._elementRef.nativeElement,i=t.parentNode;e==="end"?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),i.insertBefore(this._anchor,t)),i.appendChild(t)):this._anchor&&this._anchor.parentNode.insertBefore(t,this._anchor)}_handleTransitionEvent=e=>{let t=this._elementRef.nativeElement;e.target===t&&this._ngZone.run(()=>{e.type==="transitionrun"?this._animationStarted.next(e):(e.type==="transitionend"&&this._setIsAnimating(!1),this._animationEnd.next(e))})};static \u0275fac=function(t){return new(t||a)};static \u0275cmp=T({type:a,selectors:[["mat-drawer"]],viewQuery:function(t,i){if(t&1&&he(ri,5),t&2){let n;L(n=B())&&(i._content=n.first)}},hostAttrs:[1,"mat-drawer"],hostVars:12,hostBindings:function(t,i){t&2&&(me("align",null)("tabIndex",i.mode!=="side"?"-1":null),z("visibility",!i._container&&!i.opened?"hidden":null),E("mat-drawer-end",i.position==="end")("mat-drawer-over",i.mode==="over")("mat-drawer-push",i.mode==="push")("mat-drawer-side",i.mode==="side"))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:ae,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,i){t&1&&(I(),o(0,"div",1,0),P(2),r())},dependencies:[$],encapsulation:2,changeDetection:0})}return a})(),be=(()=>{class a{_dir=m(Je,{optional:!0});_element=m(Z);_ngZone=m(H);_changeDetectorRef=m(ee);_animationMode=m(Se,{optional:!0});_transitionsEnabled=!1;_allDrawers;_drawers=new Ee;_content;_userContent;get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(e){this._autosize=V(e)}_autosize=m(fi);get hasBackdrop(){return this._drawerHasBackdrop(this._start)||this._drawerHasBackdrop(this._end)}set hasBackdrop(e){this._backdropOverride=e==null?null:V(e)}_backdropOverride;backdropClick=new Q;_start;_end;_left;_right;_destroyed=new O;_doCheckSubject=new O;_contentMargins={left:null,right:null};_contentMarginChanges=new O;get scrollable(){return this._userContent||this._content}_injector=m(le);constructor(){let e=m(te),t=m(Ct);this._dir?.change.pipe(M(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),t.change().pipe(M(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._animationMode!=="NoopAnimations"&&e.isBrowser&&this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{this._element.nativeElement.classList.add("mat-drawer-transition"),this._transitionsEnabled=!0},200)})}ngAfterContentInit(){this._allDrawers.changes.pipe(ce(this._allDrawers),M(this._destroyed)).subscribe(e=>{this._drawers.reset(e.filter(t=>!t._container||t._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(ce(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(e=>{this._watchDrawerToggle(e),this._watchDrawerPosition(e),this._watchDrawerMode(e)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(Pe(10),M(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(e=>e.open())}close(){this._drawers.forEach(e=>e.close())}updateContentMargins(){let e=0,t=0;if(this._left&&this._left.opened){if(this._left.mode=="side")e+=this._left._getWidth();else if(this._left.mode=="push"){let i=this._left._getWidth();e+=i,t-=i}}if(this._right&&this._right.opened){if(this._right.mode=="side")t+=this._right._getWidth();else if(this._right.mode=="push"){let i=this._right._getWidth();t+=i,e-=i}}e=e||null,t=t||null,(e!==this._contentMargins.left||t!==this._contentMargins.right)&&(this._contentMargins={left:e,right:t},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(e){e._animationStarted.pipe(M(this._drawers.changes)).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),e.mode!=="side"&&e.openedChange.pipe(M(this._drawers.changes)).subscribe(()=>this._setContainerClass(e.opened))}_watchDrawerPosition(e){e.onPositionChanged.pipe(M(this._drawers.changes)).subscribe(()=>{pe({read:()=>this._validateDrawers()},{injector:this._injector})})}_watchDrawerMode(e){e._modeChanged.pipe(M(ke(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(e){let t=this._element.nativeElement.classList,i="mat-drawer-container-has-open";e?t.add(i):t.remove(i)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(e=>{e.position=="end"?(this._end!=null,this._end=e):(this._start!=null,this._start=e)}),this._right=this._left=null,this._dir&&this._dir.value==="rtl"?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&this._start.mode!="over"||this._isDrawerOpen(this._end)&&this._end.mode!="over"}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(e=>e&&!e.disableClose&&this._drawerHasBackdrop(e)).forEach(e=>e._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._drawerHasBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._drawerHasBackdrop(this._end)}_isDrawerOpen(e){return e!=null&&e.opened}_drawerHasBackdrop(e){return this._backdropOverride==null?!!e&&e.mode!=="side":this._backdropOverride}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=T({type:a,selectors:[["mat-drawer-container"]],contentQueries:function(t,i,n){if(t&1&&(N(n,ie,5),N(n,ve,5)),t&2){let c;L(c=B())&&(i._content=c.first),L(c=B())&&(i._allDrawers=c)}},viewQuery:function(t,i){if(t&1&&he(ie,5),t&2){let n;L(n=B())&&(i._userContent=n.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,i){t&2&&E("mat-drawer-container-explicit-backdrop",i._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[R([{provide:we,useExisting:a}])],ngContentSelectors:ci,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){t&1&&(I(si),y(0,di,1,2,"div",0),P(1),P(2,1),y(3,li,2,0,"mat-drawer-content")),t&2&&(U(i.hasBackdrop?0:-1),d(3),U(i._content?-1:3))},dependencies:[ie],styles:[`.mat-drawer-container{position:relative;z-index:1;color:var(--mat-sidenav-content-text-color, var(--mat-sys-on-background));background-color:var(--mat-sidenav-content-background-color, var(--mat-sys-background));box-sizing:border-box;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible;background-color:var(--mat-sidenav-scrim-color, color-mix(in srgb, var(--mat-sys-neutral-variant20) 40%, transparent))}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}@media(forced-colors: active){.mat-drawer-backdrop{opacity:.5}}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-content.mat-drawer-content-hidden{opacity:0}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;color:var(--mat-sidenav-container-text-color, var(--mat-sys-on-surface-variant));box-shadow:var(--mat-sidenav-container-elevation-shadow, none);background-color:var(--mat-sidenav-container-background-color, var(--mat-sys-surface));border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));width:var(--mat-sidenav-container-width, 360px);display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}@media(forced-colors: active){.mat-drawer,[dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}}@media(forced-colors: active){[dir=rtl] .mat-drawer,.mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0);border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0}[dir=rtl] .mat-drawer{border-top-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-left-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-right-radius:0;border-bottom-right-radius:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{border-top-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-bottom-right-radius:var(--mat-sidenav-container-shape, var(--mat-sys-corner-large));border-top-left-radius:0;border-bottom-left-radius:0;left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-transition .mat-drawer{transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating){visibility:hidden;box-shadow:none}.mat-drawer:not(.mat-drawer-opened):not(.mat-drawer-animating) .mat-drawer-inner-container{display:none}.mat-drawer.mat-drawer-opened.mat-drawer-opened{transform:none}.mat-drawer-side{box-shadow:none;border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid}.mat-drawer-side.mat-drawer-end{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side{border-left-color:var(--mat-sidenav-container-divider-color, transparent);border-left-width:1px;border-left-style:solid;border-right:none}[dir=rtl] .mat-drawer-side.mat-drawer-end{border-right-color:var(--mat-sidenav-container-divider-color, transparent);border-right-width:1px;border-right-style:solid;border-left:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto}.mat-sidenav-fixed{position:fixed}
`],encapsulation:2,changeDetection:0})}return a})(),ne=(()=>{class a extends ie{static \u0275fac=(()=>{let e;return function(i){return(e||(e=G(a)))(i||a)}})();static \u0275cmp=T({type:a,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],features:[R([{provide:$,useExisting:a}]),K],ngContentSelectors:ae,decls:1,vars:0,template:function(t,i){t&1&&(I(),P(0))},encapsulation:2,changeDetection:0})}return a})(),Ce=(()=>{class a extends ve{get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(e){this._fixedInViewport=V(e)}_fixedInViewport=!1;get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(e){this._fixedTopGap=ge(e)}_fixedTopGap=0;get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(e){this._fixedBottomGap=ge(e)}_fixedBottomGap=0;static \u0275fac=(()=>{let e;return function(i){return(e||(e=G(a)))(i||a)}})();static \u0275cmp=T({type:a,selectors:[["mat-sidenav"]],hostAttrs:[1,"mat-drawer","mat-sidenav"],hostVars:16,hostBindings:function(t,i){t&2&&(me("tabIndex",i.mode!=="side"?"-1":null)("align",null),z("top",i.fixedInViewport?i.fixedTopGap:null,"px")("bottom",i.fixedInViewport?i.fixedBottomGap:null,"px"),E("mat-drawer-end",i.position==="end")("mat-drawer-over",i.mode==="over")("mat-drawer-push",i.mode==="push")("mat-drawer-side",i.mode==="side")("mat-sidenav-fixed",i.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[R([{provide:ve,useExisting:a}]),K],ngContentSelectors:ae,decls:3,vars:0,consts:[["content",""],["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,i){t&1&&(I(),o(0,"div",1,0),P(2),r())},dependencies:[$],encapsulation:2,changeDetection:0})}return a})(),Xt=(()=>{class a extends be{_allDrawers=void 0;_content=void 0;static \u0275fac=(()=>{let e;return function(i){return(e||(e=G(a)))(i||a)}})();static \u0275cmp=T({type:a,selectors:[["mat-sidenav-container"]],contentQueries:function(t,i,n){if(t&1&&(N(n,ne,5),N(n,Ce,5)),t&2){let c;L(c=B())&&(i._content=c.first),L(c=B())&&(i._allDrawers=c)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,i){t&2&&E("mat-drawer-container-explicit-backdrop",i._backdropOverride)},exportAs:["matSidenavContainer"],features:[R([{provide:we,useExisting:a},{provide:be,useExisting:a}]),K],ngContentSelectors:mi,decls:4,vars:2,consts:[[1,"mat-drawer-backdrop",3,"mat-drawer-shown"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){t&1&&(I(pi),y(0,hi,1,2,"div",0),P(1),P(2,1),y(3,ui,2,0,"mat-sidenav-content")),t&2&&(U(i.hasBackdrop?0:-1),d(3),U(i._content?-1:3))},dependencies:[ne],styles:[gi],encapsulation:2,changeDetection:0})}return a})(),ei=(()=>{class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=Ae({type:a});static \u0275inj=Oe({imports:[fe,_e,_e,fe]})}return a})();var bi=()=>["/actividades"],wi=a=>({frente:a});function Ci(a,w){a&1&&(o(0,"mat-chip",37)(1,"mat-icon"),s(2,"open_with"),r(),s(3," Modo Arrastrar "),r())}function xi(a,w){if(a&1&&(o(0,"mat-option",38),s(1),r()),a&2){let e=w.$implicit;h("value",e.value),d(),x(" ",e.label," ")}}function Mi(a,w){if(a&1&&(o(0,"mat-option",38),s(1),r()),a&2){let e=w.$implicit;h("value",e.value),d(),x(" ",e.label," ")}}function yi(a,w){a&1&&(o(0,"div",39),q(1,"mat-spinner",40),o(2,"p"),s(3,"Cargando frentes..."),r()())}function ki(a,w){if(a&1){let e=A();o(0,"mat-list-item",42),_("click",function(){let i=g(e).$implicit,n=b(2);return f(n.centerOnFrente(i))}),o(1,"div",43)(2,"mat-icon",44),s(3),r()(),o(4,"div",45),s(5),r(),o(6,"div",46)(7,"span",47),s(8),r(),o(9,"span",48),s(10),r()(),o(11,"div",49)(12,"span"),s(13),r(),o(14,"span"),s(15),r()(),o(16,"button",50),_("click",function(i){let n=g(e).$implicit;return b(2).centerOnFrente(n),f(i.stopPropagation())}),o(17,"mat-icon"),s(18,"my_location"),r()()()}if(a&2){let e=w.$implicit,t=b(2);E("selected",(t.selectedFrente==null?null:t.selectedFrente.id)===e.id),d(2),z("color",t.getFrenteIconColor(e.estado)),h("matBadge",t.getActividadesEnProgreso(e.id))("matBadgeHidden",t.getActividadesEnProgreso(e.id)===0),d(),x(" ",t.getFrenteIcon(e.estado)," "),d(2),D(e.nombre),d(2),h("ngClass","estado-"+e.estado),d(),x(" ",t.getEstadoLabel(e.estado)," "),d(2),ue("Lat: ",e.ubicacion_lat==null?null:e.ubicacion_lat.toFixed(4),", Lng: ",e.ubicacion_lng==null?null:e.ubicacion_lng.toFixed(4),""),d(3),x("Progreso: ",t.getProgresoPromedio(e.id).toFixed(1),"%"),d(2),x("",t.getActividadesByFrente(e.id).length," actividades")}}function Pi(a,w){if(a&1&&(o(0,"mat-nav-list"),y(1,ki,19,14,"mat-list-item",41),r()),a&2){let e=b();d(),h("ngForOf",e.filteredFrente)}}function Fi(a,w){a&1&&(o(0,"p",53)(1,"mat-icon"),s(2,"info"),r(),s(3," Inicia sesi\xF3n para ver los frentes y actividades "),r())}function Oi(a,w){if(a&1&&(o(0,"div",51)(1,"mat-icon"),s(2,"location_off"),r(),o(3,"p"),s(4,"No se encontraron frentes con los filtros aplicados"),r(),y(5,Fi,4,0,"p",52),r()),a&2){let e=b();d(5),h("ngIf",!e.directAuthService.isAuthenticated())}}function Ei(a,w){a&1&&(o(0,"div",54),q(1,"mat-spinner",55),o(2,"p"),s(3,"Cargando mapa..."),r()())}function Si(a,w){if(a&1){let e=A();o(0,"div",56)(1,"mat-card",57)(2,"mat-card-content")(3,"div",58)(4,"mat-icon",59),s(5,"add_location"),r(),o(6,"h3"),s(7,"Creando Nuevo Frente"),r(),o(8,"p"),s(9,"Haz clic en el mapa para seleccionar la ubicaci\xF3n del frente"),r(),o(10,"button",60),_("click",function(){g(e);let i=b();return f(i.cancelFrenteCreation())}),o(11,"mat-icon"),s(12,"cancel"),r(),s(13," Cancelar "),r()()()()()}}function Ti(a,w){if(a&1&&(o(0,"div",65)(1,"mat-icon"),s(2,"description"),r(),o(3,"span"),s(4),r()()),a&2){let e=b(2);d(4),D(e.selectedFrente.descripcion)}}function Ai(a,w){if(a&1){let e=A();o(0,"mat-card",61)(1,"mat-card-header")(2,"div",62)(3,"mat-icon"),s(4),r()(),o(5,"mat-card-title"),s(6),r(),o(7,"mat-card-subtitle")(8,"span",47),s(9),r()(),o(10,"button",63),_("click",function(){g(e);let i=b();return f(i.selectedFrente=null)}),o(11,"mat-icon"),s(12,"close"),r()()(),o(13,"mat-card-content")(14,"div",64)(15,"div",65)(16,"mat-icon"),s(17,"location_on"),r(),o(18,"span"),s(19),r()(),y(20,Ti,5,1,"div",66),o(21,"div",65)(22,"mat-icon"),s(23,"trending_up"),r(),o(24,"span"),s(25),r()()(),o(26,"div",67)(27,"h4"),s(28,"Actividades del Frente"),r(),o(29,"div",68)(30,"div",69)(31,"span",70),s(32),r(),o(33,"span",71),s(34,"Total"),r()(),o(35,"div",69)(36,"span",70),s(37),r(),o(38,"span",71),s(39,"En Progreso"),r()(),o(40,"div",69)(41,"span",70),s(42),r(),o(43,"span",71),s(44,"Completadas"),r()(),o(45,"div",69)(46,"span",70),s(47),r(),o(48,"span",71),s(49,"Progreso"),r()()()()(),o(50,"mat-card-actions")(51,"button",72)(52,"mat-icon"),s(53,"list"),r(),s(54," Ver Actividades "),r(),o(55,"button",73),_("click",function(){g(e);let i=b();return f(i.centerOnFrente(i.selectedFrente))}),o(56,"mat-icon"),s(57,"center_focus_strong"),r(),s(58," Centrar en Mapa "),r(),o(59,"button",74),_("click",function(){g(e);let i=b();return f(i.generateKilometrosForFrente(i.selectedFrente))}),o(60,"mat-icon"),s(61,"timeline"),r(),s(62," Generar Kil\xF3metros "),r(),o(63,"button",75),_("click",function(){g(e);let i=b();return f(i.editFrente(i.selectedFrente))}),o(64,"mat-icon"),s(65,"edit"),r(),s(66," Editar Frente "),r(),o(67,"button",76),_("click",function(){g(e);let i=b();return f(i.deleteFrente(i.selectedFrente))}),o(68,"mat-icon"),s(69,"delete"),r(),s(70," Eliminar "),r()()()}if(a&2){let e=b();d(3),z("color",e.getFrenteIconColor(e.selectedFrente.estado)),d(),x(" ",e.getFrenteIcon(e.selectedFrente.estado)," "),d(2),D(e.selectedFrente.nombre),d(2),h("ngClass","estado-"+e.selectedFrente.estado),d(),x(" ",e.getEstadoLabel(e.selectedFrente.estado)," "),d(10),ue("Ubicaci\xF3n: ",e.selectedFrente.ubicacion_lat==null?null:e.selectedFrente.ubicacion_lat.toFixed(6),", ",e.selectedFrente.ubicacion_lng==null?null:e.selectedFrente.ubicacion_lng.toFixed(6),""),d(),h("ngIf",e.selectedFrente.descripcion),d(5),x("Progreso General: ",e.getProgresoPromedio(e.selectedFrente.id).toFixed(1),"%"),d(7),D(e.getActividadesByFrente(e.selectedFrente.id).length),d(5),D(e.getActividadesEnProgreso(e.selectedFrente.id)),d(5),D(e.getActividadesCompletadas(e.selectedFrente.id)),d(5),x("",e.getProgresoPromedio(e.selectedFrente.id).toFixed(1),"%"),d(4),h("routerLink",ze(17,bi))("queryParams",Ie(18,wi,e.selectedFrente.id)),d(8),h("disabled",!e.selectedFrente.km_inicial||!e.selectedFrente.km_final)}}var Kn=(()=>{class a{constructor(e,t,i,n,c,l,u,v){this.mapService=e,this.actividadesService=t,this.authService=i,this.kilometrosService=n,this.snackBar=c,this.dialog=l,this.router=u,this.directAuthService=v,this.destroy$=new O,this.markers=new p.LayerGroup,this.kilometroLayers=new p.LayerGroup,this.actividadLayers=new p.LayerGroup,this.loading=!0,this.sidenavOpened=!0,this.selectedFrente=null,this.isCreatingFrente=!1,this.tempMarker=null,this.isDragMode=!1,this.showKilometricView=!1,this.showActividadTraces=!0,this.frentes=[],this.actividades=[],this.filteredFrente=[],this.kilometros=[],this.estadosConfig=[],this.estadoFilter="todos",this.tipoFilter="todos",this.searchTerm="",this.estadosFrente=[{value:"todos",label:"Todos los Estados"},{value:"activo",label:"Activo"},{value:"pausado",label:"Pausado"},{value:"completado",label:"Completado"},{value:"planificado",label:"Planificado"}],this.tiposActividad=[{value:"todos",label:"Todos los Tipos"},{value:"excavacion",label:"Excavaci\xF3n"},{value:"pavimentacion",label:"Pavimentaci\xF3n"},{value:"se\xF1alizacion",label:"Se\xF1alizaci\xF3n"},{value:"drenaje",label:"Drenaje"},{value:"puentes",label:"Puentes y Estructuras"},{value:"mantenimiento",label:"Mantenimiento"}]}ngOnInit(){return k(this,null,function*(){console.log("\u{1F5FA}\uFE0F [MapaComponent] Inicializando componente de mapa"),this.loading=!0;try{if(!this.directAuthService.getCurrentUser()){console.warn("\u26A0\uFE0F [MapaComponent] Usuario no autenticado, mostrando mapa b\xE1sico"),this.snackBar.open("Para ver los frentes y actividades, inicia sesi\xF3n","Ir a Login",{duration:8e3,panelClass:["warning-snackbar"]}).onAction().subscribe(()=>{this.router.navigate(["/login"])}),this.initializeMap(),this.loading=!1;return}yield this.loadData(),this.initializeMap(),this.actividadesService.progresoUpdated$.pipe(M(this.destroy$)).subscribe(({actividadId:t,progreso:i})=>{console.log(`[MAPA] Progreso actualizado para actividad ${t}: ${i}%`),this.updateActividadTraces()}),this.showKilometricView&&(yield this.loadKilometricData()),this.showActividadTraces&&(yield this.updateActividadTraces())}catch(e){console.error("\u274C [MapaComponent] Error al inicializar:",e),this.snackBar.open("Error al cargar los datos del mapa","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.loading=!1}})}ngAfterViewInit(){setTimeout(()=>{this.map||this.initializeMap()},100)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.map&&this.map.remove()}loadData(){return k(this,null,function*(){try{if(this.loading=!0,!this.directAuthService.getCurrentUser()){console.warn("\u26A0\uFE0F [LoadData] Usuario no autenticado, no se pueden cargar datos");return}this.actividadesService.frentes$.pipe(M(this.destroy$)).subscribe(t=>{console.log(`\u{1F4CD} [LoadData] ${t.length} frentes recibidos`),t.forEach(i=>{console.log(`\u{1F4CD} [LoadData] Frente: ${i.nombre} - Estado: ${i.estado} - Coords: ${i.ubicacion_lat}, ${i.ubicacion_lng}`)}),this.frentes=t,this.applyFilters(),this.updateMapMarkers()}),this.actividadesService.actividades$.pipe(M(this.destroy$)).subscribe(t=>{console.log(`\u{1F527} [LoadData] ${t.length} actividades recibidas`),this.actividades=t,this.updateMapMarkers()}),console.log("\u{1F504} [LoadData] Refrescando datos del servicio..."),yield this.actividadesService.refresh(),console.log("\u2705 [LoadData] Datos del servicio refrescados"),console.log("\u{1F4CF} [LoadData] Iniciando carga de datos kilom\xE9tricos..."),yield this.loadKilometricData(),console.log("\u2705 [LoadData] Datos kilom\xE9tricos cargados")}catch(e){console.error("\u274C [LoadData] Error loading map data:",e),this.snackBar.open("Error al cargar los datos del mapa. Verifica tu conexi\xF3n e inicia sesi\xF3n.","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}finally{this.loading=!1,console.log("\u2705 [LoadData] Carga de datos completada")}})}initializeMap(){try{if(console.log("\u{1F5FA}\uFE0F [MapaComponent] Iniciando inicializaci\xF3n del mapa"),!document.getElementById("map")){console.error("\u274C [MapaComponent] Contenedor del mapa no encontrado");return}this.map&&(console.log("\u{1F5FA}\uFE0F [MapaComponent] Removiendo mapa existente"),this.map.remove());try{delete p.Icon.Default.prototype._getIconUrl,p.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]})}catch(t){console.warn("\u26A0\uFE0F [MapaComponent] Error configurando iconos, usando iconos por defecto:",t)}setTimeout(()=>{try{this.map=p.map("map",{center:[4.5709,-74.2973],zoom:6,zoomControl:!0,attributionControl:!0,preferCanvas:!1,fadeAnimation:!1,zoomAnimation:!1,markerZoomAnimation:!1});let t=p.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"\xA9 OpenStreetMap contributors",maxZoom:19,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="});t.on("tileerror",i=>{console.warn("\u26A0\uFE0F [MapaComponent] Error cargando tile:",i)}),t.addTo(this.map),this.markers=new p.LayerGroup,this.kilometroLayers=new p.LayerGroup,this.actividadLayers=new p.LayerGroup,this.markers.addTo(this.map),this.kilometroLayers.addTo(this.map),this.actividadLayers.addTo(this.map),this.map.on("click",i=>{this.isCreatingFrente?this.handleMapClickForFrente(i):this.selectedFrente=null}),this.map.on("error",i=>{console.error("\u274C [MapaComponent] Error del mapa:",i)}),console.log("\u2705 [MapaComponent] Mapa inicializado correctamente"),this.frentes&&this.frentes.length>0&&this.updateMapMarkers(),this.showActividadTraces&&this.updateActividadTraces()}catch(t){throw console.error("\u274C [MapaComponent] Error creando instancia del mapa:",t),t}},50)}catch(e){console.error("\u274C [MapaComponent] Error cr\xEDtico inicializando mapa:",e),this.snackBar.open("Error al inicializar el mapa. Recarga la p\xE1gina.","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}}updateMapMarkers(){if(this.map&&(this.markers.clearLayers(),this.filteredFrente.forEach(e=>{if(e.ubicacion_lat&&e.ubicacion_lng){let t=this.isDragMode?this.createDraggableFrenteMarker(e):this.createFrenteMarker(e);this.markers.addLayer(t)}}),this.filteredFrente.length>0)){let e=new p.FeatureGroup(this.markers.getLayers());e.getBounds().isValid()&&this.map.fitBounds(e.getBounds(),{padding:[20,20]})}}createFrenteMarker(e){let i=this.actividades.filter(v=>v.frente_id===e.id).filter(v=>v.estado==="ejecucion").length,n=this.getFrenteIconColor(e.estado),c=p.divIcon({html:`
        <div class="custom-marker-container" style="background-color: ${n}; border: 2px solid white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">
          <span style="color: white; font-weight: bold; font-size: 12px;">${this.getFrenteIconText(e.estado)}</span>
          ${i>0?`<div class="activity-badge" style="position: absolute; top: -5px; right: -5px; background: #ff4444; color: white; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold;">${i}</div>`:""}
        </div>
      `,className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15]}),l=p.marker([e.ubicacion_lat,e.ubicacion_lng],{icon:c}),u=this.createFrentePopup(e);return l.bindPopup(u,{maxWidth:300}),l.on("click",()=>{this.selectedFrente=e,this.sidenavOpened=!0}),l}createFrentePopup(e){let t=this.getActividadesByFrente(e.id),i=t.filter(l=>l.estado==="finalizado").length,n=t.filter(l=>l.estado==="ejecucion").length,c=t.length>0?Math.round(i/t.length*100):0;return`
      <div class="frente-popup">
        <h3>${e.nombre}</h3>
        <p><strong>Estado:</strong> <span class="estado-${e.estado}">${this.getEstadoLabel(e.estado)}</span></p>
        <p><strong>Ubicaci\xF3n:</strong> ${e.ubicacion_lat?.toFixed(4)||"N/A"}, ${e.ubicacion_lng?.toFixed(4)||"N/A"}</p>
        <div class="actividades-summary">
          <h4>Actividades:</h4>
          <p>Total: ${t.length}</p>
          <p>En progreso: ${n}</p>
          <p>Completadas: ${i}</p>
          <p>Progreso promedio: ${c.toFixed(1)}%</p>
        </div>
        ${e.descripcion?`<p><strong>Descripci\xF3n:</strong> ${e.descripcion}</p>`:""}
      </div>
    `}getFrenteIconColor(e){return{activo:"#4caf50",pausado:"#ff9800",completado:"#2196f3",planificado:"#9e9e9e"}[e]||"#9e9e9e"}getFrenteIconText(e){return{activo:"A",pausado:"P",completado:"C",planificado:"PL"}[e]||"F"}getFrenteIcon(e){return{activo:"construction",pausado:"pause_circle",completado:"check_circle",planificado:"schedule"}[e]||"location_on"}getFrenteMarkerIcon(e){let t=this.getFrenteIconColor(e);return p.divIcon({html:`
        <div class="custom-marker-container" style="background-color: ${t}; border: 2px solid white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">
          <span style="color: white; font-weight: bold; font-size: 12px;">${this.getFrenteIconText(e)}</span>
        </div>
      `,className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15]})}getEstadoLabel(e){return{activo:"Activo",pausado:"Pausado",completado:"Completado",planificado:"Planificado"}[e]||e}applyFilters(){this.filteredFrente=this.frentes.filter(e=>{let t=this.estadoFilter==="todos"||e.estado===this.estadoFilter,i=!this.searchTerm||e.nombre.toLowerCase().includes(this.searchTerm.toLowerCase())||e.descripcion?.toLowerCase().includes(this.searchTerm.toLowerCase()),n=this.tipoFilter==="todos";return n||(n=this.actividades.filter(l=>l.frente_id===e.id).some(l=>l.tipo_actividad===this.tipoFilter)),t&&i&&n}),this.updateMapMarkers()}onEstadoFilterChange(){this.applyFilters()}onTipoFilterChange(){this.applyFilters()}onSearchChange(){this.applyFilters()}centerOnFrente(e){e.ubicacion_lat&&e.ubicacion_lng&&(this.map.setView([e.ubicacion_lat,e.ubicacion_lng],15),this.selectedFrente=e)}toggleSidenav(){this.sidenavOpened=!this.sidenavOpened}getActividadesByFrente(e){return this.actividades.filter(t=>t.frente_id===e)}getProgresoPromedio(e){let t=this.getActividadesByFrente(e);if(t.length===0)return 0;let i=t.filter(n=>n.estado==="finalizado").length;return Math.round(i/t.length*100)}getActividadesEnProgreso(e){return this.getActividadesByFrente(e).filter(t=>t.estado==="ejecucion").length}getActividadesCompletadas(e){return this.getActividadesByFrente(e).filter(t=>t.estado==="finalizado").length}getEstadoColor(e){return{activo:"primary",pausado:"warn",completado:"accent",planificado:""}[e]||""}refreshData(){this.loadData()}loadKilometricData(){return k(this,null,function*(){console.log("\u{1F4CA} [MapaComponent] Cargando datos kilom\xE9tricos"),console.log("\u{1F4CA} [MapaComponent] Frentes disponibles:",this.frentes.length);try{this.kilometrosService.getKilometros().subscribe({next:e=>{console.log("\u{1F4CA} [MapaComponent] Kil\xF3metros cargados:",e.length),console.log("\u{1F4CA} [MapaComponent] Datos kil\xF3metros:",e),this.kilometros=e;let t=e.filter(i=>i.color&&i.color!=="#6B7280");console.log("\u{1F4CA} [MapaComponent] Kil\xF3metros con color espec\xEDfico:",t.length),this.showKilometricView?(console.log("\u{1F4CA} [MapaComponent] Vista kilom\xE9trica activa, actualizando visualizaci\xF3n"),this.updateKilometricVisualization()):console.log("\u{1F4CA} [MapaComponent] Vista kilom\xE9trica no activa")},error:e=>{console.error("\u274C [MapaComponent] Error al cargar kil\xF3metros:",e),this.snackBar.open("Error al cargar datos kilom\xE9tricos","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}catch(e){console.error("\u274C [MapaComponent] Error en loadKilometricData:",e)}})}toggleKilometricView(){return k(this,null,function*(){this.showKilometricView=!this.showKilometricView,this.showKilometricView?(yield this.loadKilometricData(),this.updateKilometricVisualization(),this.snackBar.open("Vista kilom\xE9trica activada - Datos actualizados","Cerrar",{duration:3e3,panelClass:["success-snackbar"]})):(this.kilometroLayers.clearLayers(),this.snackBar.open("Vista kilom\xE9trica desactivada","Cerrar",{duration:3e3,panelClass:["info-snackbar"]}))})}updateKilometricVisualization(){if(console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Iniciando actualizaci\xF3n de visualizaci\xF3n"),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Map exists:",!!this.map),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Show kilometric view:",this.showKilometricView),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Kil\xF3metros disponibles:",this.kilometros.length),!this.map||!this.showKilometricView){console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Saliendo: mapa no existe o vista kilom\xE9trica desactivada");return}this.kilometroLayers.clearLayers(),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Capas kilom\xE9tricas limpiadas");let e=this.groupKilometrosByFrente();console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Kil\xF3metros agrupados por frente:",Object.keys(e).length),Object.entries(e).forEach(([t,i])=>{let n=this.frentes.find(c=>c.id===t);console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Procesando frente:",t),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Frente encontrado:",!!n),n&&(console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Coordenadas inicio:",n.coordenadas_inicio),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Coordenadas fin:",n.coordenadas_fin),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Kil\xF3metros en frente:",i.length)),n&&n.coordenadas_inicio&&n.coordenadas_fin?(console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Creando ruta kilom\xE9trica para frente:",n.nombre),this.createKilometricRoute(n,i)):console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Frente no tiene coordenadas completas:",n?.nombre||"Frente no encontrado")}),console.log("\u{1F5FA}\uFE0F [UpdateKilometricVisualization] Visualizaci\xF3n kilom\xE9trica completada")}groupKilometrosByFrente(){return this.kilometros.reduce((e,t)=>(e[t.frente_id]||(e[t.frente_id]=[]),e[t.frente_id].push(t),e),{})}createKilometricRoute(e,t){if(!e.coordenadas_inicio||!e.coordenadas_fin)return;let i=this.getRoutePoints(e),n=p.polyline(i,{color:"#cccccc",weight:8,opacity:.7});this.kilometroLayers.addLayer(n),t.sort((c,l)=>c.kilometro-l.kilometro).forEach((c,l)=>{let u=this.interpolateAlongCurve(e,c.kilometro);if(!u)return;let v=null;if(l<t.length-1?v=this.interpolateAlongCurve(e,t[l+1].kilometro):e.coordenadas_fin&&(v=[e.coordenadas_fin.lat,e.coordenadas_fin.lng]),v){let oe=this.getSegmentPoints(e,c.kilometro,l<t.length-1?t[l+1].kilometro:e.km_final),W=p.polyline(oe,{color:c.color,weight:6,opacity:.9}),ti=this.createKilometroPopup(c,e);W.bindPopup(ti),this.kilometroLayers.addLayer(W)}let C=p.circleMarker(u,{radius:8,fillColor:c.color,color:"#ffffff",weight:2,opacity:1,fillOpacity:.8}),F=this.createKilometroPopup(c,e);C.bindPopup(F),this.kilometroLayers.addLayer(C)}),e.coordenadas_intermedias&&e.coordenadas_intermedias.length>0&&e.coordenadas_intermedias.forEach((c,l)=>{let u=p.circleMarker([c.lat,c.lng],{radius:6,fillColor:"#ff9800",color:"#ffffff",weight:2,opacity:1,fillOpacity:.8});u.bindPopup(`
          <div class="control-point-popup">
            <h4>Punto de Control ${l+1}</h4>
            <p><strong>Kilometraje:</strong> ${c.kilometraje}</p>
            <p><strong>Coordenadas:</strong> ${c.lat.toFixed(6)}, ${c.lng.toFixed(6)}</p>
          </div>
        `),this.kilometroLayers.addLayer(u)})}getSegmentPoints(e,t,i){let n=[],c=this.getRoutePoints(e);if(!e.km_inicial||!e.km_final)return n;if(!e.coordenadas_intermedias||e.coordenadas_intermedias.length===0){let C=this.interpolateAlongCurve(e,t),F=this.interpolateAlongCurve(e,i);return C&&F&&n.push(C,F),n}let l=[];e.coordenadas_inicio&&e.km_inicial&&l.push({lat:e.coordenadas_inicio.lat,lng:e.coordenadas_inicio.lng,kilometraje:e.km_inicial}),l.push(...e.coordenadas_intermedias),e.coordenadas_fin&&e.km_final&&l.push({lat:e.coordenadas_fin.lat,lng:e.coordenadas_fin.lng,kilometraje:e.km_final}),l.sort((C,F)=>C.kilometraje-F.kilometraje);let u=this.interpolateAlongCurve(e,t);u&&n.push(u),l.forEach(C=>{C.kilometraje>t&&C.kilometraje<i&&n.push([C.lat,C.lng])});let v=this.interpolateAlongCurve(e,i);return v&&n.push(v),n}interpolateAlongCurve(e,t){if(!e.coordenadas_inicio||!e.coordenadas_fin||!e.km_inicial||!e.km_final)return null;let i=[];i.push({lat:e.coordenadas_inicio.lat,lng:e.coordenadas_inicio.lng,kilometraje:e.km_inicial}),e.coordenadas_intermedias&&e.coordenadas_intermedias.length>0&&i.push(...e.coordenadas_intermedias),i.push({lat:e.coordenadas_fin.lat,lng:e.coordenadas_fin.lng,kilometraje:e.km_final}),i.sort((l,u)=>l.kilometraje-u.kilometraje);for(let l=0;l<i.length-1;l++){let u=i[l],v=i[l+1];if(t>=u.kilometraje&&t<=v.kilometraje){let C=v.kilometraje-u.kilometraje,F=C>0?(t-u.kilometraje)/C:0;return this.interpolatePoint([u.lat,u.lng],[v.lat,v.lng],F)}}let n=e.km_final-e.km_inicial,c=n>0?(t-e.km_inicial)/n:0;return this.interpolatePoint([e.coordenadas_inicio.lat,e.coordenadas_inicio.lng],[e.coordenadas_fin.lat,e.coordenadas_fin.lng],c)}getRoutePoints(e){if(!e.coordenadas_inicio||!e.coordenadas_fin)return[];let t=[];return t.push([e.coordenadas_inicio.lat,e.coordenadas_inicio.lng]),e.coordenadas_intermedias&&e.coordenadas_intermedias.length>0&&[...e.coordenadas_intermedias].sort((n,c)=>n.kilometraje-c.kilometraje).forEach(n=>{t.push([n.lat,n.lng])}),t.push([e.coordenadas_fin.lat,e.coordenadas_fin.lng]),t}createKilometroPopup(e,t){return`
      <div class="kilometro-popup">
        <h4>Kil\xF3metro ${e.kilometro}</h4>
        <p><strong>Frente:</strong> ${t.nombre}</p>
        <p><strong>Estado:</strong> <span style="color: ${e.color}">${e.estado}</span></p>
        <p><strong>Progreso:</strong> ${e.progreso_porcentaje}%</p>
        <p><strong>Actividades:</strong> ${e.actividades_count}</p>
        <p><strong>\xDAltima actualizaci\xF3n:</strong> ${new Date(e.fecha_ultima_actualizacion).toLocaleDateString()}</p>
      </div>
    `}generateKilometrosForFrente(e){return k(this,null,function*(){if(!e.km_inicial||!e.km_final){this.snackBar.open("El frente debe tener rangos kilom\xE9tricos definidos","Cerrar",{duration:5e3,panelClass:["error-snackbar"]});return}try{yield this.kilometrosService.generateKilometrosForFrente(e.id,e.km_inicial,e.km_final).toPromise(),this.snackBar.open("Kil\xF3metros generados exitosamente","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),yield this.loadKilometricData()}catch{this.snackBar.open("Error al generar kil\xF3metros","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}startCreatingFrente(){this.isCreatingFrente=!0,this.snackBar.open("Haz clic en el mapa para seleccionar la ubicaci\xF3n del frente","Cancelar",{duration:0,panelClass:["info-snackbar"]}).onAction().subscribe(()=>{this.cancelFrenteCreation()})}cancelFrenteCreation(){this.isCreatingFrente=!1,this.tempMarker&&(this.map.removeLayer(this.tempMarker),this.tempMarker=null),this.snackBar.dismiss()}handleMapClickForFrente(e){let{lat:t,lng:i}=e.latlng;this.tempMarker&&this.map.removeLayer(this.tempMarker),this.tempMarker=p.marker([t,i],{icon:p.divIcon({html:`
          <div style="background-color: #ff9800; border: 2px solid white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 4px rgba(0,0,0,0.3);">
            <span style="color: white; font-weight: bold; font-size: 14px;">+</span>
          </div>
        `,className:"temp-div-icon",iconSize:[30,30],iconAnchor:[15,15]})}).addTo(this.map),this.openFrenteForm("create",{lat:t,lng:i})}openFrenteForm(e,t,i){let n={mode:e,frente:i,initialCoordinates:t};this.dialog.open(Yt,{width:"600px",maxWidth:"90vw",data:n,disableClose:!0}).afterClosed().subscribe(l=>{l&&this.refreshData(),e==="create"&&this.cancelFrenteCreation()})}editFrente(e){this.openFrenteForm("edit",void 0,e)}deleteFrente(e){return k(this,null,function*(){if(confirm(`\xBFEst\xE1s seguro de que deseas eliminar el frente "${e.nombre}"?`))try{yield this.actividadesService.deleteFrente(e.id),this.snackBar.open("Frente eliminado exitosamente","Cerrar",{duration:3e3,panelClass:["success-snackbar"]}),this.refreshData(),this.selectedFrente?.id===e.id&&(this.selectedFrente=null)}catch{this.snackBar.open("Error al eliminar el frente","Cerrar",{duration:5e3,panelClass:["error-snackbar"]})}})}createDraggableFrenteMarker(e){let t=p.marker([e.ubicacion_lat,e.ubicacion_lng],{icon:this.getFrenteMarkerIcon(e.estado),draggable:!0});return t.bindPopup(this.createFrentePopup(e)),t.on("dragend",i=>k(this,null,function*(){let n=i.target.getLatLng();try{yield this.actividadesService.updateFrenteLocation(e.id,n.lat,n.lng),this.snackBar.open("Ubicaci\xF3n del frente actualizada","Cerrar",{duration:3e3,panelClass:["success-snackbar"]});let c=this.frentes.findIndex(l=>l.id===e.id);c!==-1&&(this.frentes[c]=Me(xe({},this.frentes[c]),{ubicacion_lat:n.lat,ubicacion_lng:n.lng}),this.applyFilters())}catch(c){console.error("\u274C [MapaComponent] Error updating frente location:",c),this.snackBar.open("Error al actualizar la ubicaci\xF3n","Cerrar",{duration:5e3,panelClass:["error-snackbar"]}),t.setLatLng([e.ubicacion_lat,e.ubicacion_lng])}})),t}toggleDragMode(){this.isDragMode=!this.isDragMode;let e=this.isDragMode?"Modo arrastrar activado - Puedes mover los frentes arrastrando los marcadores":"Modo arrastrar desactivado";this.snackBar.open(e,"Cerrar",{duration:3e3,panelClass:["info-snackbar"]}),this.updateMapMarkers()}navigateToCreateFrente(){this.router.navigate(["/frentes/nuevo"])}navigateToEditFrente(e){this.router.navigate(["/frentes",e,"editar"])}navigateToFrentesManagement(){this.router.navigate(["/frentes"])}updateActividadTraces(){return k(this,null,function*(){if(console.log("\u{1F3AF} [UpdateActividadTraces] Iniciando actualizaci\xF3n de trazos de actividades"),!this.map||!this.showActividadTraces){console.log("\u{1F3AF} [UpdateActividadTraces] Saliendo: mapa no existe o trazos desactivados");return}this.actividadLayers.clearLayers(),console.log("\u{1F3AF} [UpdateActividadTraces] Trazos existentes limpiados");let e=this.actividades.filter(t=>t.ubicacion_inicio?.lat&&t.ubicacion_inicio?.lng&&t.ubicacion_fin?.lat&&t.ubicacion_fin?.lng);console.log("\u{1F3AF} [UpdateActividadTraces] Actividades con trazos:",e.length);for(let t of e)try{let i=yield this.calcularProgresoActividad(t.id);yield this.createActividadTrace(t,i)}catch(i){console.error("\u274C [UpdateActividadTraces] Error procesando actividad:",t.id,i)}console.log("\u2705 [UpdateActividadTraces] Trazos de actividades actualizados")})}calcularProgresoActividad(e){return k(this,null,function*(){try{let t=yield this.actividadesService.getTareasByActividad(e);if(t.length===0)return 0;let i=t.filter(c=>c.completada).length,n=Math.round(i/t.length*100);return console.log(`\u{1F4CA} [CalcProgreso] Actividad ${e}: ${i}/${t.length} tareas = ${n}%`),n}catch(t){return console.error("\u274C [CalcProgreso] Error calculando progreso:",t),0}})}createActividadTrace(e,t){return k(this,null,function*(){if(!e.ubicacion_inicio||!e.ubicacion_fin)return;let i=[e.ubicacion_inicio.lat,e.ubicacion_inicio.lng],n=[e.ubicacion_fin.lat,e.ubicacion_fin.lng],c=this.getActividadTraceColor(e.estado,t),l=this.getActividadTraceOpacity(t),u=p.polyline([i,n],{color:c,weight:6,opacity:l,dashArray:t<100?"10, 5":void 0});if(t>0){let oe=this.interpolatePoint(i,n,t/100),W=p.polyline([i,oe],{color:"#22c55e",weight:8,opacity:.8});this.actividadLayers.addLayer(W)}this.actividadLayers.addLayer(u);let v=p.circleMarker(i,{radius:8,fillColor:"#3b82f6",color:"white",weight:2,opacity:1,fillOpacity:.8}),C=p.circleMarker(n,{radius:8,fillColor:t>=100?"#22c55e":"#ef4444",color:"white",weight:2,opacity:1,fillOpacity:.8}),F=this.createActividadTooltip(e,t);u.bindTooltip(F,{permanent:!1,direction:"top",className:"actividad-tooltip"}),v.bindTooltip("Inicio: "+e.tipo_actividad,{permanent:!1,direction:"top"}),C.bindTooltip(`Fin: ${t}% completado`,{permanent:!1,direction:"top"}),this.actividadLayers.addLayer(v),this.actividadLayers.addLayer(C),u.on("click",()=>{this.showActividadDetails(e,t)})})}getActividadTraceColor(e,t){return t===0?"#ef4444":t>=1&&t<=50?"#eab308":t>=51&&t<=80?"#f97316":t>=81&&t<=100?"#22c55e":"#6b7280"}getActividadTraceOpacity(e){return Math.max(.4,e/100*.8+.2)}interpolatePoint(e,t,i){let n=e[0]+(t[0]-e[0])*i,c=e[1]+(t[1]-e[1])*i;return[n,c]}createActividadTooltip(e,t){let i=this.getEstadoLabel(e.estado),n=new Date(e.fecha).toLocaleDateString("es-ES");return`
<div class="actividad-tooltip-content">
<h4>${e.tipo_actividad}</h4>
<p><strong>Estado:</strong> ${i}</p>
<p><strong>Progreso:</strong> ${t}%</p>
<p><strong>Fecha:</strong> ${n}</p>
${e.responsable?`<p><strong>Responsable:</strong> ${e.responsable}</p>`:""}
<p><em>Click para ver detalles</em></p>
</div>
`}showActividadDetails(e,t){let i=`
Actividad: ${e.tipo_actividad}
Estado: ${this.getEstadoLabel(e.estado)}
Progreso: ${t}%
Fecha: ${new Date(e.fecha).toLocaleDateString("es-ES")}
${e.responsable?`Responsable: ${e.responsable}`:""}
`;this.snackBar.open(i,"Ver Detalles",{duration:8e3,panelClass:["info-snackbar"]})}toggleActividadTraces(){return k(this,null,function*(){this.showActividadTraces=!this.showActividadTraces,this.showActividadTraces?(console.log("\u{1F3AF} [ToggleTraces] Activando trazos de actividades"),yield this.updateActividadTraces(),this.snackBar.open("Trazos de actividades activados","Cerrar",{duration:3e3,panelClass:["success-snackbar"]})):(console.log("\u{1F3AF} [ToggleTraces] Desactivando trazos de actividades"),this.actividadLayers.clearLayers(),this.snackBar.open("Trazos de actividades desactivados","Cerrar",{duration:3e3,panelClass:["info-snackbar"]}))})}static{this.\u0275fac=function(t){return new(t||a)(S(qt),S(Vt),S(Kt),S(Jt),S(xt),S(Lt),S($e),S(yt))}}static{this.\u0275cmp=T({type:a,selectors:[["app-mapa"]],decls:80,vars:25,consts:[["frenteMenu","matMenu"],["sidenav",""],[1,"mapa-container"],[1,"toolbar-card"],[1,"toolbar-content"],[1,"toolbar-left"],["mat-icon-button","","matTooltip","Alternar panel de filtros",3,"click"],[1,"page-title"],[1,"toolbar-right"],["mat-raised-button","","matTooltip","Mostrar/ocultar trazos de actividades",3,"click","color","disabled"],["mat-raised-button","","color","primary","matTooltip","Crear nuevo frente",3,"click","disabled"],["mat-icon-button","","matTooltip","Opciones de frentes",3,"matMenuTriggerFor","disabled"],["mat-menu-item","",3,"click"],[3,"color"],["color","accent","selected","",4,"ngIf"],[1,"main-container"],[1,"sidenav-container"],["mode","side",1,"filters-sidenav",3,"opened"],[1,"sidenav-content"],[1,"sidenav-header"],["mat-icon-button","",3,"click"],[1,"filters-section"],["appearance","outline",1,"full-width"],["matInput","","placeholder","Nombre o descripci\xF3n",3,"ngModelChange","input","ngModel"],["matSuffix",""],[3,"valueChange","selectionChange","value"],[3,"value",4,"ngFor","ngForOf"],[1,"frentes-section"],["class","loading-container",4,"ngIf"],[4,"ngIf"],["class","no-results",4,"ngIf"],[1,"map-content"],[1,"map-container"],["id","map",1,"leaflet-map"],["class","map-loading-overlay",4,"ngIf"],["class","creating-frente-overlay",4,"ngIf"],["class","frente-info-card",4,"ngIf"],["color","accent","selected",""],[3,"value"],[1,"loading-container"],["diameter","40"],["class","frente-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"frente-item",3,"click"],["matListItemAvatar",""],["matBadgeColor","accent","matBadgeSize","small",3,"matBadge","matBadgeHidden"],["matListItemTitle",""],["matListItemLine",""],[1,"estado-chip",3,"ngClass"],[1,"ubicacion"],["matListItemLine","",1,"progress-info"],["mat-icon-button","","matListItemMeta","",3,"click"],[1,"no-results"],["class","auth-message",4,"ngIf"],[1,"auth-message"],[1,"map-loading-overlay"],["diameter","60"],[1,"creating-frente-overlay"],[1,"creating-frente-card"],[1,"creating-frente-content"],["color","primary"],["mat-raised-button","","color","warn",3,"click"],[1,"frente-info-card"],["mat-card-avatar",""],["mat-icon-button","",1,"close-button",3,"click"],[1,"frente-details"],[1,"detail-row"],["class","detail-row",4,"ngIf"],[1,"actividades-stats"],[1,"stats-grid"],[1,"stat-item"],[1,"stat-number"],[1,"stat-label"],["mat-button","","color","primary",3,"routerLink","queryParams"],["mat-button","",3,"click"],["mat-button","","color","accent","matTooltip","Generar kil\xF3metros para este frente",3,"click","disabled"],["mat-button","","color","accent",3,"click"],["mat-button","","color","warn",3,"click"]],template:function(t,i){if(t&1){let n=A();o(0,"div",2)(1,"mat-card",3)(2,"mat-card-content")(3,"div",4)(4,"div",5)(5,"button",6),_("click",function(){return g(n),f(i.toggleSidenav())}),o(6,"mat-icon"),s(7,"menu"),r()(),o(8,"h2",7),s(9,"Mapa Interactivo de Frentes"),r()(),o(10,"div",8)(11,"button",9),_("click",function(){return g(n),f(i.toggleActividadTraces())}),o(12,"mat-icon"),s(13),r(),s(14),r(),o(15,"button",10),_("click",function(){return g(n),f(i.startCreatingFrente())}),o(16,"mat-icon"),s(17,"add_location"),r(),s(18),r(),o(19,"button",11)(20,"mat-icon"),s(21,"more_vert"),r()(),o(22,"mat-menu",null,0)(24,"button",12),_("click",function(){return g(n),f(i.toggleDragMode())}),o(25,"mat-icon",13),s(26,"open_with"),r(),o(27,"span"),s(28),r()(),o(29,"button",12),_("click",function(){return g(n),f(i.refreshData())}),o(30,"mat-icon"),s(31,"refresh"),r(),o(32,"span"),s(33,"Actualizar Datos"),r()()(),o(34,"mat-chip-set")(35,"mat-chip"),s(36),r(),y(37,Ci,4,0,"mat-chip",14),r()()()()(),o(38,"div",15)(39,"mat-sidenav-container",16)(40,"mat-sidenav",17,1)(42,"div",18)(43,"div",19)(44,"h3"),s(45,"Filtros y Frentes"),r(),o(46,"button",20),_("click",function(){return g(n),f(i.toggleSidenav())}),o(47,"mat-icon"),s(48,"close"),r()()(),o(49,"div",21)(50,"h4"),s(51,"Filtros"),r(),o(52,"mat-form-field",22)(53,"mat-label"),s(54,"Buscar frente"),r(),o(55,"input",23),X("ngModelChange",function(l){return g(n),J(i.searchTerm,l)||(i.searchTerm=l),f(l)}),_("input",function(){return g(n),f(i.onSearchChange())}),r(),o(56,"mat-icon",24),s(57,"search"),r()(),o(58,"mat-form-field",22)(59,"mat-label"),s(60,"Estado"),r(),o(61,"mat-select",25),X("valueChange",function(l){return g(n),J(i.estadoFilter,l)||(i.estadoFilter=l),f(l)}),_("selectionChange",function(){return g(n),f(i.onEstadoFilterChange())}),y(62,xi,2,2,"mat-option",26),r()(),o(63,"mat-form-field",22)(64,"mat-label"),s(65,"Tipo de Actividad"),r(),o(66,"mat-select",25),X("valueChange",function(l){return g(n),J(i.tipoFilter,l)||(i.tipoFilter=l),f(l)}),_("selectionChange",function(){return g(n),f(i.onTipoFilterChange())}),y(67,Mi,2,2,"mat-option",26),r()()(),o(68,"div",27)(69,"h4"),s(70),r(),y(71,yi,4,0,"div",28)(72,Pi,2,1,"mat-nav-list",29)(73,Oi,6,1,"div",30),r()()(),o(74,"mat-sidenav-content",31)(75,"div",32),q(76,"div",33),y(77,Ei,4,0,"div",34)(78,Si,14,0,"div",35),r(),y(79,Ai,71,20,"mat-card",36),r()()()()}if(t&2){let n=De(23);d(11),h("color",i.showActividadTraces?"accent":"basic")("disabled",i.loading),d(2),D(i.showActividadTraces?"polyline":"timeline"),d(),x(" ",i.showActividadTraces?"Ocultar Trazos":"Mostrar Trazos"," "),d(),h("disabled",i.loading||i.isCreatingFrente),d(3),x(" ",i.isCreatingFrente?"Selecciona ubicaci\xF3n...":"Crear Frente"," "),d(),h("matMenuTriggerFor",n)("disabled",i.loading),d(6),h("color",i.isDragMode?"accent":""),d(3),x("",i.isDragMode?"Desactivar":"Activar"," Modo Arrastrar"),d(8),x("",i.filteredFrente.length," frentes"),d(),h("ngIf",i.isDragMode),d(3),h("opened",i.sidenavOpened),d(15),Y("ngModel",i.searchTerm),d(6),Y("value",i.estadoFilter),d(),h("ngForOf",i.estadosFrente),d(4),Y("value",i.tipoFilter),d(),h("ngForOf",i.tiposActividad),d(3),x("Frentes (",i.filteredFrente.length,")"),d(),h("ngIf",i.loading),d(),h("ngIf",!i.loading),d(),h("ngIf",!i.loading&&i.filteredFrente.length===0),d(4),h("ngIf",i.loading),d(),h("ngIf",i.isCreatingFrente),d(),h("ngIf",i.selectedFrente)}},dependencies:[Re,Be,Ve,je,Qe,Ne,We,Ge,Ue,Ke,rt,Xe,nt,ot,tt,at,it,et,gt,ut,ht,_t,ft,ei,Ce,Xt,ne,Zt,Ht,Qt,Gt,Nt,Ut,Wt,lt,dt,st,ct,$t,Rt,jt,mt,pt,Ft,kt,Pt,It,zt,Dt,At,bt,vt,Mt,Bt,Tt,Et,Ot,St],styles:[".mapa-container[_ngcontent-%COMP%]{height:100vh;display:flex;flex-direction:column;background-color:#fafafa}.toolbar-card[_ngcontent-%COMP%]{margin:0;border-radius:0;box-shadow:0 2px 4px #0000001a;z-index:1000}.toolbar-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0}.toolbar-left[_ngcontent-%COMP%], .toolbar-right[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.page-title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:500;color:#333}.main-container[_ngcontent-%COMP%]{flex:1;overflow:hidden}.sidenav-container[_ngcontent-%COMP%]{height:100%}.filters-sidenav[_ngcontent-%COMP%]{width:350px;border-right:1px solid #e0e0e0;background-color:#fff}.sidenav-content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;overflow:hidden}.sidenav-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;border-bottom:1px solid #e0e0e0;background-color:#1976d2;color:#fff}.sidenav-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;font-weight:500}.sidenav-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff}.filters-section[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid #e0e0e0}.filters-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:1rem;font-weight:500;color:#333}.full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.frentes-section[_ngcontent-%COMP%]{flex:1;overflow:hidden;display:flex;flex-direction:column}.frentes-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;padding:16px 16px 8px;font-size:1rem;font-weight:500;color:#333}.frentes-section[_ngcontent-%COMP%]   mat-nav-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto}.frente-item[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0;cursor:pointer;transition:background-color .2s ease}.frente-item[_ngcontent-%COMP%]:hover{background-color:#0000000a}.frente-item.selected[_ngcontent-%COMP%]{background-color:#1976d21f;border-left:4px solid #1976d2}.estado-chip[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;border-radius:12px;font-size:.75rem;font-weight:500;text-transform:uppercase;margin-right:8px}.estado-activo[_ngcontent-%COMP%]{background-color:#e8f5e8;color:#2e7d32}.estado-pausado[_ngcontent-%COMP%]{background-color:#fff3e0;color:#f57c00}.estado-completado[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.estado-planificado[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#616161}.kilometraje[_ngcontent-%COMP%]{font-size:.875rem;color:#666}.progress-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.75rem;color:#666;margin-top:4px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px;text-align:center}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666}.no-results[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px;text-align:center;color:#666}.no-results[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}.map-content[_ngcontent-%COMP%]{position:relative;height:100%}.map-container[_ngcontent-%COMP%]{position:relative;height:100%;width:100%}.leaflet-map[_ngcontent-%COMP%]{height:100%;width:100%;z-index:1}.map-loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background-color:#fffc;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}.map-loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:16px;color:#666}.frente-info-card[_ngcontent-%COMP%]{position:absolute;top:16px;right:16px;width:320px;max-height:calc(100vh - 200px);overflow-y:auto;z-index:1000;box-shadow:0 4px 12px #00000026}.frente-info-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{position:relative}.close-button[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px}.frente-details[_ngcontent-%COMP%]{margin-bottom:16px}.detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-bottom:8px;font-size:.875rem}.detail-row[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;color:#666;margin-top:2px}.actividades-stats[_ngcontent-%COMP%]{border-top:1px solid #e0e0e0;padding-top:16px}.actividades-stats[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:1rem;font-weight:500}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}.stat-item[_ngcontent-%COMP%]{text-align:center;padding:12px;background-color:#f5f5f5;border-radius:8px}.stat-number[_ngcontent-%COMP%]{display:block;font-size:1.5rem;font-weight:600;color:#1976d2}.stat-label[_ngcontent-%COMP%]{display:block;font-size:.75rem;color:#666;margin-top:4px}[_nghost-%COMP%]     .custom-div-icon{background:transparent;border:none}[_nghost-%COMP%]     .custom-marker{position:relative;width:40px;height:40px;background-color:#fff;border:3px solid #1976d2;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px #0000004d;transition:transform .2s ease}[_nghost-%COMP%]     .custom-marker:hover{transform:scale(1.1)}[_nghost-%COMP%]     .custom-marker.activo{border-color:#4caf50}[_nghost-%COMP%]     .custom-marker.pausado{border-color:#ff9800}[_nghost-%COMP%]     .custom-marker.completado{border-color:#2196f3}[_nghost-%COMP%]     .custom-marker.planificado{border-color:#9e9e9e}[_nghost-%COMP%]     .marker-icon{font-size:20px;color:#333}[_nghost-%COMP%]     .activity-badge{position:absolute;top:-8px;right:-8px;background-color:#f44336;color:#fff;border-radius:50%;width:20px;height:20px;display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:700;border:2px solid white}[_nghost-%COMP%]     .leaflet-pane .leaflet-overlay-pane{z-index:200!important}[_nghost-%COMP%]     .kilometro-route-line{z-index:300!important;pointer-events:auto!important}[_nghost-%COMP%]     .kilometro-segment{z-index:350!important;pointer-events:auto!important;stroke-width:6!important;stroke-opacity:.9!important}[_nghost-%COMP%]     .kilometro-marker{z-index:400!important;pointer-events:auto!important}[_nghost-%COMP%]     .leaflet-marker-pane .leaflet-marker-icon.kilometro-marker{z-index:1000!important}[_nghost-%COMP%]     .leaflet-overlay-pane svg .kilometro-circle{z-index:500!important;pointer-events:auto!important;fill-opacity:.8!important;stroke-opacity:1!important;stroke-width:2!important}[_nghost-%COMP%]     .leaflet-overlay-pane svg .kilometro-polyline{z-index:300!important;pointer-events:auto!important;stroke-opacity:.9!important;stroke-width:6!important}[_nghost-%COMP%]     .leaflet-popup.kilometro-popup{z-index:1200!important}[_nghost-%COMP%]     .kilometro-popup{min-width:200px;font-family:Roboto,sans-serif}[_nghost-%COMP%]     .kilometro-popup h4{margin:0 0 8px;color:#1976d2;font-size:1rem;font-weight:500}[_nghost-%COMP%]     .kilometro-popup p{margin:4px 0;font-size:.875rem;line-height:1.4}[_nghost-%COMP%]     .kilometro-popup .estado-badge{display:inline-block;padding:2px 8px;border-radius:12px;font-size:.75rem;font-weight:500;text-transform:uppercase;color:#fff}[_nghost-%COMP%]     .leaflet-popup-content{margin:8px 12px;line-height:1.4}[_nghost-%COMP%]     .frente-popup h3{margin:0 0 8px;color:#1976d2}[_nghost-%COMP%]     .frente-popup p{margin:4px 0;font-size:.875rem}[_nghost-%COMP%]     .actividades-summary{background-color:#f5f5f5;padding:8px;border-radius:4px;margin:8px 0}[_nghost-%COMP%]     .actividades-summary h4{margin:0 0 4px;font-size:.875rem}[_nghost-%COMP%]     .actividades-summary p{margin:2px 0;font-size:.75rem}.creating-frente-overlay[_ngcontent-%COMP%]{position:absolute;top:20px;left:50%;transform:translate(-50%);z-index:1000;pointer-events:none}.creating-frente-card[_ngcontent-%COMP%]{pointer-events:all;box-shadow:0 4px 12px #00000026;border-radius:8px}.creating-frente-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center;gap:12px}.creating-frente-content[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:2rem;width:2rem;height:2rem}.creating-frente-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:500}.creating-frente-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:.9rem}.toolbar-right[_ngcontent-%COMP%]   button[mat-raised-button][_ngcontent-%COMP%]{margin-right:8px}.toolbar-right[_ngcontent-%COMP%]   mat-menu[_ngcontent-%COMP%]{margin-top:8px}.frente-info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;padding:16px}.frente-info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:120px}.temp-marker[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.7}to{transform:scale(1);opacity:1}}@media (max-width: 768px){.filters-sidenav[_ngcontent-%COMP%]{width:100%}.toolbar-content[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:stretch}.toolbar-left[_ngcontent-%COMP%], .toolbar-right[_ngcontent-%COMP%]{justify-content:center}.toolbar-right[_ngcontent-%COMP%]{flex-wrap:wrap}.frente-info-card[_ngcontent-%COMP%]{position:relative;bottom:auto;right:auto;width:100%;margin:8px}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.creating-frente-overlay[_ngcontent-%COMP%]{left:10px;right:10px;transform:none}.frente-info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{flex-direction:column}.frente-info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.page-title[_ngcontent-%COMP%]{font-size:1.25rem}}@media (max-width: 480px){.filters-sidenav[_ngcontent-%COMP%]{width:100vw}.stats-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr);gap:8px}.stat-item[_ngcontent-%COMP%]{padding:8px 4px}.stat-number[_ngcontent-%COMP%]{font-size:1.25rem}}@media (prefers-color-scheme: dark){.mapa-container[_ngcontent-%COMP%]{background-color:#121212}.toolbar-card[_ngcontent-%COMP%]{background-color:#1e1e1e;color:#fff}.filters-sidenav[_ngcontent-%COMP%]{background-color:#1e1e1e;border-right-color:#333}.sidenav-header[_ngcontent-%COMP%]{background-color:#1976d2;border-bottom-color:#333}.filters-section[_ngcontent-%COMP%], .frente-item[_ngcontent-%COMP%]{border-bottom-color:#333}.frente-item[_ngcontent-%COMP%]:hover{background-color:#ffffff14}.frente-info-card[_ngcontent-%COMP%]{background-color:#1e1e1e;color:#fff}.actividades-stats[_ngcontent-%COMP%]{border-top-color:#333}.stat-item[_ngcontent-%COMP%]{background-color:#2a2a2a}[_nghost-%COMP%]     .custom-marker{background-color:#1e1e1e}[_nghost-%COMP%]     .marker-icon{color:#fff}}@media (prefers-contrast: high){.estado-chip[_ngcontent-%COMP%]{border:2px solid currentColor}.frente-item.selected[_ngcontent-%COMP%]{border-left-width:6px}[_nghost-%COMP%]     .custom-marker{border-width:4px}}.frente-item[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.frente-info-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInRight .3s ease-out}@keyframes _ngcontent-%COMP%_slideInRight{0%{opacity:0;transform:translate(20px)}to{opacity:1;transform:translate(0)}}.frente-item[_ngcontent-%COMP%]:focus{outline:2px solid #1976d2;outline-offset:2px}button[_ngcontent-%COMP%]:focus{outline:2px solid #1976d2;outline-offset:2px}@media (prefers-reduced-motion: reduce){.frente-item[_ngcontent-%COMP%], .frente-info-card[_ngcontent-%COMP%], [_nghost-%COMP%]     .custom-marker{animation:none;transition:none}[_nghost-%COMP%]     .custom-marker:hover{transform:none}}.no-results[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:#666}.no-results[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:1rem;color:#ccc}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.5rem 0}.auth-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;color:#2196f3;font-style:italic;margin-top:1rem}.auth-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;margin:0}"]})}}return a})();export{Kn as MapaComponent};
